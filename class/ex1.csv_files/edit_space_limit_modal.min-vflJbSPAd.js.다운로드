define(["require","exports","tslib","react","spectrum/button","spectrum/input","spectrum/modal","modules/clean/react/css","modules/clean/react/modal","modules/clean/react_format","modules/clean/static_urls","modules/clean/teams/admin/api/admin_console_api_client","modules/clean/teams/components/warning_box","modules/core/browser","modules/core/i18n","modules/core/notify"],(function(e,t,a,i,s,n,o,r,l,m,u,c,d,p,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=a.__importDefault(i),c=a.__importDefault(c),p=a.__importStar(p);var C=f._("Edit %(display_name)s’s space limit"),_=f._("Set a custom space limit for this member. %(first_name)s is currently using %(usage)s."),y=f._("GB"),g=f._("Reset custom space limit"),b=f._("This member might be out of space if you set a limit lower than their current usage."),E=i.default.createElement("div",null,i.default.createElement("div",{className:"off-warning-message"},m.reactFormat(f._("To apply a custom space limit, you’ll need to set a member space limit for your team first. <a>View settings</a>"),{a:i.default.createElement("a",{href:"/team/admin/settings/space",target:"_blank",rel:"noopener noreferrer"}," ")})),b),v=(function(e){function t(t){var a=e.call(this,t)||this;return a.setCustomQuota=function(){return a._client.setCustomQuota(a.props.email,a.state.customQuota)},a.resetCustomQuota=function(){return a._client.removeCustomQuota(a.props.email)},a.onSet=function(){null==a.state.customQuota||a.state.customQuota<15?h.Notify.error(f._("Custom quota must exceed 15 GB")):a.onSubmit(a.setCustomQuota)},a.onMainCancelClicked=function(){a.setState({isModalOpen:!1,isResetConfirmationOpen:!1})},a.onResetCancel=function(){a.setState({isModalOpen:!0,isResetConfirmationOpen:!1})},a.onReset=function(){a.onSubmit(a.resetCustomQuota)},a.primaryAction=function(e,t,n){return i.default.createElement("span",null,a.state.submitting&&i.default.createElement("span",{className:"dbmodal-loading",key:"loading"},i.default.createElement("img",{src:u.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:f._("Loading")})),i.default.createElement(s.Button,{disabled:a.state.submitting||n,variant:"primary",onClick:t},e))},a.setPrimaryAction=function(e){var t="Set custom space limit";return a.props.userCustomLimitGB&&(t=f._("Set %(first_name)s’s space limit").format({first_name:a.firstName})),a.primaryAction(t,e,!a.isValidInput())},a.resetPrimaryAction=function(e){return a.primaryAction(f._("Reset custom space limit"),e,!1)},a.secondaryAction=function(e){return i.default.createElement(s.Button,{disabled:a.state.submitting,variant:"secondary",onClick:e},f._("Cancel"))},a.saveCustomQuotaChange=function(e){a.setState({customQuota:Number(e.currentTarget.value)})},a.onResetClicked=function(){a.setState({isModalOpen:!1,isResetConfirmationOpen:!0})},a.state={submitting:!1,isModalOpen:!0,customQuota:a.props.userCustomLimitGB,isResetConfirmationOpen:!1},a._client=new c.default,a}return a.__extends(t,e),t.prototype.getErrorMessage=function(){return null==this.state.customQuota?null:this.state.customQuota%1!=0?f._("This must be a whole number"):this.state.customQuota<15?f._("This number can’t be lower than 15"):null},t.prototype.isValidInput=function(){return null!=this.state.customQuota&&this.state.customQuota!==this.props.userCustomLimitGB&&15<=this.state.customQuota&&this.state.customQuota%1==0},t.prototype.onSubmit=function(e){var t=this;this.setState({submitting:!0}),e().then((function(){t.setState({submitting:!1,isModalOpen:!1}),t.props.redirectOnChangeUrl?p.redirect(t.props.redirectOnChangeUrl+"&msg=cq_set"):p.reload()})).catch((function(){t.setState({submitting:!1}),t.props.redirectOnChangeUrl?p.redirect(t.props.redirectOnChangeUrl+"&msg=cq_failed"):p.reload()}))},t.prototype.renderMainModal=function(){var e,t,a=C.format({display_name:this.displayName}),s=_.format({first_name:this.firstName,usage:this.props.userUsageString}),r=this.props.userCustomLimitGB?g:void 0,l=this.getErrorMessage(),u="off"===this.props.teamCapsType?E:b;return i.default.createElement(o.UtilityModal,{className:"edit-space-limit-modal",overlayClassName:"edit-space-limit-modal--overlay",title:a,primaryAction:this.setPrimaryAction,secondaryAction:this.secondaryAction,link:r,onPrimaryAction:this.onSet,onSecondaryAction:this.onMainCancelClicked,onLink:this.onResetClicked,onRequestClose:this.onMainCancelClicked,overlayClickClose:!0,ariaLabel:f._("Set custom space limit"),open:this.state.isModalOpen&&!this.state.isResetConfirmationOpen},i.default.createElement("div",{className:"edit-space-limit-content"},s,i.default.createElement("br",null)),i.default.createElement("div",{className:"space-limit-row"},i.default.createElement("label",{className:"limit-label",htmlFor:"team-limit-input"},f._("Everyone’s default limit"),i.default.createElement("br",null),(e=!!this.props.userCustomLimitGB,t=f._("edit everyone’s default"),e&&(t=f._("edit")),m.reactFormat("<a>%(text)s</a>",{a:i.default.createElement("a",{href:"/team/admin/settings/space",target:"_blank",rel:"noopener noreferrer"}," "),text:t}))),i.default.createElement("div",{className:"limit-input"},i.default.createElement(n.Input,{id:"team-limit-input",defaultValue:String(this.props.teamMemberDefaultLimitGB),disabled:!0}),i.default.createElement("div",{className:"limit-suffix"},y))),i.default.createElement("div",{className:"space-limit-row space-limit-input-row"},i.default.createElement("label",{className:"limit-label",htmlFor:"user-limit-input"},f._("This member’s limit"),i.default.createElement("br",null),f._("(must exceed 15 GB)")),i.default.createElement("div",{className:"limit-value"},i.default.createElement("div",{className:"limit-input"},i.default.createElement(n.Input,{id:"user-limit-input",type:"number",min:15,defaultValue:String(this.props.userCustomLimitGB),onChange:this.saveCustomQuotaChange}),i.default.createElement("div",{className:"limit-suffix"},y)),i.default.createElement("div",{className:"limit-error"},l))),i.default.createElement(d.WarningBox,{warningText:u}))},t.prototype.renderResetConfirmationModal=function(){var e=f._("Reset custom space limit"),t=f._("This member’s limit will return to the default space limit.");return i.default.createElement(o.UtilityModal,{className:"edit-space-limit-modal",overlayClassName:"edit-space-limit-modal--overlay",title:e,primaryAction:this.resetPrimaryAction,secondaryAction:this.secondaryAction,onPrimaryAction:this.onReset,onSecondaryAction:this.onResetCancel,onRequestClose:this.onMainCancelClicked,overlayClickClose:!0,ariaLabel:f._("Reset custom space limit"),open:this.state.isResetConfirmationOpen},i.default.createElement("div",{className:"edit-space-limit-content"},t))},t.prototype.render=function(){return this.state.isResetConfirmationOpen?this.renderResetConfirmationModal():this.renderMainModal()},Object.defineProperty(t.prototype,"displayName",{get:function(){return this.props.displayName||this.props.email},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstName",{get:function(){return this.props.firstName||this.props.email},enumerable:!0,configurable:!0}),t})(i.default.Component);t.EditSpaceLimitModal=r.requireCssWithComponent(v,["/static/css/spectrum/index.web-vfl_-DzRS.css","/static/css/teams/edit_space_limit_modal-vflPz906-.css"]),t.showEditSpaceLimitModal=function(e){l.Modal.showInstance(i.default.createElement(t.EditSpaceLimitModal,a.__assign({},e)))}}));
//# sourceMappingURL=edit_space_limit_modal.min.js-vfl4apFcf.map