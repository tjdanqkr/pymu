define("modules/clean/react/home/actions",["require","exports","tslib","modules/constants/env","modules/core/uri","modules/core/i18n","modules/core/notify","modules/clean/react/home/post_tti/api","modules/clean/react/home/actions_post_tti","modules/clean/viewer"],(function(e,t,n,i,o,r,a,s,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(){}return e.setSectionVisibility=function(e,t,i){return n.__awaiter(this,void 0,void 0,(function(){var o,r=this;return n.__generator(this,(function(a){return o=function(){return n.__awaiter(r,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,s.waitForHomeTTI()];case 1:return[2,e.sent().setSectionVisibility]}}))}))},c.setSectionVisibilityHelper(e,t,i,o),[2]}))}))},e.createPaperDocInNewTab=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,c,u,d,m,_,h;return n.__generator(this,(function(n){switch(n.label){case 0:t=r._("Could not create paper document."),c=window.open("about:blank"),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,s.waitForHomeTTI()];case 2:return[4,(0,n.sent().createPaperDoc)(e)];case 3:return u=n.sent(),d=l.Viewer.get_viewer(),m=d.get_user_by_id(e),_=d.is_paired?{role:m.role}:{},c&&!c.closed?(h=new o.URI({scheme:"https",authority:i.NOTES_WEBSERVER,path:"/doc/"+u.doc_id,query:_}).toString(),c.location.replace(h)):a.Notify.error(t),[3,5];case 4:return n.sent(),a.Notify.error(t),c&&!c.closed?[2,c.close()]:[3,5];case 5:return[2]}}))}))},e})();t.HomeActions=u})),define("modules/clean/react/home/roots/home_access_main",["require","exports","tslib","react","classnames","modules/clean/react/home/constants","modules/clean/react/home/store","modules/clean/react/home/util/conditional_components","modules/clean/react/home/util/post_tti_components","modules/clean/react/home/recents/components/recent_activity_container","modules/clean/react/home/post_tti/api","modules/clean/react/home/util/logging/availability_logger","modules/clean/react/retrieval_success_banner/constants","modules/clean/react/retrieval_success_banner/util"],(function(e,t,n,i,o,r,a,s,c,l,u,d,m,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importDefault(o);var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.outerFrame=function(e){n.element=e},n.updateWidth=function(){n.setState({containerWidth:n.getWidth()})},n.onResize=function(){window.requestAnimationFrame?window.requestAnimationFrame(n.updateWidth):setTimeout(n.updateWidth,250)},n.onHomeStoreUpdate=function(){return n.setState(n.getStateFromStore())},n.state=n.getStateFromStore(),n.removeStoreListeners=a.getHomeStore().addListener(n.onHomeStoreUpdate),n.getStateFromStore().expSearchSuccessBanner&&_.setupSearchSuccessBannerForHome(),n}return n.__extends(t,e),t.prototype.componentWillMount=function(){u.waitForHomeTTIWithProps().then((function(e){var t=e.props;return e.imports.initHomeOnboarding(t.onboardingData)}))},t.prototype.componentDidMount=function(){this.updateWidth(),window.addEventListener("resize",this.onResize)},t.prototype.componentWillUnmount=function(){this.removeStoreListeners&&this.removeStoreListeners()},t.prototype.getStateFromStore=function(){var e=a.getHomeStore(),t=e.getPreTTIProps(),n=t.expSearchSuccessBanner,i=t.expHideUnread,o=t.expHomeSuggestionsNewTile;return{sectionVisibility:e.getSectionVisibility(),canRenderAllHomeSections:e.canRenderAllHomeSections(),canRenderItems:e.canRenderItems(),containerWidth:this.getWidth(),expSearchSuccessBanner:n,expHideUnread:i,expHomeSuggestionsNewTile:o}},t.prototype.getWidth=function(){var e=1;return this.element&&this.element.getBoundingClientRect&&(e=this.element.getBoundingClientRect().width||1),e},t.prototype.render=function(){var e=this.state,t=e.canRenderAllHomeSections,n=e.sectionVisibility,u=e.canRenderItems,_=e.expHideUnread,h=e.expHomeSuggestionsNewTile,p=this.props.now;if(t){var E=o.default({"home-access-sections":!0}),f=u,T=i.default.createElement(c.PostTTIHomeSurfaceExistingTeams,null),I=i.default.createElement(c.PostTTIRecommendedMembers,null),g=i.default.createElement(c.PostTTITeammateSuggestions,null),y=i.default.createElement(s.ConditionalSuggestView,{isHiddenByUser:!n[r.HomeSections.SUGGEST],containerWidth:this.state.containerWidth,canRenderItems:f,homeAvailabilityLogger:d.getHomeAvailabilityLogger(),useNewTile:h}),R=i.default.createElement(s.ConditionalHomeAccessUnread,{now:p,isHiddenByUser:!n[r.HomeSections.UNREAD],canRenderItems:f,hideSection:_}),S=i.default.createElement(s.ConditionalStarredView,{isHiddenByUser:!n[r.HomeSections.STARRED],canRenderItems:f}),v=[T,I,g,y,i.default.createElement(l.RecentActivityContainer,{now:p,canRenderItems:f,isHiddenByUser:!n[r.HomeSections.RECENTS]}),R,S];return i.default.createElement("div",{className:"home",ref:this.outerFrame},i.default.createElement("main",{className:"home-access",role:"main"},i.default.createElement("ul",{className:E,ref:"main"},i.default.createElement(c.PostTTIRetrievalSuccessHomeBanner,{user:a.getUser(),displayContext:m.SearchSuccessDisplayContext.IN_EMBEDDED_APP,expSearchSuccessBanner:this.getStateFromStore().expSearchSuccessBanner}),i.default.createElement(c.PostTTIMontanaIPAModal,{user:a.getUser()}),v)))}return i.default.createElement("div",{ref:this.outerFrame})},t.displayName="HomeAccessMain",t.defaultProps={showUnreadOnboarding:!1},t})(i.default.PureComponent);t.HomeAccessMain=h})),define("modules/clean/react/home/roots/home_access_web",["require","exports","tslib","react","modules/clean/flux/dispatcher","modules/clean/react/home/roots/home_access_main","modules/clean/react/home/roots/sidebar","modules/clean/react/home/resource/store","modules/clean/react/home/store","modules/clean/react/home/constants","modules/clean/react/home/util/logging/timing_logger","modules/clean/react/maestro/layout/header","modules/clean/react/maestro/layout/search","modules/clean/react/home/post_tti/api","modules/clean/react/home/util/conditional_api","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/react/home/recents/stores/recent_activity_store"],(function(e,t,n,i,o,r,a,s,c,l,u,d,m,_,h,p,E,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=(function(e){function t(n){var o=e.call(this,n)||this;o.intervalHandle=null,o.renderSidebar=function(e){return i.default.createElement(a.HomeSidebar,{isPostTTI:o.state.isPostTTI,responsive:e})},E.log_js_modules_application_code_start();var r=n.preTTIProps,s=n.initialRole,c=n.initialSectionVisibility,l=n.sectionToConditionalData;return t.initializeHomeStores(s,c,l,r),o.state={now:new Date,isPostTTI:!1},o}return n.__extends(t,e),t.initializeHomeStores=function(e,t,n,i){u.homeTimingLogger.activate(),c.getHomeStore(),o.Dispatcher.dispatch({type:l.HomeActionTypes.INITIALIZE_STORE,payload:{role:e,sectionVisibility:t,preTTIProps:i,sectionToConditionalData:n}}),s.getHomeResourceStore(),f.getRecentActivityStore(),h.waitForStarred((function(e){return e.getStarredResourceStore()}))},t.prototype.componentDidMount=function(){var e=this;_.waitForHomeTTIWithProps().then((function(t){var n=t.imports,i=t.props;e.setState({isPostTTI:!0}),e.intervalHandle=setInterval((function(){return e.setState({now:new Date})}),6e4),n.homeAccessWebComponentDidMount(i.renderSnapEngage,i.maybeRenderTeamAdminModals)}))},t.prototype.componentWillUnmount=function(){null!=this.intervalHandle&&clearInterval(this.intervalHandle)},t.prototype.render=function(){var e=this.state.now;return i.default.createElement(m.SearchChrome,{user:c.getUser(),embeddedAppRegion:i.default.createElement(r.HomeAccessMain,{now:e}),titleRegion:i.default.createElement(d.MaestroHeaderTitle,null,p._("Home")),actionSidebarRegion:this.renderSidebar,searchBarProps:{searchVariant:"full-page"},wideSecondarySidebar:!0,useHeaderPortal:!0,useScrollableSidebar:!0})},t.displayName="HomeAccessWeb",t})((i=n.__importDefault(i)).default.PureComponent);t.HomeAccessWeb=T,t.RootComponent=function(e){return i.default.createElement(T,n.__assign({},e))}})),define("modules/clean/react/home/recents/utils/events",["require","exports","tslib","external/lodash","react-dom","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/resource_id_types"],(function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),o=n.__importStar(o);var c=function(e){return e?Array.prototype.indexOf.call(e.parentNode.childNodes,e):0},l=function(e,t,n,i){return e===r.ActionScope.AGGREGATION?n.props.recentItem?0:t+1:e===r.ActionScope.SUBSET?i.classList.contains("recents-item")?0:1:0},u=function(e,t,n,a,u){var d=(function(e){return i.filter(e,(function(e){return!!e.fqPath}))})(n),m=(function(e){return i.map(e,(function(e){return e.fqPath}))})(d),_=o.findDOMNode(t),h=(function(e,t){return 1===e?r.ActionScope.SINGLE:t.length===e?r.ActionScope.AGGREGATION:r.ActionScope.SUBSET})(a,m),p=(function(e,t){var n=e[t];return n&&n.previewInfo?n.previewInfo.icon:""})(n,u||0);return{actionTaken:e,scope:h,itemNumber:c(_),fileDetails:(function(e,t,n,i){if(e===r.ActionScope.AGGREGATION||t===r.ActionType.COLLAPSE||t===r.ActionType.UNCOLLAPSE)return{};var o=n[i];if(!o)return{};for(var a=0,c=["PAPER","EXTERNAL"];a<c.length;a++){var l=c[a];if(o.displayType&&o.displayType.indexOf(l)>=0)return{idType:void 0,resourceId:void 0}}return{idType:s.HOME_RESOURCE_ID_TYPE.FQ_PATH,resourceId:o.fqPath,displayType:o.displayType,isDir:o.isDir}})(h,e,d,u||0),sprite:p,subgroupPosition:l(h,u||0,t,_)}};t.logEvent=function(e,t,n,i,o){var r=u(e,t,n,i,o);return a.homeActivityLogger.logRecentsAction(r.actionTaken,r.scope,r.itemNumber,r.sprite,r.fileDetails.displayType||"",!!r.fileDetails.isDir,r.subgroupPosition,r.fileDetails.idType,r.fileDetails.resourceId)},t.logFederatedItemEvent=function(e,t,n){var i=o.findDOMNode(t),s=n.getIdTypePair();return a.homeActivityLogger.logRecentsAction(e,r.ActionScope.SINGLE,c(i),n.getIcon(),n.getDisplayType(),n.getIsDir(),l(r.ActionScope.SINGLE,0,t,i),s.type,s.id)}})),define("modules/clean/react/home/roots/sidebar",["require","exports","tslib","external/lodash","react","modules/clean/css","modules/clean/react/app_actions_view","modules/clean/react/browse/components/consolidated_upload_button","modules/clean/react/browse/constants","modules/clean/react/file_uploader/file_uploader","modules/clean/react/home/actions","modules/clean/react/home/constants","modules/clean/react/home/modals/async_home_modals","modules/clean/react/home/post_tti/api","modules/clean/react/home/recents/actions/recent_activity_actions","modules/clean/react/home/store","modules/clean/react/home/util/logging/activity_logger","modules/clean/sharing/wizard/async_wizard_modals","modules/clean/web_user_action_events","modules/clean/web_user_action_logger","modules/core/browser_detection","modules/core/i18n"],(function(e,t,n,i,o,r,a,s,c,l,u,d,m,_,h,p,E,f,T,I,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),o=n.__importDefault(o),g=n.__importStar(g);var R=(function(e){function t(t){var o=e.call(this,t)||this;o.onHomeStoreUpdate=function(){o.setState({isFileViewerOpen:p.getHomeStore().getIsFileViewerOpen()})},o.handleCreateNewFile=function(){E.homeActivityLogger.logClickRightMenu(d.LoggingTypes.CLICK_CREATE_NEW_FILE)},o.handleUploadFiles=function(){l.FileUploaderController.handleUploadButtonClick(!1),E.homeActivityLogger.logClickRightMenu(d.LoggingTypes.CLICK_UPLOAD_FILES)},o.handleUploadFolder=function(){l.FileUploaderController.handleUploadButtonClick(!0),E.homeActivityLogger.logClickRightMenu(d.LoggingTypes.CLICK_UPLOAD_FOLDER)},o.handleCreateSharedFolder=function(){return n.__awaiter(o,void 0,void 0,(function(){return n.__generator(this,(function(e){return I.WebUserActionLog.log(p.getUserId(),T.WebUserActionLogEvent.NEW_SHARED_FOLDER_CLICK,{origin:c.CREATE_FOLDER_ACTION_ORIGIN_TYPE.HOME_NEW_FOLDER_MODAL}),f.asyncShowShareAFolderWizardModal(p.getUser(),(function(e){E.homeActivityLogger.logClickRightMenu(d.LoggingTypes.CLICK_NEW_SHARED_FOLDER,e)})),[2]}))}))},o.handleCreateFolder=function(){return n.__awaiter(o,void 0,void 0,(function(){return n.__generator(this,(function(e){return m.asyncShowNewFolderModal({user:p.getUser(),origin:c.CREATE_FOLDER_ACTION_ORIGIN_TYPE.HOME_NEW_FOLDER_MODAL,onShowModal:function(e){E.homeActivityLogger.logClickRightMenu(d.LoggingTypes.CLICK_NEW_FOLDER,e)}}),[2]}))}))},o.handleCreateFolderFromUploadModal=function(e){return function(t){return n.__awaiter(o,void 0,void 0,(function(){return n.__generator(this,(function(n){return m.asyncShowNewFolderModal({user:p.getUser(),initialPath:t,origin:c.CREATE_FOLDER_ACTION_ORIGIN_TYPE.HOME_UPLOAD_MODAL,redirectOnClose:e}),[2]}))}))}},o.handleCreatePaperDoc=function(){u.HomeActions.createPaperDocInNewTab(p.getUserId()),E.homeActivityLogger.logClickRightMenu(d.LoggingTypes.CLICK_CREATE_PAPER_DOC)},o.onFileUploadComplete=i.throttle(h.refreshRecentItems,3500,{leading:!1,trailing:!0});var r=p.getHomeStore().getPreTTIProps(),a=r.expConsolidateCreateVariant,s=r.uploaderExperiments;return o.state={uploaderExperiments:s,newFileMenuPostTTI:void 0,showLegacyCreatePaperButton:!1,isFileViewerOpen:p.getHomeStore().getIsFileViewerOpen(),consolidateCreateVariant:a},o.removeStoreListeners=p.getHomeStore().addListener(o.onHomeStoreUpdate),o}return n.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;l.FileUploaderController.setUser(p.getUser()),_.waitForHomeTTIWithProps().then((function(t){var i=t.props,o=t.imports;return n.__awaiter(e,void 0,void 0,(function(){var e,t,a,s,c,u;return n.__generator(this,(function(n){switch(n.label){case 0:return l.FileUploaderController.loadCoreComponent(),r.require_css("/static/css/upload-vflWkaIPu.css"),e=this.state.consolidateCreateVariant,t=i.uploaderPostTTIExperiments,a=i.showLegacyCreatePaperButton,s=i.newFolderButton,c=[],"V1"!==e&&"V2"!==e||(s&&c.push({displayName:y._("Folder"),iconName:"folder-small",className:"action-folder",handleClick:this.handleCreateFolder}),c.push({displayName:y._("Shared folder"),iconName:"folder_shared-small",className:"action-shared-folder",handleClick:this.handleCreateSharedFolder})),[4,o.getNewFileMenu(i,c)];case 1:return u=n.sent(),this.setState({uploaderPostTTIExperiments:t,newFileMenuPostTTI:u,showLegacyCreatePaperButton:a}),[2]}}))}))}))},t.prototype.componentWillUnmount=function(){this.removeStoreListeners&&this.removeStoreListeners()},t.prototype.getPath=function(){var e=p.getUser(),t=e.is_cdm_member,n=e.cdm_tmf_path;return t?n:"/"},t.prototype.render=function(){var e,t=this.state.consolidateCreateVariant,n=this.props.responsive&&this.props.responsive.isMatchedLarge&&("V1"===t||"V2"===t),i=n&&"V2"===t,r={displayName:n?y._("Create ▾",{comment:"Button to create a new file"}):y._("Create new file"),className:"action-create-file-primary-pretti",handleClick:this.handleCreateNewFile,subItems:void 0},c={displayName:y._("Upload files"),popoverMenuName:y._("Files"),handleClick:this.handleUploadFiles,className:"action-upload-files",iconName:"upload-file"},u={displayName:y._("Upload folder"),popoverMenuName:y._("Folder"),handleClick:this.handleUploadFolder,className:"action-upload-folder",iconName:"upload-folder"},d={displayName:y._("Create Paper doc"),iconName:"new-paper-doc",className:"action-new-paper-doc",handleClick:this.handleCreatePaperDoc},m=[];e=this.state.newFileMenuPostTTI?this.state.newFileMenuPostTTI:r;var _=[];if(i?(_.push(c),g.is_input_webkitdirectory_supported()&&_.push(u)):(m.push(c),m.push(u)),!n){var h={displayName:y._("New folder"),iconName:"new-folder",className:"action-new-folder",handleClick:this.handleCreateFolder};m.push(h);var E={displayName:y._("New shared folder"),iconName:"new-shared-folder",className:"action-new-shared-folder",handleClick:this.handleCreateSharedFolder};m.push(E)}return this.state.showLegacyCreatePaperButton&&m.push(d),o.default.createElement("div",{className:"home-access-sidebar"},!this.state.isFileViewerOpen&&o.default.createElement(l.FileUploaderController,{loadOnRender:this.props.isPostTTI,needToSetStoreValues:!0,chooseDestination:!0,dragAndDropEnabled:!0,initialPermission:!0,initialPath:this.getPath(),onFileUploadComplete:this.onFileUploadComplete,uploaderExperiments:this.state.uploaderExperiments,uploaderPostTTIExperiments:this.state.uploaderPostTTIExperiments,handleClickNewFolder:this.handleCreateFolderFromUploadModal}),o.default.createElement(a.AppActionsView,{responsive:this.props.responsive,primaryMenuItems:[e],secondaryMenuItems:m,popoverTriggerLabel:y._("Actions")}),i&&o.default.createElement(s.ConsolidatedUploadButton,{uploadActions:_,className:"home-consolidated-upload",attachment:"right",userId:p.getUserId()}))},t})(o.default.PureComponent);t.HomeSidebar=R})),define("modules/clean/react/home/post_tti/api",["require","exports","tslib","react","modules/clean/web_timing_logger","modules/clean/react/async/loadable"],(function(e,t,n,i,o,r){"use strict";function a(){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return[4,o.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,n){e(["modules/clean/react/home/post_tti/interface"],t,n)})).then(n.__importStar)];case 2:return[2,t.sent()]}}))}))}function s(){return n.__awaiter(this,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,a()];case 1:return e=n.sent(),t={imports:e},[4,e.getPostTTIProps()];case 2:return[2,(t.props=n.sent(),t)]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),t.waitForHomeTTI=a,t.PostHomeTTIComponent=function(e){var t=this,i=e.getPostTTIRenderer,o=e.preTTIRenderer,s=e.displayName;return r.Loadable({displayName:"PostHomeTTIComponent("+s+")",loader:function(){return n.__awaiter(t,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return e=i,[4,a()];case 1:return[2,e.apply(void 0,[t.sent()])]}}))}))},loading:o})},t.waitForHomeTTIWithProps=s;var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return null},t})(i.default.PureComponent);t.PostHomeTTIComponentWithProps=function(e){var t=this,o=e.getPostTTIRenderer,a=e.preTTIRenderer,l=e.displayName;return r.Loadable({displayName:"PostHomeTTIComponentWithProps("+l+")",loader:function(){return n.__awaiter(t,void 0,void 0,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,s()];case 1:return e=t.sent(),[4,o(e)];case 2:return[2,t.sent()||function(){return i.default.createElement(c,null)}]}}))}))},loading:a})}})),define("modules/clean/react/home/util/conditional",["require","exports","tslib","react","modules/clean/react/async/loadable","modules/clean/react/home/post_tti/api","modules/clean/react/home/store","modules/clean/react/home/constants","modules/clean/react/home/util/logging/timing_logger","modules/core/exception","modules/clean/flux/dispatcher"],(function(e,t,n,i,o,r,a,s,c,l,u){"use strict";function d(e){return e?(e.initPrefetch(),e.componentClass):null}Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),t.IS_PROD=!0,t.homeConditionalSection=function(e){var m=this,_=e.section,h=e.syncLoader,p=e.asyncLoader,E=e.loading,f=null,T=s.ConditionalSectionLoadingPreference.UNKNOWN;return a.getHomeStore(),u.Dispatcher.dispatch({type:s.HomeActionTypes.DECLARE_CONDITIONAL_SECTION,payload:{section:_,didInitializeSynchronously:function(e){if(T=e,e===s.ConditionalSectionLoadingPreference.UNKNOWN)return!1;if(e===s.ConditionalSectionLoadingPreference.DO_NOT_LOAD)return a.isHomeSection(_)&&c.homeTimingLogger.logSkippedSection(_),!1;var t=e===s.ConditionalSectionLoadingPreference.POST_TTI;if(t)a.isHomeSection(_)&&c.homeTimingLogger.logSkippedSection(_);else{try{f=d(h())}catch(e){}if(f)return!0}var l=!t&&a.isBlockingSection(_),I=function(){return n.__awaiter(m,void 0,void 0,(function(){var e,i;return n.__generator(this,(function(n){switch(n.label){case 0:return t?[4,r.waitForHomeTTI()]:[3,2];case 1:n.sent(),n.label=2;case 2:return i=d,[4,p()];case 3:return e=i.apply(void 0,[n.sent()]),l&&(f=e),u.Dispatcher.dispatch({type:s.HomeActionTypes.LOADED_ASYNC_CONDITIONAL_SECTION,payload:{section:_}}),[2,e]}}))}))};if(l)I();else{var g=E;f=o.Loadable({loader:I,loading:g?function(e){return e.canRenderItems?"function"==typeof g?i.default.createElement(g,n.__assign({},e)):g:null}:void 0})}return!1}}}),function(e){return(T===s.ConditionalSectionLoadingPreference.UNKNOWN||!f&&T===s.ConditionalSectionLoadingPreference.IMMEDIATE&&a.isBlockingSection(_)&&t.IS_PROD)&&l.reportStack("Premature render",{severity:l.SEVERITY.CRITICAL,exc_extra:{section:_,loadingPreference:T,isBlockingSection:a.isBlockingSection(_)}}),f?i.default.createElement(f,n.__assign({},e)):null}}}));var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};define("modules/clean/react/home/util/conditional_api",["require","exports","modules/clean/react/home/store","modules/clean/react/home/constants"],(function(e,t,n,i){"use strict";function o(e,i,o,r,a){return void 0===i&&(i=!0),t.sectionToConditionalInterface[o]?e(t.sectionToConditionalInterface[o]):n.getHomeStore().executeWhenSectionIsReady(o,i,(function(n){if(n&&!t.sectionToConditionalInterface[o])try{t.sectionToConditionalInterface[o]=r()}catch(e){}return t.sectionToConditionalInterface[o]?e(t.sectionToConditionalInterface[o]):(i&&a().then((function(n){t.sectionToConditionalInterface[o]=n,e(n)})),null)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.sectionToConditionalInterface={},t.waitForSection=o,t.waitForStarred=function(t,n){return void 0===n&&(n=!0),o(t,n,i.HomeSections.STARRED,(function(){return e("modules/clean/react/home/starred/conditional_interface")}),(function(){return new Promise((function(t,n){e(["modules/clean/react/home/starred/conditional_interface"],t,n)})).then(__importStar)}))}})),define("modules/clean/react/home/util/conditional_components",["require","exports","tslib","react","modules/clean/react/home/constants","modules/clean/react/home/util/conditional","modules/clean/react/home/starred/starred_empty_layout","modules/clean/react/home/content_suggestions/loading","modules/clean/react/home/post_tti/api"],(function(e,t,n,i,o,r,a,s,c){"use strict";function l(e){return e&&{componentClass:e.HomeAccessUnread,initPrefetch:e.initPrefetch}}function u(e){return e&&{componentClass:e.StarredView,initPrefetch:e.getStarredResourceStore}}Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),t.ConditionalHomeAccessUnread=r.homeConditionalSection({section:o.HomeSections.UNREAD,syncLoader:function(){return l(e("modules/clean/react/home/unread/home_access_unread"))},asyncLoader:function(){return new Promise((function(t,n){e(["modules/clean/react/home/unread/home_access_unread"],t,n)})).then(n.__importStar).then((function(e){return l(e)}))},loading:function(e){return i.default.createElement("div",null)}}),t.ConditionalStarredView=r.homeConditionalSection({section:o.HomeSections.STARRED,syncLoader:function(){return u(e("modules/clean/react/home/starred/conditional_interface"))},asyncLoader:function(){return new Promise((function(t,n){e(["modules/clean/react/home/starred/conditional_interface"],t,n)})).then(n.__importStar).then((function(e){return u(e)}))},loading:function(e){return i.default.createElement(a.StarredEmptyLayout,n.__assign({},e))}}),t.ConditionalSuggestView=r.homeConditionalSection({section:o.HomeSections.SUGGEST,syncLoader:function(){return null},asyncLoader:function(){return n.__awaiter(void 0,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,c.waitForHomeTTI()];case 1:return e=n.sent(),t=e.initPrefetch,[2,{componentClass:e.HomeSuggest,initPrefetch:t}]}}))}))},loading:function(e){return i.default.createElement(s.SuggestedLoading,n.__assign({},e))}})})),define("modules/clean/react/home/util/post_tti_components",["require","exports","tslib","react","modules/clean/react/home/post_tti/api","modules/clean/react/home/recents/components/pending_attachment_list_view"],(function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),t.PostTTIRecentActivityImageAttachments=o.PostHomeTTIComponent({displayName:"PostTTIRecentActivityImageAttachments",preTTIRenderer:function(e){var t=e.count;return i.createElement(r.PendingAttachmentListView,{count:t})},getPostTTIRenderer:function(e){var t=e.AttachmentListView;return function(e){var n=e.attachments;return i.createElement(t,{attachments:n})}}}),t.PostTTIRecommendedMembers=o.PostHomeTTIComponentWithProps({displayName:"PostTTIRecommendedMembers",getPostTTIRenderer:function(t){var o=t.props;return n.__awaiter(void 0,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(a){switch(a.label){case 0:return(t=o.homeGrowthExperiments).recommendedMembers.length?[4,new Promise((function(t,n){e(["modules/clean/react/home/experiments/recommended_members/recommended_members_post_tti"],t,n)})).then(n.__importStar)]:[3,2];case 1:return r=a.sent().RecommendedMembers,[2,function(){return i.createElement("li",{className:"home-access-section"},i.createElement(r,n.__assign({},t)))}];case 2:return[2,null]}}))}))}}),t.PostTTIRecentsActivityFileActions=o.PostHomeTTIComponent({displayName:"PostTTIRecentsActivityFileActions",getPostTTIRenderer:function(e){var t=e.RecentActivityFileActionPost;return function(e){var n=e.recentItem,o=e.attachments;return i.createElement(t,{recentItem:n,attachments:o})}}}),t.PostTTIStarredItemFileActions=o.PostHomeTTIComponent({displayName:"PostTTIStarredItemFileActions",getPostTTIRenderer:function(e){var t=e.StarredItemFileActionPost;return function(e){var n=e.starredItem,o=e.user;return i.createElement(t,{starredItem:n,user:o})}}}),t.PostTTIRetrievalSuccessHomeBanner=o.PostHomeTTIComponent({displayName:"PostTTIRetrievalSuccessHomeBanner",getPostTTIRenderer:function(e){var t=e.RetrievalSuccessHomeBanner;return function(e){var n=e.user,o=e.displayContext,r=e.expSearchSuccessBanner;return i.createElement(t,{user:n,displayContext:o,expSearchSuccessBanner:r})}}}),t.PostTTIMontanaIPAModal=o.PostHomeTTIComponentWithProps({displayName:"PostTTIMontanaIPAModal",getPostTTIRenderer:function(t){var o=t.props;return n.__awaiter(void 0,void 0,void 0,(function(){var t,r,a;return n.__generator(this,(function(s){switch(s.label){case 0:return[4,new Promise((function(t,n){e(["modules/core/browser_detection"],t,n)})).then(n.__importStar)];case 1:return t=s.sent().is_supported_mobile_browser,r=o.montanaModalProps,t()||!r?[2,function(){return null}]:[4,new Promise((function(t,n){e(["modules/clean/react/montana/in_product_modal/in_product_modal_post_tti_renderer"],t,n)})).then(n.__importStar)];case 2:return a=s.sent().PostTTIMontanaIPAModalRenderer,[2,function(e){var t=e.user;return i.createElement(a,{montanaModalProps:r,user:t})}]}}))}))}}),t.PostTTIHomeSurfaceExistingTeams=o.PostHomeTTIComponentWithProps({displayName:"PostTTIHomeSurfaceExistingTeams",getPostTTIRenderer:function(t){var o=t.props;return n.__awaiter(void 0,void 0,void 0,(function(){var t,r;return n.__generator(this,(function(a){switch(a.label){case 0:return(t=o.surfaceExistingTeamsProps).showHomeSurfaceExistingTeamsExperiment?[4,new Promise((function(t,n){e(["modules/clean/react/home/experiments/surface_existing_teams/home_surface_existing_teams"],t,n)})).then(n.__importStar)]:[3,2];case 1:return r=a.sent().HomeSurfaceExistingTeams,[2,function(){return i.createElement("li",{className:"home-access-section"},i.createElement(r,n.__assign({},t)))}];case 2:return[2,null]}}))}))}}),t.PostTTITeammateSuggestions=o.PostHomeTTIComponentWithProps({displayName:"PostTTITeammateSuggestions",getPostTTIRenderer:function(e){var t=e.props;return n.__awaiter(void 0,void 0,void 0,(function(){var e;return n.__generator(this,(function(n){return(e=t.teammateSuggestionsProps).suggestedMembers.length?[2,function(){return i.createElement("li",{className:"teammate-suggestions-section"},e.suggestedMembers.map((function(e){return i.createElement("div",{key:e.user_id},e.display_name)})))}]:[2,null]}))}))}})})),define("modules/clean/react/home/util/prefetch_handler",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPrefetchHandler=function(e){return window[e]},t.handlePrefetch=function(e,t,n){var i=e.getDataIfAvailable();if(i){var o=i.error,r=i.payload;o?n(o):t(r)}else e(t,n);return Boolean(i)}})),define("modules/clean/react/home/recents/actions/error_actions",["require","exports","tslib","external/lodash","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/core/exception","modules/core/i18n","modules/core/notify"],(function(e,t,n,i,o,r,a,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),a=n.__importStar(a);var l=(function(){function e(e){var t=this;this._flushQueues=function(){t._rafId=null;var e=t._recentActivityQueue;t._recentActivityQueue=[],e.length&&t._dispatcher.dispatch({type:o.RAW_RECENT_ACTIVITY_PARSE_ERROR,errors:e});var n=t._relatedActivityQueue;t._relatedActivityQueue=[],n.length&&t._dispatcher.dispatch({type:o.RAW_RELATED_ACTIVITY_PARSE_ERROR,errors:n})},this._notify=i.throttle((function(){var e=s._("Sorry, we were unable to show some recent items. The team has been notified");c.Notify.error(e)}),500,{trailing:!1}),this._dispatcher=e,this._recentActivityQueue=[],this._relatedActivityQueue=[],this._rafId=null}return e.prototype.recentActivityParseError=function(e,t){a.reportException({err:t}),this._notify(),this._enqueueError(this._recentActivityQueue,e,t)},e.prototype.relatedActivityParseError=function(e,t){a.reportException({err:t}),this._notify(),this._enqueueError(this._relatedActivityQueue,e,t)},e.prototype._enqueueError=function(e,t,n){e.push({activityKey:t,error:n}),this._rafId||(this._rafId=window.requestAnimationFrame(this._flushQueues))},e})();t.ErrorActions=l,t.errorActions=new l(r.recentActivityDispatcher)})),define("modules/clean/react/home/recents/actions/federated_recent_activity_actions",["require","exports","tslib","modules/core/i18n","modules/core/browser","modules/clean/react/modal","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/recent_activity_federated_model","modules/clean/react/home/recents/stores/recent_activity_store","modules/core/exception","modules/core/notify","modules/clean/react/home/recents/utils/events","modules/clean/react/home/post_tti/api"],(function(e,t,n,i,o,r,a,s,c,l,u,d,m,_){"use strict";function h(e,t,n){e?o.open_tab(e):u.reportStack("Cannot open tab to preform the action "+t,{severity:u.SEVERITY.NONCRITICAL,exc_extra:{paperRecentItem:n.paperRecentItem}})}function p(e,t,n){m.logFederatedItemEvent(e,n.cellView,t)}function E(e,t){s.recentActivityDispatcher.dispatch({type:e,activityKey:t})}Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),t.shareItem=function(e,t){p(a.ActionType.PAPER_SHARE,e,t),h(c.getPaperShareUrl(e),a.ActionType.PAPER_SHARE,e)},t.previewItem=function(e,t){p(a.ActionType.PAPER_OPEN,e,t),h(e.getUrl(),a.ActionType.PAPER_OPEN,e)},t.promptAndArchiveItem=function(e,t,o){var s=this,u=e.getActivityKey();if(l.getRecentActivityStore().canArchiveActivityKey(u)){var m=e.getActivityKey();r.SimpleModal.show({title_text:i._("Archive document?"),body_html:i._("Do you want to archive this document?"),confirm_text:i._("Archive"),cancel_text:i._("Cancel"),autoclose:!0,confirm_callback:function(){return n.__awaiter(s,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:p(a.ActionType.PAPER_ARCHIVE,e,o),E(a.ARCHIVE_PAPER_DOCUMENT_PENDING,m),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,_.waitForHomeTTI()];case 2:return[4,n.sent().archivePaperResources(t,[e.paperRecentItem])];case 3:return n.sent().some((function(t){return c.equalsPaperRecentItem(e,t)}))?(E(a.ARCHIVE_PAPER_DOCUMENT_COMMIT,m),d.Notify.success(i._("The document was archived."))):E(a.ARCHIVE_PAPER_DOCUMENT_ROLLBACK,m),[3,5];case 4:return n.sent(),E(a.ARCHIVE_PAPER_DOCUMENT_ROLLBACK,m),[3,5];case 5:return[2]}}))}))}})}}})),define("modules/clean/react/home/recents/actions/recent_activity_action_permissions",["require","exports","external/lodash","modules/clean/react/home/recents/models/utils"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRecentActivityItemViewPermissions=function(e,t){if(e.federatedRecentItem)return{archive:e.federatedRecentItem.isArchiveable(),comment:!1,delete:!1,download:!1,open:!1,share:e.federatedRecentItem.isShareable(),versions:!1,viewInFolder:!1};var o=t[0],r=1===t.length;if(i.isShareRecentItem(e))return{archive:!1,comment:!1,delete:!1,download:!1,open:!!e.scl,share:!1,versions:!1,viewInFolder:!1};var a=r&&!o.isDir,s=r&&!o.isCloudDoc,c=r&&o.isVersionable,l=e.paths.length?n.last(e.paths):null;return{archive:!1,comment:a&&s,delete:t.every((function(e){return!e.isReadOnly})),download:r&&s,open:!(!r||!o.canOpen),share:r,versions:a&&c,viewInFolder:!(!l||!l.url)}},t.shouldRenderActionsMenu=function(e){for(var t in e)if("share"!==t&&e[t])return!0;return!1}})),define("modules/clean/react/home/recents/actions/recent_activity_actions",["require","exports","tslib","external/lodash","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/stores/recent_activity_store","modules/clean/react/home/util/navigation","modules/clean/react/home/post_tti/api","modules/clean/react/home/recents/actions/federated_recent_activity_actions","modules/core/exception"],(function(e,t,n,i,o,r,a,s,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),t.shareRecentItem=function(e,t,i,o){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return e.federatedRecentItem?(l.shareItem(e.federatedRecentItem,i),[3,4]):[3,1];case 1:return[4,c.waitForHomeTTI()];case 2:return[4,n.sent().shareFile(t[0].id,i,o)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.previewRecentItem=function(e,t,n,i){if(e.federatedRecentItem)l.previewItem(e.federatedRecentItem,n);else if(1===e.attachmentIds.length){var o=s.isMetaKeyPressed(t.event);c.waitForHomeTTI().then((function(i){return(0,i.previewFileSyncRecentItem)(e,o,t,n)}))}else{var r=t.index,a=t.shouldUseEntityUri;u.reportStack("To preview, file sync items must have 1 attachment id",{severity:u.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e,index:r,shouldUseEntityUri:a}})}},t.deleteRecentItem=function(e,t,i){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){return c.waitForHomeTTIWithProps().then((function(n){var o=n.imports,r=n.props;o.deleteRecentItem(e,t,i,r)})),[2]}))}))},t.archiveRecentItem=function(e,t){e.federatedRecentItem?l.promptAndArchiveItem(e.federatedRecentItem,e.viewingUserId,t):u.reportStack("Archiving is not supported",{severity:u.SEVERITY.NONCRITICAL,exc_extra:{recentItem:e}})},t.loadNextPage=function(){var e=a.getRecentActivityStore().getFileSyncCursor();return e&&c.waitForHomeTTI().then((function(t){return(0,t.loadRecentItems)(e)})),!!e},t.hasCursor=function(){return!!a.getRecentActivityStore().getFileSyncCursor()},t.openFile=function(e,t,o){return void 0===o&&(o=i.noop),n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,c.waitForHomeTTI()];case 1:return[4,n.sent().openFile(e,t)];case 2:return n.sent(),o(),[2]}}))}))},t.downloadFiles=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,c.waitForHomeTTI()];case 1:return n.sent().downloadFiles(e,t),[2]}}))}))},t.openVersions=function(e,t,i){return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return o=s.getNavigationMethod(t),[4,c.waitForHomeTTI()];case 1:return n.sent().openVersions(o,e,i),[2]}}))}))},t.refreshRecentItems=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t,i;return n.__generator(this,(function(n){switch(n.label){case 0:return a.getRecentActivityStore().didReceiveItemsFromAllStreams()?(r.recentActivityDispatcher.dispatch({type:o.REFRESH_RECENT_ACTIVITIES}),[4,c.waitForHomeTTI()]):[3,3];case 1:return e=n.sent(),t=e.loadRecentItems,i=e.loadPaperRecentItems,[4,Promise.all([t(),i(!1)])];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}})),define("modules/clean/react/home/recents/models/attachment",["require","exports","modules/core/exception"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertFileActivityToAttachmentItem=function(e){var t=e.preview_jsinfo||null,i=null,o=null;if(t&&(t.thumbnail_url_tmpl&&(i=t.thumbnail_url_tmpl),t.thumbnail_dimensions)){var r=t.thumbnail_dimensions,a=r[0];o={height:r[1],width:a}}var s=e.comment||{},c=s.commenter_dict||{};return s.raw_comment_text&&n.reportStack("Received a comment attachment",{severity:n.SEVERITY.NONCRITICAL,exc_extra:{activity:e}}),{id:e.activity_key,isLoaded:!0,viewingUserId:e.viewing_user.id,displayName:e.name||null,displayType:e.activity_data&&e.activity_data.home_display_type||null,previewInfo:e.preview_jsinfo||null,fqPath:e.fq_path||null,nsPath:e.ns_path||null,nsId:e.ns_id||null,thumbnailUrl:i||null,thumbnailDimensions:o||null,canOpen:!1,inRootCollection:!1,isReadOnly:!!e.is_read_only,isDir:!!e.is_dir,isCloudDoc:!!e.is_cloud_doc,isVersionable:!!e.is_versionable,commentRawText:s.raw_comment_text||null,commenterId:c.id||null,commenterDisplayName:c.display_name||null,commenterPhotoUrl:c.photo_circle_url||null}},t.createPartialAttachmentsFromRecentActivity=function(e){return(e.related_activity_keys||[]).map((function(t){return{id:t,viewingUserId:e.viewing_user.id,displayName:null,displayType:null,isLoaded:!1,canOpen:!1,inRootCollection:!1,isReadOnly:!1,isDir:!1,isCloudDoc:!1,isVersionable:!1,previewInfo:null,fqPath:null,nsPath:null,nsId:null,thumbnailUrl:null,thumbnailDimensions:null,commentRawText:null,commenterId:null,commenterDisplayName:null,commenterPhotoUrl:null}}))}})),define("modules/clean/react/home/recents/models/federated_recent_item",["require","exports","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_federated_model"],(function(e,t,n,i){"use strict";function o(e){switch(e.action||n.PaperRecentItemAction.OPENED){case n.PaperRecentItemAction.CREATED:return n.RECENT_EVENT_TYPES.PAPER_ADD;case n.PaperRecentItemAction.EDITED:return n.RECENT_EVENT_TYPES.PAPER_EDIT;default:return n.RECENT_EVENT_TYPES.PAPER_VIEW}}Object.defineProperty(t,"__esModule",{value:!0}),t.createRecentItemFromPaperRecentItem=function(e,t,r){var a=new i.FederatedRecentItem(e),s=a.getActivityKey();return{federatedRecentItem:a,id:s,idType:e.id_type,resourceId:e.resource_id,type:o(e),icon:a.getIcon(),displayType:e.display_type,when:e.time,viewingUserId:t.id,displayName:e.name,accountDisplayName:t.display_name,contextDisplayName:a.getFolderPath()||t.display_name,attachmentIds:[s],paths:e.path,order:r,uniqueFilterTypes:[n.RECENT_EVENT_FILTER_TYPE.DOCUMENTS]}}})),define("modules/clean/react/home/recents/models/recent_item",["require","exports","tslib","external/lodash","modules/clean/react/home/recents/actions/error_actions","modules/clean/react/home/recents/models/utils"],(function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var a=0,s=i.memoize((function(e){return a+=1}));t.convertRecentActivityToRecentItem=function(e){try{var t=e.skeleton_data;return{id:e.activity_key,type:e.recent_event_type||null,icon:t&&t.icon||null,displayType:e.activity_data&&e.activity_data.home_display_type||null,when:e.when_milli||null,viewingUserId:e.viewing_user.id,displayName:t&&t.display_name||null,accountDisplayName:t&&t.account_display_name||null,contextDisplayName:t&&t.context_display_name||null,uniqueFilterTypes:t?i.uniq(i.values(t.filter_types_by_key)):[],attachmentIds:e.related_activity_keys||[],paths:r.getPathsByFqPath(t&&t.context_display_path||"",e.viewing_user.id,!0),order:s(e.activity_key),idType:e.id_type,resourceId:e.resource_id,scl:e.scl}}catch(t){return i.defer((function(){return o.errorActions.recentActivityParseError(e.activity_key,t)})),null}}})),define("modules/clean/react/home/recents/models/utils",["require","exports","tslib","external/lodash","modules/clean/browse_uri_interface","modules/clean/react/home/recents/recent_activity_constants","modules/clean/viewer"],(function(e,t,n,i,o,r,a){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var c=[r.RECENT_EVENT_FILTER_TYPE.PHOTOS,r.RECENT_EVENT_FILTER_TYPE.VIDEOS,r.RECENT_EVENT_FILTER_TYPE.VISUAL_NOTES];function l(e,t){return!!(e>1&&t.every((function(e){return c.indexOf(e)>=0})))}function u(e){switch(e.type){case r.RECENT_EVENT_TYPES.FILE_PRIVATE_VIEW:case r.RECENT_EVENT_TYPES.FILE_SHARED_VIEW:case r.RECENT_EVENT_TYPES.PAPER_VIEW:return r.RecentItemActionType.OPENED;case r.RECENT_EVENT_TYPES.FILE_EDIT:case r.RECENT_EVENT_TYPES.PAPER_EDIT:return r.RecentItemActionType.EDITED;default:return r.RecentItemActionType.ADDED}}t.shouldShowThumbnailsForSkeletonData=function(e){var t=i.values(e.filter_types_by_key);return l(t.length,i.uniq(t))},t.shouldShowThumbnailsForRecentItem=function(e){return l(e.attachmentIds.length,e.uniqueFilterTypes)},t.extractAttachmentIds=function(e){return i.map(e,"id")},t.isShareRecentItem=function(e){return!!e.scl},t.getPathsByFqPath=function(e,t,n){void 0===n&&(n=!1);var r=a.Viewer.get_viewer().get_user_by_id(t);"/"===e&&(e="");var s=[],c=e.split("/");for(n||c.pop();c.length;){var l=i.last(c),u=c.join("/");1===c.length&&""===l&&(l=a.Viewer.get_root_name(r),u="");var d=o.browse_uri_for_fq_path(r,u).toString();s.push({name:l||"",url:d}),c.pop()}return s.reverse()},t.compareRecentItems=function(e,t){return t.when-e.when||e.order-t.order||t.type-e.type},t.getExtension=function(e){var t=e.split(".");return t.length<2?"":"."+t.slice(-1)[0].replace(/\n$/,"").toLowerCase()},t.getRecentItemActionType=u;var d=((s={})[r.RecentItemActionType.OPENED]=r.I18N.OPENED,s[r.RecentItemActionType.EDITED]=r.I18N.EDITED,s[r.RecentItemActionType.ADDED]=r.I18N.ADDED,s);t.getActionTypeLocalizedString=function(e){return d[u(e)]}})),define("modules/clean/react/home/recents/components/pending_attachment_list_view",["require","exports","tslib","classnames","react","external/lodash"],(function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importDefault(o),r=n.__importStar(r);var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.count,t=r.times(Math.min(e,4),(function(){return o.default.createElement("li",{className:"attachment-item attachment-item--placeholder"})})),n={"attachment-list":!0,"attachment-list--is-pending":!0,"attachment-list--standalone":1===e};return o.default.createElement("div",{className:"recents-item__attachments"},o.default.createElement("ul",{className:i.default(n)},t))},t})(o.default.Component);t.PendingAttachmentListView=a})),define("modules/clean/react/home/recents/components/recent_activity_container",["require","exports","tslib","react","react-dom","classnames","modules/core/i18n","modules/clean/react/home/recents/actions/recent_activity_actions","modules/clean/react/home/section_header","modules/clean/react/home/util/show_hide_link","modules/clean/react/home/recents/stores/recent_activity_store","modules/clean/react/home/store","modules/clean/react/home/util/logging/timing_component","modules/clean/react/home/util/logging/timing_logger","modules/clean/react/home/util/logging/activity_logger","modules/clean/react/home/recents/components/recent_activity_item_container","modules/clean/react/home/constants","modules/clean/react/home/post_tti/api","modules/clean/react/home/actions"],(function(e,t,n,i,o,r,a,s,c,l,u,d,m,_,h,p,E,f,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importDefault(o),r=n.__importDefault(r);var I=(function(e){function t(t){var i=e.call(this,t)||this;return i.onShouldLoadMore=function(){var e=u.getRecentActivityStore();if(!i.state.isPending&&i.state.showAll&&!e.didTruncateRecentItems()&&e.didReceiveItemsFromAllStreams()){var t=e.getRecentItems().items;t.length>i.state.items.length?i.setState({items:t}):s.loadNextPage()&&i.setState({isPending:!0})}},i.onChangeRecentsVisibility=function(){var e=!i.props.isHiddenByUser;T.HomeActions.setSectionVisibility(d.getUserId(),{".tag":"recents"},!e),h.homeActivityLogger.logShowHideSection(E.HomeSections.RECENTS,e)},i.handleVisibilityChange=function(){"visible"===document.visibilityState&&s.refreshRecentItems()},i.onStoreUpdate=function(){return i.setState(i.getStateFromStore())},i.onShowAll=function(){i.setState({showAll:!0});var e=o.default.findDOMNode(i.refs.lastUnhiddenActivity);if(e){var t=e.querySelector("a");t&&t.focus()}},i.removeStoreListeners=u.getRecentActivityStore().addListener(i.onStoreUpdate),i.state=n.__assign(n.__assign({},i.getStateFromStore()),{isUnityAvailable:!1,showAll:!1}),i}return n.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.isHiddenByUser&&_.homeTimingLogger.logSkippedSection(E.HomeSections.RECENTS),f.waitForHomeTTI().then((function(t){return n.__awaiter(e,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return t.recentActivityContainerComponentDidMount(this.onShouldLoadMore),[4,t.getUnityFeatures()];case 1:return e.sent()&&this.setState({isUnityAvailable:!0}),[2]}}))}))})),!this.state.items.length&&u.getRecentActivityStore().didReceiveItemsFromAllStreams()&&this.setState({isPending:!1}),document.addEventListener("visibilitychange",this.handleVisibilityChange,!1)},t.prototype.componentWillUnmount=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.removeStoreListeners()},t.prototype.getStateFromStore=function(){var e=u.getRecentActivityStore(),t=!e.didReceiveItemsFromAllStreams(),n=e.getRecentItems().items;if(!t&&_.homeTimingLogger.logTTData(E.HomeSections.RECENTS)){var i=n.length;i&&h.homeActivityLogger.logRecentsShown(i,!d.getHomeStore().getSectionVisibility()[E.HomeSections.RECENTS])}return{isPending:t,items:n}},t.prototype.renderLoadingView=function(){return i.default.createElement("div",{className:"recents-loading-view",key:"loading"},i.default.createElement("div",{className:"maestro-loading-spinner recents-loading-indicator"}))},t.prototype.renderItems=function(){var e=this.props.now,t=this.state,n=t.items,o=t.showAll,a=t.isPending,s={isUnityAvailable:t.isUnityAvailable,now:e,user:d.getUser()},c=o?n:n.slice(0,10);return i.default.createElement("ul",{className:"recents-view__sections",key:"sections"},i.default.createElement("li",{className:"recents-section"},i.default.createElement("ul",{className:r.default({"recents-list":!0,"recents-list--is-pending":a&&0===c.length})},c.map((function(e,t){return i.default.createElement(p.RecentActivityItemContainer,{key:e.id,recentItem:e,renderingInfo:s,ref:9===t?"lastUnhiddenActivity":void 0})})))))},t.prototype.renderShowMoreLink=function(){var e=this.state,t=e.items,n=e.showAll,o=Math.max(t.length-10,0);return n||!s.hasCursor()&&o<=0?null:i.default.createElement(l.ShowHideLink,{key:"show_more",onClick:this.onShowAll,isExpanded:!1,hiddenItemCount:o,canLoadMore:!0})},t.prototype.renderContent=function(){var e=this.state,t=e.isPending;return e.items.length?[this.renderItems(),t?this.renderLoadingView():null,this.renderShowMoreLink()]:t?[this.renderLoadingView(),this.renderItems()]:i.default.createElement("div",{className:"recents-empty_state",key:"empty_state"},i.default.createElement("div",{className:"recents-empty_state_heading"},a._("Items you recently viewed show up here.")+" ",i.default.createElement("a",{href:"/help/desktop-web/recents-overview",target:"_blank",rel:"noopener noreferrer"},a._("Learn more"))))},t.prototype.render=function(){var e=this.props,t=e.canRenderItems,n=e.isHiddenByUser;if(!t)return null;var o=this.state,s=o.isPending,l=o.items,u=r.default({"home-recents-section__container":!0,"recents-view":!0,"recents-view--is-pending":s&&0===l.length});return i.default.createElement("li",{className:"home-access-section"},i.default.createElement("span",{className:"home-recents-section"},i.default.createElement(c.SectionHeader,{title:a._("Recent"),ueName:"recents",buttonText:n?a._("Show"):a._("Hide"),buttonAction:this.onChangeRecentsVisibility}),i.default.createElement("div",{className:"home-access-section__content"},n?i.default.createElement("div",{className:"home-access__recents-hidden-text"},a._("Your recently viewed files are hidden")," · ",i.default.createElement("button",{className:"button-as-link",onClick:this.onChangeRecentsVisibility},a._("Show"))):i.default.createElement("div",{className:u},this.renderContent()))))},t.displayName="RecentActivityContainer",t})(i.default.PureComponent);t.RecentActivityContainerInner=I,t.RecentActivityContainer=m.timingComponent(I,E.HomeSections.RECENTS)})),define("modules/clean/react/home/recents/components/recent_activity_item_actions_view",["require","exports","tslib","classnames","react","modules/core/i18n","external/lodash","modules/clean/react/home/recents/recent_activity_rendering_models","modules/clean/react/home/recents/actions/recent_activity_action_permissions","spectrum/overflow_button","spectrum/popover"],(function(e,t,n,i,o,r,a,s,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importDefault(o);var d=function(e){e.stopPropagation(),e.preventDefault()},m=function(e,t){e(t)},_=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onOpen=function(e){t.getHandler(e).handleOpen()},t.onDelete=function(e){t.getHandler(e).handleDelete()},t.onArchive=function(e){t.getHandler(e).handleArchive()},t.onShare=function(e){t.getHandler(e).handleShare()},t.onDownload=function(e){t.getHandler(e).handleDownload()},t.onComment=function(e){t.getHandler(e).handleComment(e)},t.onVersions=function(e){t.getHandler(e).handleVersions(e)},t.onViewInFolder=function(e){t.getHandler(e).handleViewInFolder()},t}return n.__extends(t,e),t.prototype.getHandler=function(e){return e.preventDefault(),this.props.handler},t.prototype.createMenuItem=function(e,t,n,i){return e?o.default.createElement(u.PopoverContentItem,{className:"recents-actions-list__item recents-actions-list__item--"+t,key:t,value:i},n):null},t.prototype.renderMoreActionsList=function(){var e=this.props,t=e.permissions,n=e.renderingInfo,i=e.attachmentCount,o=t.open,s=t.share,c=t.download,l=t.comment,u=t.archive,d=t.versions,m=t.viewInFolder,_=n.isUnityAvailable;return a.compact([this.createMenuItem(o&&_,"open",r._("Open"),this.onOpen),this.createMenuItem(s,"share",r._("Share"),this.onShare),this.createMenuItem(c,"download",r._("Download"),this.onDownload),this.createMenuItem(l,"comment",r._("Comment"),this.onComment),this.createMenuItem(t.delete,"delete",i>1?r._("Delete all…"):r._("Delete…"),this.onDelete),this.createMenuItem(u,"archive",r._("Archive"),this.onArchive),this.createMenuItem(d,"versions",r._("Version history"),this.onVersions),this.createMenuItem(m,"viewInFolder",r._("View in folder"),this.onViewInFolder)])},t.prototype.renderMoreActionsInnerButton=function(){var e=i.default({"recents-item__actions-button":!0,"button-secondary":!0,disabled:this.props.disableActions});return o.default.createElement(l.OverflowButton,{tagName:"span",className:e,"aria-label":r._("More Actions")})},t.prototype.renderMoreActionsButton=function(){return this.props.disableActions?this.renderMoreActionsInnerButton():o.default.createElement("div",{onClick:d},o.default.createElement(u.Popover,{onSelection:m},o.default.createElement(u.PopoverTrigger,null,this.renderMoreActionsInnerButton()),o.default.createElement(u.PopoverContent,{attachment:"right"},this.renderMoreActionsList())))},t.prototype.render=function(){var e,t=this.props.permissions;if(c.shouldRenderActionsMenu(t)){var n=this.props,r=n.disableActions,a=n.isShareItem,s=i.default(((e={})["recents-item__more-actions"]=!0,e["recents-item__more-actions--disabled"]=r,e));return a?o.default.createElement("div",{className:s}):o.default.createElement("div",{className:s},o.default.createElement("div",{className:"recents-item__more-actions-button recents-item__action-button",tabIndex:-1},this.renderMoreActionsButton()))}return null},t.defaultProps={handler:s.getStubRecentActivityItemContainerHandler(),tooltipHandler:s.getStubRecentActivityTooltipHandler(),attachmentCount:1,disableActions:!1},t})(o.default.PureComponent);t.RecentActivityItemActionsView=_})),define("modules/clean/react/home/recents/components/recent_activity_item_container",["require","exports","tslib","external/lodash","react","modules/core/exception","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/actions/recent_activity_actions","modules/clean/react/home/recents/components/recent_activity_item_view","modules/clean/react/home/recents/utils/events","modules/clean/react/home/recents/stores/attachment_store","modules/clean/react/home/post_tti/api"],(function(e,t,n,i,o,r,a,s,c,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var m=(function(e){function t(t){var n=e.call(this,t)||this;return n.onAttachmentStoreChange=function(){n.setState({attachments:u.getAttachmentStore().getByIds(n.getRecentItem().attachmentIds)})},n.handleArchive=function(){return s.archiveRecentItem(n.getRecentItem(),n.getLogData())},n.handleComment=function(e){var t=n.getSingleAttachment("handleComment only supports a single attachment"),i=Math.max(0,n.state.attachments.indexOf(t));n.previewOrOpenFiles({event:e,index:i,isCommentAction:!0})},n.handleDelete=function(){s.deleteRecentItem(n.getRecentItem(),n.state.attachments,n.getLogData())},n.handleDownload=function(){var e=n.getSingleAttachment("handleDownload only supports a single attachment");s.downloadFiles([e.id],n.getLogData())},n.handleHeaderClick=function(){var e=n.state,t=e.isCollapsed,i=e.attachments,o=t?a.ActionType.UNCOLLAPSE:a.ActionType.COLLAPSE;l.logEvent(o,n,n.state.attachments,i.length),n.setState({isCollapsed:!t})},n.handleOpen=function(){var e=n.getSingleAttachment("handleOpen only supports a single attachment");s.openFile(e.id,n.getLogData())},n.handlePathClick=function(e){e.preventDefault(),e.stopPropagation();var t=n.getAttachmentFqPaths(),i=n.props.recentItem,o=i.attachmentIds,r=i.viewingUserId,s=e.currentTarget.href;d.waitForHomeTTI().then((function(e){var i=e.logOpenPathUrl,c=e.openUrl;i(r,t,o.length,n),c(s,a.ActionType.OPEN_PATH,o,n.getLogData())}))},n.handleViewInFolder=function(){var e=n.getAttachmentFqPaths(),t=n.props.recentItem,o=t.attachmentIds,r=t.viewingUserId;d.waitForHomeTTI().then((function(s){var c=s.logViewInFolder,l=s.openUrl;c(r,e,o.length,n),l(i.last(t.paths).url,a.ActionType.VIEW_IN_FOLDER,o,n.getLogData())}))},n.handlePreview=function(e){n.previewOrOpenFiles({event:e})},n.handleShare=function(e){s.shareRecentItem(n.getRecentItem(),n.state.attachments,n.getLogData(),e)},n.handleVersions=function(e){var t=n.getSingleAttachment("handleVersions only supports a single attachment");s.openVersions(t.id,e,n.getLogData())},n.removeStoreListeners=null,n.state={attachments:[],isCollapsed:!0},n}return n.__extends(t,e),t.prototype.getRecentItem=function(){return this.props.recentItem},t.prototype.getLogData=function(){return{totalCount:this.props.recentItem.attachmentIds.length,cellView:this}},t.prototype.getAttachmentFqPaths=function(){return i.compact(i.map(this.state.attachments,"fqPath"))},t.prototype.getSingleAttachment=function(e){return e&&r.assert(1===this.state.attachments.length,e),this.state.attachments[0]},t.prototype.previewOrOpenFiles=function(e){var t=this.props.recentItem;s.previewRecentItem(t,n.__assign({},e),this.getLogData())},t.prototype.componentWillMount=function(){this.removeStoreListeners=u.getAttachmentStore().addListener(this.onAttachmentStoreChange),this.onAttachmentStoreChange()},t.prototype.componentWillUnmount=function(){this.removeStoreListeners&&this.removeStoreListeners()},t.prototype.render=function(){return o.default.createElement(c.RecentActivityItemView,{recentItem:this.getRecentItem(),attachments:this.state.attachments,handler:this,isCollapsed:this.state.isCollapsed,renderingInfo:this.props.renderingInfo})},t.displayName="RecentActivityItemContainer",t})((o=n.__importDefault(o)).default.PureComponent);t.RecentActivityItemContainer=m})),define("modules/clean/react/home/recents/components/recent_activity_item_header_view",["require","exports","tslib","classnames","react","spectrum/icon_arrow","modules/clean/accessibility/utils","modules/clean/react/helpers","modules/clean/react/home/constants","modules/clean/react/home/util/resource_icon","modules/core/i18n","modules/clean/react/home/recents/recent_activity_view_helper"],(function(e,t,n,i,o,r,a,s,c,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importDefault(o),s=n.__importStar(s);var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.stopPropagation(),e.preventDefault(),t.props.handleClick(e)},t}return n.__extends(t,e),t.prototype.getHeaderProps=function(){return this.props.header},t.prototype.renderIcon=function(){var e=this.getHeaderProps(),t=e.isAggregation,n=e.displayType,i=e.fileName;return o.default.createElement("div",{className:"recents-item__icon"},o.default.createElement("span",{className:"file-icon file-icon--sprite file-icon--spectrum"},o.default.createElement(l.HomeResourceIcon,{className:"file-icon__img",displayType:t?c.DisplayTypes.AGGREGATION:n||c.DisplayTypes.FILE,fileName:i||""})))},t.prototype.renderHeading=function(){var e=this.getHeaderProps(),t=e.fileName,i=e.heading,r=this.getHeaderProps().displayType;return o.default.createElement("a",n.__assign({ref:"heading",className:"recents-item__heading","aria-label":i?i.toString():t||void 0},a.accessibleTriggerProps(this.props.handleClick,r===c.DisplayTypes.SHARED_FOLDER?"link":"button")),i)},t.prototype.renderSubheading=function(){var e=this.getHeaderProps().subheading;return e?o.default.createElement("div",{ref:"subheading",className:"recents-item__subheading",tabIndex:-1},e):null},t.prototype.renderDetails=function(){return o.default.createElement("div",{ref:"recentsItemDetails",className:"recents-item__details"},o.default.createElement("div",{className:"recents-item__heading-group"},this.renderHeading(),this.renderStar()),this.renderSubheading())},t.prototype.renderStar=function(){var e=this.getHeaderProps(),t=e.disableStar,n=e.star;return t?null:n?o.default.createElement("div",{className:"recents-item__star"},n):null},t.prototype.renderActions=function(){var e,t=this.props,n=t.children,r=t.isShareItem,a=t.tooltipShown;if(r||0===o.default.Children.count(n))return null;var s=i.default(((e={})["recents-item__actions-inner"]=!0,e["recents-item__actions-inner--tooltip-shown"]=a,e));return o.default.createElement("div",{ref:"actions",className:"recents-item__actions"},o.default.createElement("div",{className:s},n))},t.prototype.renderCarat=function(){var e=this.getHeaderProps(),t=e.isAggregation,s=e.isCollapsed;if(!t)return null;var c=i.default({"recents-item__carat":!0,"recents-item__carat--expanded":!s}),l=s?u._("Expand"):u._("Collapse");return o.default.createElement("div",n.__assign({className:c,role:"button"},a.accessibleTriggerProps(this.props.handleClick),{"aria-label":l}),o.default.createElement(r.IconArrow,{name:"right"}))},t.prototype.shouldComponentUpdate=function(e,t){return s.compareStateAndProps(e,t)},t.prototype.render=function(){return o.default.createElement("div",{className:"recents-item__wrapper",onClick:d.ensureUserIntentToClick(this.onClick)},this.renderCarat(),this.renderIcon(),this.renderDetails(),this.renderActions())},t.defaultProps={handleClick:function(e){return null},tooltipShown:!1},t})(o.default.Component);t.RecentActivityItemHeaderView=m})),define("modules/clean/react/home/recents/components/recent_activity_item_view",["require","exports","tslib","classnames","react","external/lodash","modules/core/exception","modules/core/i18n","modules/clean/em_string","modules/clean/datetime","modules/clean/react/helpers","modules/clean/react/home/recents/actions/recent_activity_action_permissions","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/models/utils","modules/clean/react/home/recents/recent_activity_rendering_models","modules/clean/react/home/recents/recent_activity_view_helper","modules/clean/react/home/recents/recent_activity_text_helper","modules/clean/react/home/recents/components/pending_attachment_list_view","modules/clean/react/home/recents/components/recent_activity_item_header_view","modules/clean/react/home/util/conditional_api","modules/clean/react/title_bubble","modules/clean/react/starred/constants","modules/clean/react/home/recents/components/recent_activity_item_actions_view","modules/clean/react/home/util/post_tti_components"],(function(e,t,n,i,o,r,a,s,c,l,u,d,m,_,h,p,E,f,T,I,g,y,R,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importDefault(o),u=n.__importStar(u),E=n.__importStar(E);var v=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleMouseEnter=function(){n.setState({isHovered:!0})},n.handleMouseLeave=function(){n.setState({isHovered:!1})},n.onShare=function(e){e.preventDefault(),n.props.handler.handleShare()},n.onShowTooltip=function(){n.setState({tooltipShown:!0})},n.onHideTooltip=function(){n.setState({tooltipShown:!1})},n.state={tooltipShown:!1,isHovered:!1},n}return n.__extends(t,e),t.prototype.shouldDisableActions=function(){var e=this.props.recentItem.federatedRecentItem;return e?!e.hasMenuActions():!this.hasLoadedAttachments()},t.prototype.isAggregation=function(){return this.props.recentItem.attachmentIds.length>1},t.prototype.shouldShowThumbnails=function(){var e=this.props.recentItem;return!_.isShareRecentItem(e)&&_.shouldShowThumbnailsForRecentItem(e)},t.prototype.getLoadedAttachmentsCount=function(){return this.props.attachments.filter((function(e){return e.isLoaded})).length},t.prototype.canRenderAttachmentView=function(){var e=this.getLoadedAttachmentsCount();return e===this.props.recentItem.attachmentIds.length||e>=m.MAX_INITIAL_THUMBNAIL_ATTACHMENTS},t.prototype.hasLoadedAttachments=function(){return!(!this.props.attachments.length||!this.getLoadedAttachmentsCount())},t.prototype.getHeading=function(){var e=this.props,t=e.attachments,n=e.recentItem;if(t.length<2)return c.Emstring.em_snippet(n.displayName||"",30);for(var i=n.attachmentIds.length,o=n.uniqueFilterTypes,r=[],a=0,l=t;a<l.length;a++){var u=l[a];u.isLoaded&&u.displayName&&r.push(u.displayName)}switch(o.length){case 1:switch(o[0]){case m.RECENT_EVENT_FILTER_TYPE.PHOTOS:return s.ungettext("%(count)s image","%(count)s images",i).format({count:i});case m.RECENT_EVENT_FILTER_TYPE.VIDEOS:return s.ungettext("%(count)s video","%(count)s videos",i).format({count:i});case m.RECENT_EVENT_FILTER_TYPE.VISUAL_NOTES:return s.ungettext("%(count)s visual note","%(count)s visual notes",i).format({count:i})}break;case 2:if(o.indexOf(m.RECENT_EVENT_FILTER_TYPE.PHOTOS)>=0&&o.indexOf(m.RECENT_EVENT_FILTER_TYPE.VIDEOS)>=0)return s._("%(count)s images and videos").format({count:i})}return r.length?E.snippetList(r,30,{totalCount:i}):s.ungettext("%(count)s file","%(count)s files",i).format({count:i})},t.prototype.getParentPathComponent=function(){var e=this.props.recentItem,t=e.type,n=e.paths;if(_.isShareRecentItem(e))return t===m.RECENT_EVENT_TYPES.FILE_SHARED_ADD?{name:s._("Your links"),url:"/links/your_links"}:null;if(n.length){var i=r.last(n);if(i.url)return i}return null},t.prototype.getSubheading=function(){var e=this.getParentPathComponent(),t=this.props,n=t.renderingInfo,i=t.recentItem,r=t.handler,a=new Date(i.when);return o.default.createElement("div",{className:"recents-item__subheading"},_.getActionTypeLocalizedString(i)+" ",o.default.createElement(g.TitleBubble,{position:g.TitleBubble.POSITIONS.TOP,content:o.default.createElement("div",{className:"recents-item__subheading-time-tooltip"},l.format_date(a,"MMM d, yyyy")+"\n"+l.format_date(a,l.localized_time_format))},o.default.createElement("div",{className:"recents-item__subheading-time"},l.agoFromDate(a,n.now,!1,!0))),e?" · ":"",e?o.default.createElement("a",{"aria-label":e.name,className:"recents-item__subheading-parent",href:e.url,onClick:r.handlePathClick},e.name):null)},t.prototype.renderShareButton=function(){var e=this.props.recentItem.federatedRecentItem;return(e?e.isShareable():this.hasLoadedAttachments())?o.default.createElement("a",{ref:"share",className:"button-secondary recents-item__share",href:"#share",onClick:this.onShare,role:"button"},s._("Share")):null},t.prototype.renderAttachments=function(){var e=this.props,t=e.recentItem,n=e.attachments;if(this.shouldShowThumbnails()){if(this.props.isCollapsed)return null;var i=t.attachmentIds.length;return this.canRenderAttachmentView()?o.default.createElement(S.PostTTIRecentActivityImageAttachments,{key:"pendingAttachments",attachments:n,count:i}):o.default.createElement(f.PendingAttachmentListView,{key:"attachments",count:i})}return this.isAggregation()&&a.reportStack("Tried to render non-photo aggregation but failed",{severity:a.SEVERITY.NONCRITICAL,exc_extra:{recent_item:t,attachments:n}}),null},t.prototype.renderButton=function(e){return e.share?o.default.createElement("div",{className:"recents-item__sharing recents-item__action-button"},this.renderShareButton()):null},t.prototype.renderStar=function(){var e=this.props,t=e.attachments,n=e.recentItem,i=e.renderingInfo,r=Boolean(t.length>0&&t[0].isDir);return I.waitForStarred((function(e){var t=e.Star,a=(0,e.getIdTypePairFromRecentItem)(n);return a?o.default.createElement(t,{id:a.id,idType:a.type,isDir:r,user:i.user,source:y.StarredSource.HOME_RECENTS}):null}),!1)},t.prototype.getHeaderProps=function(){var e=this.props,t=e.recentItem,n=e.isCollapsed,i=e.attachments,o=t.displayName,r=t.displayType;return{heading:this.getHeading(),subheading:this.getSubheading(),thumbnailUrl:1===i.length&&i[0].thumbnailUrl||void 0,star:this.renderStar(),fileName:o,isAggregation:this.isAggregation(),displayType:r,isCollapsed:n,disableStar:!!t.scl}},t.prototype.renderHeader=function(){var e=this.props,t=e.recentItem,n=e.attachments,i=e.handler,r=e.renderingInfo,a=d.getRecentActivityItemViewPermissions(t,n),s=_.isShareRecentItem(t);return o.default.createElement(T.RecentActivityItemHeaderView,{ref:"header",key:"header",header:this.getHeaderProps(),handleClick:this.isAggregation()?i.handleHeaderClick:i.handlePreview,isShareItem:s,tooltipShown:this.state.tooltipShown},this.renderButton(a),o.default.createElement(S.PostTTIRecentsActivityFileActions,{recentItem:this.props.recentItem,attachments:this.props.attachments}),o.default.createElement(R.RecentActivityItemActionsView,{ref:"recentsItemActionsView",handler:i,tooltipHandler:this,isShareItem:s,permissions:a,attachmentCount:t.attachmentIds.length,disableActions:this.shouldDisableActions(),rowIsHovered:this.state.isHovered,renderingInfo:r}))},t.prototype.shouldComponentUpdate=function(e,t){return u.compareStateAndProps(e,t)},t.prototype.render=function(){var e,t=this.props,n=t.recentItem,r=t.handler,a=i.default(((e={})["recents-item"]=!0,e["recents-item--loaded"]=this.hasLoadedAttachments(),e)),s=this.isAggregation()?void 0:p.ensureUserIntentToClick(r.handlePreview);return o.default.createElement("li",{"data-item-id":n.id,"data-item-type":n.type,"data-item-date":n.when,className:a,onClick:s,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},this.renderHeader(),this.renderAttachments())},t.displayName="RecentActivityItemView",t.defaultProps={handler:h.getStubRecentActivityItemContainerHandler(),isCollapsed:!0,attachments:[]},t})(o.default.Component);t.RecentActivityItemView=v})),define("modules/clean/react/home/recents/recent_activity_client_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPayload=function(e){if("ok"===e.status)return e.payload;throw new Error("Payload not okay: "+JSON.stringify(e))},t.isSFJRecentItem=function(e){return void 0!==e.activity_key},t.isPaperRecentItem=function(e){return void 0!==e.time}})),define("modules/clean/react/home/recents/recent_activity_dispatcher",["require","exports","flux"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recentActivityDispatcher=new n.Dispatcher})),define("modules/clean/react/home/recents/recent_activity_logger_utils",["require","exports","tslib","modules/clean/web_timing_logger"],(function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var o=!1,r=!1;t.getRecentsLoggingData=function(){if(!r){var e=i.start_time();if(e)return r=!0,{isFullPage:!0,startTime:e}}return{isFullPage:!1,startTime:Date.now()}},t.reset=function(){r=!1,o=!1},t.canLogFirstAction=function(){return!o},t.onLogFirstAction=function(){o=!0}})),define("modules/clean/react/home/recents/recent_activity_rendering_models",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStubRecentActivityItemContainerHandler=function(){return{handleArchive:function(){},handleComment:function(e){},handleDelete:function(){},handleDownload:function(){},handleHeaderClick:function(){},handleOpen:function(){},handlePathClick:function(){},handlePreview:function(e){},handleShare:function(){},handleVersions:function(e){},handleViewInFolder:function(){}}},t.getStubRecentActivityTooltipHandler=function(){return{onShowTooltip:function(){},onHideTooltip:function(){}}}})),define("modules/clean/react/home/recents/recent_activity_stream",["require","exports","tslib","external/lodash","modules/clean/react/home/recents/models/utils"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var r=(function(){function e(e,t){var n=this;this.sortedRecentItems=e,this.hasMore=t,this.activityKeyToRecentItem={},e.forEach((function(e){n.activityKeyToRecentItem[e.id]=e})),this.oldestTimeForOtherStream=this.getOldestItemTimeForOtherStreams()}return e.prototype.getOldestItemTimeForOtherStreams=function(){return this.hasMore&&this.sortedRecentItems.length&&this.sortedRecentItems[this.sortedRecentItems.length-1].when||0},e.prototype.getRecentItems=function(){return this.sortedRecentItems.slice()},e.prototype.getRecentItemByActivityKey=function(e){return this.activityKeyToRecentItem[e]||null},e.prototype.getStreamWithoutActivityKey=function(t){return new e(this.sortedRecentItems.filter((function(e){return e.id!==t})),this.hasMore)},e.prototype.getItemsAfter=function(e){if(this.oldestTimeForOtherStream<e){for(var t=[],n=0,i=this.sortedRecentItems;n<i.length;n++){var o=i[n];if(o.when<e)break;t.push(o)}return t}return this.sortedRecentItems},e})();t.RecentActivityStream=r,t.getMergedRecentItems=function(e){var t,n=e.filter(Boolean),r=i.max(n.map((function(e){return e.oldestTimeForOtherStream})));return(t=[]).concat.apply(t,n.map((function(e){return e.getItemsAfter(r)}))).sort(o.compareRecentItems)}})),define("modules/clean/react/home/recents/recent_activity_text_helper",["require","exports","modules/clean/em_string","modules/core/i18n"],(function(e,t,n,i){"use strict";function o(e,t){return i.ungettext("%(name)s and %(num)s other","%(name)s and %(num)s others",t).format({name:e,num:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.snippetList=function(e,t,r){void 0===r&&(r={});var a=Math.max(Math.floor(r.totalCount||0),e.length);if(1===a)return n.Emstring.em_snippet(e[0],t);var s=e[0],c=a-1,l=o(s,c);if(new n.Emstring(l).length>t){var u=Math.floor(t-new n.Emstring(o("",c)).length)-1;l=u<3?i.ungettext("%(num)s other","%(num)s others",a).format({num:a}):o(n.Emstring.em_snippet(s,u),c)}for(var d="",m=1;m<e.length&&(m+=1,d=e.slice(0,m).join(", "),m<a&&(d=o(d,a-m)),new n.Emstring(d).length<t);)l=d;return l}})),define("modules/clean/react/home/recents/recent_activity_view_helper",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureUserIntentToClick=function(e){return function(t){var n=window.getSelection();if(null===n||!n.toString()){for(var i=t.target;i&&i.parentNode&&i!==t.currentTarget;){if(["a","button"].indexOf(i.nodeName.toLowerCase())>=0)return;i=i.parentNode}e.apply(this,arguments)}}}})),define("modules/clean/react/home/recents/store_utils",["require","exports","tslib","modules/clean/react/home/store","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/recent_activity_logger_utils","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/models/utils","modules/clean/react/home/recents/recent_activity_client_utils"],(function(e,t,n,i,o,r,a,s,c){"use strict";function l(e,t){return n.__awaiter(this,void 0,Promise,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t()];case 1:return[2,n.sent()];case 2:throw o=n.sent(),e().then((function(e){return(0,e.logRequestFailed)(i.getUserId(),o)})),o;case 3:return[2]}}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.handleAndLogRecentsJsonPromise=function(e,t,u){var d=this;void 0===u&&(u=!0);try{var m=r.getRecentsLoggingData(),_=c.getPayload(t),h=_.recent_activities,p=_.cursor,E=_.encrypted,f=_.use_assistant_service,T=i.getUserId(),I=[],g=[];return h.forEach((function(e){c.isPaperRecentItem(e)?I.push(e):c.isSFJRecentItem(e)&&g.push(e)})),f&&o.recentActivityDispatcher.dispatch({type:a.RECEIVE_PAPER_RECENT_ITEMS,items:I,hasMore:!1,userId:T}),o.recentActivityDispatcher.dispatch({type:a.RECEIVE_RAW_RECENT_ACTIVITIES,rawRecentActivities:g,cursor:p||"",encrypted:E||"",userId:T}),l(e,(function(){return n.__awaiter(d,void 0,void 0,(function(){var t,i,o;return n.__generator(this,(function(n){switch(n.label){case 0:return t=[],g.forEach((function(e){if(e.skeleton_data&&e.related_activity_keys){var n=s.shouldShowThumbnailsForSkeletonData(e.skeleton_data)?a.MAX_INITIAL_THUMBNAIL_ATTACHMENTS:a.MAX_INITIAL_DOC_ATTACHMENTS;t=t.concat.apply(t,e.related_activity_keys.slice(0,n))}})),[4,e()];case 1:return[4,n.sent().ensureAttachments(t,a.EnsureAttachmentsPurpose.RECENTS_JSON_CONTINUATION)];case 2:return n.sent(),i=!1,o=0,g.forEach((function(e){var t=e.skeleton_data;t&&(o+=t.num_related_activities||0,(t.num_related_activities||0)>1&&(i=!0))})),e().then((function(e){return(0,e.logRecentsLoaded)(T,m,{is_paginated:!u,contains_aggregation:i,item_count:o})})),[2]}}))}))}))}catch(t){throw e().then((function(e){return(0,e.logRequestFailed)(i.getUserId(),t)})),t}},t.logErrorAndRethrowAsync=l,t.handleRetrievePaperRecentsPromise=function(e,t,n){void 0===n&&(n=!0);var r=i.getUserId(),s=c.getPayload(t);if(!s.use_assistant_service){var l=n&&s.has_more;o.recentActivityDispatcher.dispatch({type:a.RECEIVE_PAPER_RECENT_ITEMS,items:s.items,hasMore:l,userId:r}),l&&e().then((function(e){return(0,e.loadPaperRecentItems)(!1)}))}}})),define("modules/clean/react/home/recents/stores/attachment_store",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/constants","external/lodash","modules/clean/flux/flux_store","modules/clean/react/home/recents/actions/error_actions","modules/clean/react/home/recents/stores/flux_utils","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/models/attachment","modules/core/exception"],(function(e,t,n,i,o,r,a,s,c,l,u,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r);var _=(function(e){function t(t,n){void 0===n&&(n={});var i=e.call(this,t)||this;return i.onCommit=function(e){delete i.transactionHistory[e.transactionId]},i._onDeleteFilesPending=function(e){for(var t=[],n=0,o=e.attachmentIds;n<o.length;n++){var r=o[n];r in i.attachmentIdToAttachment&&(t.push(i.attachmentIdToAttachment[r]),delete i.attachmentIdToAttachment[r])}i.transactionHistory[e.transactionId]={deletedAttachments:t},c.emitChangeIfNeeded(i,!!t.length)},i._onDeleteFilesRollback=function(e){var t=i.transactionHistory[e.transactionId];m.assert(!!t,"Unable to find data for transaction with id: "+e.transactionId),t.deletedAttachments.forEach((function(e){return i.attachmentIdToAttachment[e.id]=e})),c.emitChangeIfNeeded(i,!!t.deletedAttachments.length)},i.pendingActivityKeys=[],i.attachmentIdToEncryptedToken={},i.attachmentIdToAttachment={},(n.attachments||[]).forEach((function(e){i.attachmentIdToAttachment[e.id]=e,n.encryptedToken&&(i.attachmentIdToEncryptedToken[e.id]=n.encryptedToken)})),i.transactionHistory={},i}return n.__extends(t,e),t.prototype.areSomeActivityKeysPending=function(e){return!!r.intersection(this.pendingActivityKeys,e).length},t.prototype.getById=function(e){return this.attachmentIdToAttachment[e]||null},t.prototype.getByIds=function(e){return r.values(r.pick(this.attachmentIdToAttachment,e))},t.prototype.getByFqPath=function(e){return this.getAll().find((function(t){return t.fqPath===e}))||null},t.prototype.getAll=function(){return r.values(this.attachmentIdToAttachment)},t.prototype.groupIdsByEncryptedToken=function(e){var t=this;return r.groupBy(e.filter((function(e){return e in t.attachmentIdToEncryptedToken})),(function(e){return t.attachmentIdToEncryptedToken[e]}))},t.prototype.__onDispatch=function(e){switch(e.type){case l.ADD_PENDING_ACTIVITY_KEYS:this.onAddPendingActivityKeys(e);break;case l.REMOVE_PENDING_ACTIVITY_KEYS:this.onRemovePendingActivityKeys(e);break;case l.DELETE_FILES_COMMIT:this.onCommit(e);break;case l.DELETE_FILES_PENDING:this._onDeleteFilesPending(e);break;case l.DELETE_FILES_ROLLBACK:this._onDeleteFilesRollback(e);break;case l.RECEIVE_RAW_RECENT_ACTIVITIES:this.onReceiveRawRecentActivities(e);break;case l.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY:this.onReceiveRawRelatedActivitiesByKey(e);break;case l.RECEIVE_CAN_OPEN_INFO:this.onReceiveCanOpenInfo(e);break;case l.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO:this._onReceiveFileInRootCollectionInfo(e)}},t.prototype.mutateAttachmentInNsIdPath=function(e,t){if(e&&e.indexOf(":")>=0){var n=e.split(":"),i=n[0],o=n[1],r=this.getAll().find((function(e){return e.nsId===Number(i)&&e.nsPath===o}))||null;if(r){var a=c.getMutatedOrOriginal(r,t);if(a!==r)return this.attachmentIdToAttachment[r.id]=a,!0}}return!1},t.prototype.updatePendingActivityKeys=function(e,t){var i,o=this.pendingActivityKeys.length;if(t){var a=(i=this.pendingActivityKeys).concat.apply(i,e);this.pendingActivityKeys=r.uniq(a)}else this.pendingActivityKeys=r.without.apply(r,n.__spreadArrays([this.pendingActivityKeys],e));c.emitChangeIfNeeded(this,o!==this.pendingActivityKeys.length)},t.prototype.onAddPendingActivityKeys=function(e){this.updatePendingActivityKeys(e.activityKeys,!0)},t.prototype.onRemovePendingActivityKeys=function(e){this.updatePendingActivityKeys(e.activityKeys,!1)},t.prototype.onReceiveRawRecentActivities=function(e){var t,n=this,i=e.rawRecentActivities.map(d.createPartialAttachmentsFromRecentActivity),o=(t=[]).concat.apply(t,i).filter((function(e){var t=n.getById(e.id);return!t||!t.isLoaded}));o.forEach((function(t){n.attachmentIdToAttachment[t.id]=t,n.attachmentIdToEncryptedToken[t.id]=e.encrypted})),c.emitChangeIfNeeded(this,!!o.length)},t.prototype.onReceiveRawRelatedActivitiesByKey=function(e){var t=this;if(e.rawRelatedActivitiesByKey){var n=Object.keys(e.rawRelatedActivitiesByKey);this.updatePendingActivityKeys(n,!1);var a={};c.iterateAndEmitChangesIfNeeded(this,e.rawRelatedActivitiesByKey,(function(e,n){try{var i=d.convertFileActivityToAttachmentItem(e);return i.previewInfo&&!i.previewInfo.is_dir&&(a[i.id]=i.previewInfo),t.attachmentIdToAttachment[i.id]=i,!0}catch(e){return r.defer((function(){return s.errorActions.relatedActivityParseError(n,e)})),!1}})),setTimeout((function(){return i.Dispatcher.dispatch({type:o.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE,resourceIdToFile:a})}))}},t.prototype.onReceiveCanOpenInfo=function(e){var t=this;c.iterateAndEmitChangesIfNeeded(this,e.canOpenInfo,(function(e,n){return t.mutateAttachmentInNsIdPath(n,{canOpen:e.is_locally_available})}))},t.prototype._onReceiveFileInRootCollectionInfo=function(e){var t=this;c.iterateAndEmitChangesIfNeeded(this,e.fileInRootCollectionInfo,(function(e,n){return t.mutateAttachmentInNsIdPath(n,{inRootCollection:e})}))},t})(a.FluxStore);t.AttachmentStore=_;var h=null;t.getAttachmentStore=function(){return null===h&&(h=new _(u.recentActivityDispatcher)),h}})),define("modules/clean/react/home/recents/stores/flux_utils",["require","exports","tslib"],(function(e,t,n){"use strict";function i(e,t){t&&e.__emitChange()}Object.defineProperty(t,"__esModule",{value:!0}),t.iterateAndEmitChangesIfNeeded=function(e,t,n){var o=!1;Object.keys(t).forEach((function(e){n(t[e],e)&&(o=!0)})),i(e,o)},t.emitChangeIfNeeded=i,t.getMutatedOrOriginal=function(e,t){for(var i in t)if(t[i]!==e[i])return n.__assign(n.__assign({},e),t);return e}})),define("modules/clean/react/home/recents/stores/recent_activity_store",["require","exports","tslib","external/lodash","modules/clean/react/home/recents/recent_activity_constants","modules/clean/react/home/recents/models/federated_recent_item","modules/clean/react/home/recents/recent_activity_dispatcher","modules/clean/react/home/recents/models/recent_item","modules/clean/react/home/recents/models/utils","modules/clean/react/home/recents/stores/flux_utils","modules/clean/react/home/recents/stores/attachment_store","modules/clean/react/home/store","modules/core/exception","modules/clean/react/home/recents/recent_activity_stream","modules/clean/react/home/post_tti/api","modules/clean/viewer","modules/clean/react/home/constants","modules/clean/react/home/util/logging/availability_logger","modules/clean/react/home/recents/store_utils","modules/clean/flux/flux_store"],(function(e,t,n,i,o,r,a,s,c,l,u,d,m,_,h,p,E,f,T,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var g=(function(e){function t(t,n){void 0===n&&(n=[]);var i=e.call(this,t)||this;i.handlePaperRecentsPrefetch=function(){return f.getHomeAvailabilityLogger().handlePrefetch(E.HomePrefetchTypes.RETRIEVE_PAPER_RECENTS,(function(e){return T.handleRetrievePaperRecentsPromise(h.waitForHomeTTI,e)}))},i.removeFileSyncItem=function(e){i.fileSyncRecentItemIdToRecentItem.hasOwnProperty(e.id)&&(delete i.fileSyncRecentItemIdToRecentItem[e.id],i.needsToRefreshFileSyncCache=!0)},i.addFileSyncItem=function(e){e!==i.fileSyncRecentItemIdToRecentItem[e.id]&&(i.fileSyncRecentItemIdToRecentItem[e.id]=e,i.needsToRefreshFileSyncCache=!0)},i.fileSyncRecentItemIdToRecentItem={},i.fileSyncCursor=null,i.fileSyncTransactionIdToRestoreData={},i.didReceiveRawRecentActivities=!!n.length,n.forEach(i.addFileSyncItem),i.fileSyncCache={items:n},i.needsToRefreshFileSyncCache=!1;var r=d.getHomeStore().getSectionLoadingPreference(E.ConditionalSections.PAPER_RECENTS)===E.ConditionalSectionLoadingPreference.POST_TTI;return i.paperStream=r?new _.RecentActivityStream([],!1):null,i.didRecievePaperItems=r,i.paperActivityKeyToPendingArchiving={},i.cachedFederatedRecentItems=[],i.cachedFederatedTruncatedRecentItems=[],i.federatedRecentItemsCountMax=o.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI,i.cachedProcessedRecentItems=null,h.waitForHomeTTI().then((function(){i.federatedRecentItemsCountMax=o.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI,i.didTruncateRecentItems()&&(i.cacheTruncatedFederatedRecentItems(),i.cachedProcessedRecentItems=null)})),u.getAttachmentStore(),f.getHomeAvailabilityLogger().handlePrefetch(E.HomePrefetchTypes.RECENTS_JSON,(function(e){return T.handleAndLogRecentsJsonPromise(h.waitForHomeTTI,e)})),r?h.waitForHomeTTI().then(i.handlePaperRecentsPrefetch):i.handlePaperRecentsPrefetch(),i}return n.__extends(t,e),t.prototype.getSortedFileSyncRecentItems=function(){return this.fileSyncCache.sortedItems||(this.fileSyncCache.sortedItems=this.fileSyncCache.items.slice().sort(c.compareRecentItems)),this.fileSyncCache.sortedItems},t.prototype.__onDispatch=function(e){this.fileSyncHandler(e)||this.paperHandler(e)},t.prototype.fileSyncHandler=function(e){switch(e.type){case o.DELETE_FILES_COMMIT:this.onDeleteCommit(e);break;case o.DELETE_FILES_PENDING:this.onDeleteFilesPending(e);break;case o.DELETE_FILES_ROLLBACK:this.onDeleteFilesRollback(e);break;case o.RECEIVE_RAW_RECENT_ACTIVITIES:this.onReceiveRawRecentActivities(e);break;case o.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY:this.onReceiveRawRelatedActivitiesByKey(e);break;case o.RAW_RELATED_ACTIVITY_PARSE_ERROR:this.onRawRelatedActivityParseError(e);break;case o.REFRESH_RECENT_ACTIVITIES:this.onRefreshRecentActivities();break;default:return!1}return this.updateFileSyncCache(!0),!0},t.prototype.paperHandler=function(e){switch(e.type){case o.RECEIVE_PAPER_RECENT_ITEMS:this.onReceivePaperRecentItems(e.items,e.hasMore,e.userId);break;case o.ARCHIVE_PAPER_DOCUMENT_PENDING:this.onArchivePaperDocumentPending(e.activityKey);break;case o.ARCHIVE_PAPER_DOCUMENT_COMMIT:this.onArchivePaperDocumentCommit(e.activityKey);break;case o.ARCHIVE_PAPER_DOCUMENT_ROLLBACK:this.onArchivePaperDocumentRollback(e.activityKey);break;default:return}this.__emitChange()},t.prototype.updateFileSyncCache=function(e){this.needsToRefreshFileSyncCache?(this.fileSyncCache={items:i.values(this.fileSyncRecentItemIdToRecentItem)},this.clearFederatedCache(),this.needsToRefreshFileSyncCache=!1,l.emitChangeIfNeeded(this,e)):l.emitChangeIfNeeded(this,!this.cachedProcessedRecentItems)},t.prototype.onDeleteCommit=function(e){delete this.fileSyncTransactionIdToRestoreData[e.transactionId]},t.prototype.onReceiveRawRecentActivities=function(e){var t=this;l.emitChangeIfNeeded(this,!this.didReceiveRawRecentActivities&&!e.rawRecentActivities.length),this.didReceiveRawRecentActivities=!0;var n=!this.fileSyncCache.items.length,r=[],a={};if(e.rawRecentActivities.forEach((function(c){if(c.viewing_user&&c.viewing_user.id===e.userId){var l=s.convertRecentActivityToRecentItem(c);if(l&&(l.uniqueFilterTypes.indexOf(o.RECENT_EVENT_FILTER_TYPE.JUNK)<0||l.uniqueFilterTypes.indexOf(o.RECENT_EVENT_FILTER_TYPE.ALL)>=0))if(r.push(c),n)t.fileSyncRecentItemIdToRecentItem[l.id]=l;else if(!a[l.id]){a[l.id]=l;var u=t.fileSyncCache.items.find((function(e){return e.id!==l.id&&e.contextDisplayName===l.contextDisplayName}));if(u)i.intersection(u.attachmentIds,l.attachmentIds).length>0&&(t.removeFileSyncItem(u),t.updateFileSyncCache(!1));var d=t.fileSyncRecentItemIdToRecentItem[l.id];t.updateFileSyncItem(l,{fqPath:d&&d.fqPath||void 0,paths:d&&d.paths||l.paths})}}})),h.waitForHomeTTI().then((function(e){return e.fetchStarredStatus(r)})),this.updateFileSyncCache(!1),!n){var c={};this.getSortedFileSyncRecentItems().forEach((function(e){if(e.attachmentIds.length>0){var n=Object.keys(c).length;e.attachmentIds.forEach((function(e){return c[e]=!0})),n===Object.keys(c).length&&t.removeFileSyncItem(e)}}))}this.fileSyncCursor=e.cursor,this.needsToRefreshFileSyncCache=!0},t.prototype.onReceiveRawRelatedActivitiesByKey=function(e){var t=this;this.waitForAttachmentStoreDispatcher();var n=Object.keys(e.rawRelatedActivitiesByKey||{});n.length&&this.clearFederatedCache(),this.getFileSyncRecentItemsByAttachmentIds(n).forEach((function(e){var n=e.id,i=t.fileSyncRecentItemIdToRecentItem[n];if(i){var o=i.attachmentIds;if(o&&o.length){var r=u.getAttachmentStore().getById(o[0]);if(r&&r.isLoaded){var a=r.fqPath||"";o.slice(1).forEach((function(e){var t=u.getAttachmentStore().getById(e);if(t.isLoaded){var n=t.fqPath||"";n.split("/").length<a.split("/").length&&(a=n)}}));var s=a.split("/"),l=s[s.length-2];t.updateFileSyncItem(i,{fqPath:a,paths:c.getPathsByFqPath(a,i.viewingUserId),contextDisplayName:l||i.contextDisplayName}),r.displayType||(r.displayType=i.displayType)}}}}))},t.prototype.onRawRelatedActivityParseError=function(e){this.getFileSyncRecentItemsByAttachmentIds(i.map(e.errors,"activityKey")).forEach(this.removeFileSyncItem)},t.prototype.onDeleteFilesPending=function(e){this.waitForAttachmentStoreDispatcher();var t=this.deleteAttachments(e.attachmentIds);t&&(this.fileSyncTransactionIdToRestoreData[e.transactionId]=t)},t.prototype.onDeleteFilesRollback=function(e){this.waitForAttachmentStoreDispatcher();var t=this.fileSyncTransactionIdToRestoreData[e.transactionId];m.assert(!!t,"Unable to find data for transaction with id: "+e.transactionId),delete this.fileSyncTransactionIdToRestoreData[e.transactionId],this.rollbackDelete(t)},t.prototype.onRefreshRecentActivities=function(){this.getUnprocessedRecentItems(),this.didReceiveRawRecentActivities=!1,this.didRecievePaperItems=!1},t.prototype.deleteAttachments=function(e){var t=null;if(e.length){var n=this.getFileSyncRecentItemsByAttachmentIds([e[0]])[0];if(n){var o=i.difference(n.attachmentIds,e);this.updateFileSyncItem(n,{attachmentIds:o}),t={deletedAttachmentIds:e,item:n},0===o.length&&this.removeFileSyncItem(n)}}return t},t.prototype.rollbackDelete=function(e){var t,n=this.fileSyncRecentItemIdToRecentItem[e.item.id];n?t=n.attachmentIds:(n=e.item,t=[]),this.updateFileSyncItem(n,{attachmentIds:i.uniq(t.concat.apply(t,e.deletedAttachmentIds))})},t.prototype.getCachedAttachmentIdToIdToFileSyncItem=function(){var e=this;return this.fileSyncCache.attachmentIdToIdToItem||(this.fileSyncCache.attachmentIdToIdToItem={},this.fileSyncCache.items.forEach((function(t){return t.attachmentIds.forEach((function(n){var i;e.fileSyncCache.attachmentIdToIdToItem[n]?e.fileSyncCache.attachmentIdToIdToItem[n][t.id]=t:e.fileSyncCache.attachmentIdToIdToItem[n]=((i={})[t.id]=t,i)}))}))),this.fileSyncCache.attachmentIdToIdToItem},t.prototype.getFileSyncRecentItemsByAttachmentIds=function(e){var t=this.getCachedAttachmentIdToIdToFileSyncItem(),n={};return e.forEach((function(e){t.hasOwnProperty(e)&&i.values(t[e]).forEach((function(e){return n[e.id]=e}))})),i.values(n)},t.prototype.waitForAttachmentStoreDispatcher=function(){this.getDispatcher().waitFor([u.getAttachmentStore().getDispatchToken()])},t.prototype.updateFileSyncItem=function(e,t){this.addFileSyncItem(l.getMutatedOrOriginal(e,t))},t.prototype.onArchivePaperDocumentPending=function(e){this.paperActivityKeyToPendingArchiving[e]=!0},t.prototype.onArchivePaperDocumentCommit=function(e){this.deletePendingArchive(e),this.paperStream=this.paperStream.getStreamWithoutActivityKey(e),this.clearFederatedCache()},t.prototype.onArchivePaperDocumentRollback=function(e){this.deletePendingArchive(e)},t.prototype.deletePendingArchive=function(e){this.paperActivityKeyToPendingArchiving[e]&&delete this.paperActivityKeyToPendingArchiving[e]},t.prototype.onReceivePaperRecentItems=function(e,t,n){this.didRecievePaperItems=!0;var i=p.Viewer.get_viewer().get_user_by_id(n),o=e.map((function(e,t){return r.createRecentItemFromPaperRecentItem(e,i,t)}));this.paperStream=new _.RecentActivityStream(o,t),h.waitForHomeTTI().then((function(t){return t.setStarredStatusOfPaperRecentItems(e)})),this.clearFederatedCache()},t.prototype.clearFederatedCache=function(){this.cachedFederatedRecentItems&&this.didReceiveItemsFromAllStreams()&&(this.__emitChange(),this.cachedFederatedRecentItems=null,this.cachedFederatedTruncatedRecentItems=null,this.cachedProcessedRecentItems=null)},t.prototype.cacheTruncatedFederatedRecentItems=function(){this.cachedFederatedRecentItems?this.cachedFederatedTruncatedRecentItems=this.cachedFederatedRecentItems.slice(0,this.federatedRecentItemsCountMax):this.getUnprocessedRecentItems()},t.prototype.getUnprocessedRecentItems=function(){if(null===this.cachedFederatedRecentItems){var e=[this.paperStream,new _.RecentActivityStream(this.getSortedFileSyncRecentItems(),!!this.fileSyncCursor)];this.cachedFederatedRecentItems=_.getMergedRecentItems(e),this.cacheTruncatedFederatedRecentItems()}return this.cachedFederatedTruncatedRecentItems},t.prototype.getFileSyncCursor=function(){return this.fileSyncCursor},t.prototype.canArchiveActivityKey=function(e){if(this.paperStream&&!this.paperActivityKeyToPendingArchiving[e]){var t=this.paperStream.getRecentItemByActivityKey(e);return!(!t||!t.federatedRecentItem.isArchiveable())}return!1},t.prototype.didReceiveItemsFromAllStreams=function(){return this.didRecievePaperItems&&this.didReceiveRawRecentActivities},t.prototype.getRecentItems=function(){return null===this.cachedProcessedRecentItems&&(this.cachedProcessedRecentItems=this.getUnprocessedRecentItems()),{items:this.cachedProcessedRecentItems}},t.prototype.didTruncateRecentItems=function(){return!!(this.cachedFederatedRecentItems&&this.cachedFederatedTruncatedRecentItems&&this.cachedFederatedTruncatedRecentItems.length<this.cachedFederatedRecentItems.length)},t})(I.FluxStore);t.RecentActivityStore=g;var y=null;t.getRecentActivityStore=function(){return null===y&&(y=new g(a.recentActivityDispatcher)),y}})),define("modules/clean/react/home/resource_id_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.ENCODED_FILE_OBJ_ID="ENCODED_FILE_OBJ_ID",e.FQ_PATH="FQ_PATH",e.PAPER_DOCUMENT_ID="PAPER_DOCUMENT_ID",e.PAPER_FOLDER_ID="PAPER_FOLDER_ID",e.PAPER_DOCUMENT_ID_PATH="PAPER_DOCUMENT_ID_PATH",e.PAPER_FOLDER_ID_PATH="PAPER_FOLDER_ID_PATH",e.EXTERNAL_RESOURCE_ID="EXTERNAL_RESOURCE_ID",e.UNKNOWN="UNKNOWN"})(t.HOME_RESOURCE_ID_TYPE||(t.HOME_RESOURCE_ID_TYPE={}))})),define("modules/clean/react/home/store",["require","exports","tslib","modules/clean/flux/dispatcher","external/lodash","modules/clean/flux/flux_store","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/home/constants","modules/clean/viewer","modules/core/exception","modules/clean/react/home/util/logging/availability_logger_common"],(function(e,t,n,i,o,r,a,s,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o);var d=(function(e){function t(){var t=e.call(this,i.Dispatcher)||this;return t.handledPrefetches=[],t.activeTabId=s.HomeTabId.STARRED,t.canRenderItems=function(){return!!t.pendingPreTTIPrefetches&&!t.pendingPreTTIPrefetches.length},t.thumbStore=new a.GenericThumbStore,t.sectionToDidLoadSynchronously={},t.sectionToPendingCallbacks={},t.preTTIProps=s.DEFAULT_PRE_TTI_PROPS,t}return n.__extends(t,e),t.prototype.getRole=function(){return this.role},t.prototype.getUser=function(){return this.user},t.prototype.getThumbStore=function(){return this.thumbStore},t.prototype.getSectionVisibility=function(){return this.sectionVisibility},t.prototype.getPreTTIProps=function(){return this.preTTIProps},t.prototype.getActiveTabId=function(){return this.activeTabId},t.prototype.getActiveVariants=function(){return this.preTTIProps.activeVariants},t.prototype.getActiveVariant=function(e){return this.getActiveVariants()[e]},t.prototype.executeWhenSectionIsReady=function(e,t,n){var i=this.getSectionLoadingPreference(e);return i===s.ConditionalSectionLoadingPreference.DO_NOT_LOAD?null:i===s.ConditionalSectionLoadingPreference.IMMEDIATE||this.getSectionLoadingMode(e)!==s.ConditionalSectionLoadingMode.UNKNOWN?n(!0):(t&&(this.sectionToPendingCallbacks[e]?this.sectionToPendingCallbacks[e].push(n):this.sectionToPendingCallbacks[e]=[n]),null)},t.prototype.getSectionLoadingPreference=function(e){if(this.sectionToExtendedConditionalData){var t=this.sectionToExtendedConditionalData[e];return t?t.isPostTTI?s.ConditionalSectionLoadingPreference.POST_TTI:s.ConditionalSectionLoadingPreference.IMMEDIATE:s.ConditionalSectionLoadingPreference.DO_NOT_LOAD}return s.ConditionalSectionLoadingPreference.UNKNOWN},t.prototype.getSectionLoadingMode=function(e){return this.sectionToExtendedConditionalData&&this.sectionToExtendedConditionalData[e]?this.sectionToExtendedConditionalData[e].loadingMode:s.ConditionalSectionLoadingMode.UNKNOWN},t.prototype.getIsFileViewerOpen=function(){return this.isFileViewerOpen},t.prototype.canRenderAllHomeSections=function(){return this.sectionToExtendedConditionalData?o.values(this.sectionToExtendedConditionalData).every((function(e){return!e.isBlocking||(!!e.isPostTTI||e.loadingMode!==s.ConditionalSectionLoadingMode.UNKNOWN)})):(this.role||l.reportStack("Called canRenderAllHomeSections before initialization",{severity:l.SEVERITY.NONCRITICAL}),!0)},t.prototype.setSectionVisibility=function(e){var t,i=e.section,o=e.visible;this.sectionVisibility[i]!==o&&(this.sectionVisibility=n.__assign(n.__assign({},this.sectionVisibility),((t={})[i]=o,t)))},t.prototype.setSectionLoadingMode=function(e,t){var i=this.getExtendedConditionalData(e);i&&(this.sectionToExtendedConditionalData[e]=n.__assign(n.__assign({},i),{loadingMode:t}))},t.prototype.getExtendedConditionalData=function(e){return this.sectionToExtendedConditionalData&&this.sectionToExtendedConditionalData[e]},t.prototype.onPrefetchReceivedData=function(e){var t=e.homePrefetchType;this.handledPrefetches.push(t),this.pendingPreTTIPrefetches&&(this.pendingPreTTIPrefetches=o.without(this.pendingPreTTIPrefetches,t),this.pendingPreTTIPrefetches.length||this.__emitChange())},t.prototype.onInitializeStore=function(e){var t=this,i=e.role,r=e.sectionVisibility,a=e.preTTIProps,d=e.sectionToConditionalData;this.role=i,this.sectionVisibility=r,this.user=c.Viewer.get_viewer().get_user_by_role(i),l.assert(!!this.user,"Could not find user for role "+i),this.preTTIProps=a||this.preTTIProps,this.pendingPreTTIPrefetches=o.without.apply(o,n.__spreadArrays([[s.HomePrefetchTypes.RECENTS_JSON].concat(o.compact(o.map(u.HOME_PREFETCH_TYPE_TO_INFO,(function(e,t){var n=e.section;if(d){var i=d[n];if(i&&!i.isPostTTI)return t}return null}))))],this.handledPrefetches)),this.sectionToExtendedConditionalData=o.mapValues(d,(function(e,t){return n.__assign(n.__assign({},e),{loadingMode:s.ConditionalSectionLoadingMode.UNKNOWN,isBlocking:f(t)})})),Object.keys(this.sectionToDidLoadSynchronously).forEach((function(e){(0,t.sectionToDidLoadSynchronously[e])(t.getSectionLoadingPreference(e))&&t.setSectionLoadingMode(e,s.ConditionalSectionLoadingMode.SYNCHRONOUS)})),this.sectionToDidLoadSynchronously={}},t.prototype.onDeclareConditionalSection=function(e){var t=e.section,n=e.didInitializeSynchronously;this.sectionToExtendedConditionalData?l.reportStack("declared conditional section too late",{severity:l.SEVERITY.CRITICAL,exc_extra:{section:t}}):this.sectionToDidLoadSynchronously[t]?l.reportStack("Re-declared a conditional section",{severity:l.SEVERITY.CRITICAL,exc_extra:{section:t}}):this.sectionToDidLoadSynchronously[t]=n},t.prototype.onLoadedAsyncConditionalSection=function(e){var t=e.section,n=this.getExtendedConditionalData(t);n&&this.setSectionLoadingMode(t,n.isPostTTI?s.ConditionalSectionLoadingMode.POST_TTI:s.ConditionalSectionLoadingMode.ASYNCHRONOUS_PRE_TTI),(this.sectionToPendingCallbacks[t]||[]).forEach((function(e){return e(!1)})),this.sectionToPendingCallbacks[t]=[]},t.prototype.onSetTabId=function(e){var t=e.activeTabId;this.activeTabId=t},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case s.HomeActionTypes.INITIALIZE_STORE:this.onInitializeStore(t.payload),this.__emitChange();break;case s.HomeActionTypes.SET_TAB_ID:this.onSetTabId(t.payload),this.__emitChange();break;case s.HomeActionTypes.HOME_PREFETCH_RECEIVED_DATA:this.onPrefetchReceivedData(t.payload);break;case s.HomeActionTypes.SET_SECTION_VISIBILITY:this.setSectionVisibility(t.payload),this.__emitChange();break;case s.HomeActionTypes.DECLARE_CONDITIONAL_SECTION:this.onDeclareConditionalSection(t.payload),this.__emitChange();break;case s.HomeActionTypes.LOADED_ASYNC_CONDITIONAL_SECTION:this.onLoadedAsyncConditionalSection(t.payload),this.__emitChange();break;case s.HomeActionTypes.OPEN_FILE_VIEWER:this.isFileViewerOpen=!0,this.__emitChange();break;case s.HomeActionTypes.CLOSE_FILE_VIEWER:this.isFileViewerOpen=!1,this.__emitChange()}},t})(r.FluxStore);t.PrivateHomeStoreClass=d;var m=null;function _(){return null===m&&(m=new d),m}function h(){return _().getUser()}t.getHomeStore=_,t.getUser=h,t.getUserId=function(){return h().id},t.getRole=function(){return h().role};var p=(function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t})(s.HomeSections);function E(e){return!!p[e]}function f(e){return E(e)}t.isHomeSection=E,t.isBlockingSection=f})),define("modules/clean/react/home/section_header",["require","exports","tslib","react","modules/clean/user_education/react/user_education_effect","spectrum/button"],(function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),t.SectionHeaderTitle=function(e){var t=e.title,n=e.ueName;return i.default.createElement(o.UserEducationEffect,{containerName:"home-section-header",name:n},t)},t.SectionShowHideButton=function(e){var t=e.buttonText,n=e.buttonAction;return n&&t?i.default.createElement(r.Button,{variant:"styleless",className:"button-as-link show-hide-section-button",onClick:n},t):null},t.SectionHeader=function(e){var n=e.title,o=e.ueName,r=e.buttonText,a=e.buttonAction,s=e.infoIcon;return i.default.createElement("h2",{className:"home-access-section__header"},i.default.createElement("div",{className:"home-access-section__title"},i.default.createElement("div",{className:"home-access-section__title-text"},i.default.createElement(t.SectionHeaderTitle,{title:n,ueName:o})),s?i.default.createElement("span",{className:"info-icon"},s):null),i.default.createElement("div",{className:"home-section-header__button"},i.default.createElement(t.SectionShowHideButton,{buttonAction:a,buttonText:r})))}})),define("modules/clean/react/home/constants",["require","exports"],(function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.DO_NOT_LOAD=1]="DO_NOT_LOAD",e[e.IMMEDIATE=2]="IMMEDIATE",e[e.POST_TTI=3]="POST_TTI"})(t.ConditionalSectionLoadingPreference||(t.ConditionalSectionLoadingPreference={})),(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SYNCHRONOUS=1]="SYNCHRONOUS",e[e.ASYNCHRONOUS_PRE_TTI=2]="ASYNCHRONOUS_PRE_TTI",e[e.POST_TTI=3]="POST_TTI"})(t.ConditionalSectionLoadingMode||(t.ConditionalSectionLoadingMode={})),t.HomeActionTypes={INITIALIZE_STORE:"HOME_INITIALIZE_STORE",SET_PRE_TTI_PROPS:"HOME_SET_PRE_TTI_PROPS",SET_SECTION_VISIBILITY:"HOME_SET_SECTION_VISIBILITY",LOADED_ASYNC_CONDITIONAL_SECTION:"HOME_STORE_LOADED_ASYNC_CONDITIONAL_SECTION",DECLARE_CONDITIONAL_SECTION:"HOME_STORE_DECLARE_CONDITIONAL_SECTION",HOME_PREFETCH_RECEIVED_DATA:"HOME_PREFETCH_RECEIVED_DATA",SET_TAB_ID:"HOME_SET_TAB_ID",OPEN_FILE_VIEWER:"HOME_OPEN_FILE_VIEWER",CLOSE_FILE_VIEWER:"HOME_CLOSE_FILE_VIEWER"},(function(e){e.STARRED="Starred",e.TASKS="To-do"})(t.HomeTabId||(t.HomeTabId={})),t.HomeResourceStoreActionTypes={RECEIVED_RESOURCE_ID_TO_FILE:"HOME_RESOURCE_STORE_RECEIVED_RESOURCE_ID_TO_FILE",REQUEST_PREVIEW:"HOME_RESOURCE_STORE_REQUEST_PREVIEW"},t.HomeSections={UNREAD:"unread",STARRED:"starred",RECENTS:"recents",SUGGEST:"suggest"},t.DEFAULT_PRE_TTI_PROPS={isPaperEnabledForUser:!1,uploaderExperiments:{},activeVariants:{},expSearchSuccessBanner:!1,expConsolidateCreateVariant:"OFF",expHideUnread:!1,expHomeSuggestionsNewTile:!1},t.ConditionalSections={PAPER_RECENTS:"paper_recents"},t.LoggingTypes={CLICK_SHOW_ALL:"click_show_all",HOME_PAGE_SHOWN:"home_page_shown",UNREAD_SHOWN:"unread_shown",STARRED_SHOWN:"starred_shown",RECENTS_SHOWN:"recents_shown",HIDE_SECTION:"hide_section",UNHIDE_SECTION:"unhide_section",RECENTS_ITEM_ACTION:"recents_item_action",OPEN_FILTERS_MENU:"open_filters_menu",CLOSE_FILTERS_MENU:"close_filters_menu",RESET_FILTERS_MENU:"reset_filters_menu",SELECT_FILTERS_MENU_ITEM:"select_filters_menu_item",DESELECT_FILTERS_MENU_ITEM:"deselect_filters_menu_item",OPEN_UNREAD_ITEM:"open_unread_document",MARK_AS_READ:"mark_as_read",OPEN_STARRED_ITEM:"open_starred_item",UNDO_UNSTAR_ITEM:"undo_unstar_item",CLICK_STAR_OVERFLOW_MENU:"click_star_overflow_menu",CLICK_STAR_OVERFLOW_SHARE:"click_star_overflow_share",SELECT_TASKS_TAB:"select_tasks_tab",SELECT_TASKS_FILTER:"select_tasks_filter",OPEN_DOC_FROM_TASK:"open_doc_from_tasks",CLICK_DOC_TASKS_OVERFLOW_MENU:"click_doc_tasks_overflow_menu",CLICK_DOC_TASKS_OVERFLOW_SHARE:"click_doc_tasks_overflow_share",CLICK_CREATE_NEW_FILE:"create_new_file",CLICK_UPLOAD_FILES:"upload_files",CLICK_UPLOAD_FOLDER:"upload_folder",CLICK_CREATE_PAPER_DOC:"create_paper_doc",CLICK_NEW_SHARED_FOLDER:"new_shared_folder",CLICK_NEW_FOLDER:"create_folder"},t.HomePrefetchTypes={RETRIEVE_STARRED:"retrieve_starred",RECENTS_JSON:"recents_json",RETRIEVE_PAPER_RECENTS:"retrieve_paper_recents",RETRIEVE_UNREAD:"retrieve_unread",GET_SUGGESTED:"get_suggested"},t.LoadingStates={LOADING:"LOADING",SUCCESS:"SUCCESS",FAILURE:"FAILURE"},t.FILE_RESOURCE_TYPE="FILE",t.FOLDER_RESOURCE_TYPE="FOLDER",t.PAPER_DOCUMENT_RESOURCE_TYPE="PAPER_DOCUMENT",t.PAPER_FOLDER_RESOURCE_TYPE="PAPER_FOLDER",t.EXTERNAL_RESOURCE_TYPE="EXTERNAL",t.DisplayTypeToResourceType={DOC:t.FILE_RESOURCE_TYPE,MSDOC:t.FILE_RESOURCE_TYPE,PDF:t.FILE_RESOURCE_TYPE,SPREADSHEET:t.FILE_RESOURCE_TYPE,FILE:t.FILE_RESOURCE_TYPE,FOLDER:t.FOLDER_RESOURCE_TYPE,SHARED_FOLDER:t.FOLDER_RESOURCE_TYPE,TEAM_FOLDER:t.FOLDER_RESOURCE_TYPE,SHARED_FOLDER_READ_ONLY:t.FOLDER_RESOURCE_TYPE,CDM_TEAM_MEMBER_FOLDER:t.FOLDER_RESOURCE_TYPE,TEAM_READ_ONLY:t.FOLDER_RESOURCE_TYPE,PAPER_DOCUMENT:t.PAPER_DOCUMENT_RESOURCE_TYPE,PAPER_FOLDER:t.PAPER_FOLDER_RESOURCE_TYPE,PAPER_PUBLIC_FOLDER:t.PAPER_FOLDER_RESOURCE_TYPE,PAPER_PROJECT:t.PAPER_FOLDER_RESOURCE_TYPE,EXTERNAL:t.EXTERNAL_RESOURCE_TYPE},t.ExceptionTags={UNREAD:"home_unread"},(function(e){e.AGGREGATION="AGGREGATION",e.DOC="DOC",e.MSDOC="DOC",e.MSDOC_DEPRECATED="MSDOC",e.PDF="PDF",e.SPREADSHEET="SPREADSHEET",e.FILE="FILE",e.FOLDER="FOLDER",e.SHARED_FOLDER="SHARED_FOLDER",e.TEAM_FOLDER="TEAM_FOLDER",e.PAPER_DOCUMENT="PAPER_DOCUMENT",e.PAPER_FOLDER="PAPER_FOLDER",e.PAPER_PUBLIC_FOLDER="PAPER_PUBLIC_FOLDER",e.PAPER_PROJECT="PAPER_PROJECT",e.EXTERNAL="EXTERNAL",e.CDM_TEAM_MEMBER_FOLDER="CDM_TEAM_MEMBER_FOLDER",e.TEAM_READ_ONLY="TEAM_READ_ONLY",e.SHARED_FOLDER_READ_ONLY="SHARED_FOLDER_READ_ONLY",e.RESTRICTED_FOLDER="RESTRICTED_FOLDER",e.CAMERA_UPLOADS="CAMERA_UPLOADS"})(n=t.DisplayTypes||(t.DisplayTypes={})),t.PreviewableDisplayTypes=[n.DOC,n.MSDOC_DEPRECATED,n.PDF,n.SPREADSHEET,n.FILE],t.DisplayTypeToIconName={AGGREGATION:"image-small",FOLDER:"folder-small",SHARED_FOLDER:"folder_shared-small",TEAM_FOLDER:"folder_team-small",CDM_TEAM_MEMBER_FOLDER:"folder_team_member-small",PAPER_DOCUMENT:"paper-small",PAPER_FOLDER:"folder-small",PAPER_PUBLIC_FOLDER:"folder_team-small",PAPER_PROJECT:"folder_project-small",TEAM_READ_ONLY:"folder_team_read_only-small",SHARED_FOLDER_READ_ONLY:"folder_shared_read_only-small",RESTRICTED_FOLDER:"folder_confidential-small",CAMERA_UPLOADS:"folder_camera_upload-small"},(function(e){e.FILE="file",e.PAPER_DOCUMENT="paper_document"})(t.SuggestItemTypes||(t.SuggestItemTypes={})),t.SUGGEST_GRID_FEATURE="home_suggest_grid",t.SUGGEST_GRID_MAX_TILE_WIDTH=200,t.SUGGEST_GRID_MIN_TILE_WIDTH=150,t.SUGGEST_GRID_TILE_PADDING=16,t.SUGGEST_GRID_LABEL_HEIGHT=72,t.SUGGEST_GRID_V2_MAX_TILE_WIDTH=180,t.SUGGEST_GRID_V2_MIN_TILE_WIDTH=134,t.SUGGEST_GRID_V2_TILE_PADDING=8})),define("modules/clean/react/home/util/logging/activity_logger",["require","exports","modules/clean/react/home/api","modules/clean/react/home/store","modules/clean/react/home/constants"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}return e.prototype.logClickShowAll=function(e,t){return n.logHomeActivity({eventName:o.LoggingTypes.CLICK_SHOW_ALL,role:i.getHomeStore().getRole(),extra:{component_name:e,should_show_all:t}})},e.prototype.logHomePageShown=function(){return n.logHomeActivity({eventName:o.LoggingTypes.HOME_PAGE_SHOWN,role:i.getHomeStore().getRole(),extra:{}})},e.prototype.logStarredShown=function(e,t,r){return n.logHomeActivity({eventName:o.LoggingTypes.STARRED_SHOWN,role:i.getHomeStore().getRole(),extra:{num_items:e,is_hidden:!1,has_hidden_rows:t,has_more:r}})},e.prototype.logRecentsShown=function(e,t){return n.logHomeActivity({eventName:o.LoggingTypes.RECENTS_SHOWN,role:i.getHomeStore().getRole(),extra:{num_items:e,is_hidden:t}})},e.prototype.logShowHideSection=function(e,t){return n.logHomeActivity({eventName:t?o.LoggingTypes.HIDE_SECTION:o.LoggingTypes.UNHIDE_SECTION,role:i.getHomeStore().getRole(),extra:{section_name:e}})},e.prototype.logRecentsAction=function(e,t,r,a,s,c,l,u,d){var m={action_taken:e,scope:t,display_type:s,is_dir:c,item_number:r,sprite:a,subgroup_position:l};return u&&d&&(m.id_type=u,m.resource_id=d),n.logHomeActivity({eventName:o.LoggingTypes.RECENTS_ITEM_ACTION,role:i.getHomeStore().getRole(),extra:m})},e.prototype.logOpenStarredItem=function(e,t,r){return n.logHomeActivity({eventName:o.LoggingTypes.OPEN_STARRED_ITEM,role:i.getHomeStore().getRole(),extra:{resource_id:e,resource_type:t,position:r}})},e.prototype.logUndoUnstarItem=function(e,t,r){return n.logHomeActivity({eventName:o.LoggingTypes.UNDO_UNSTAR_ITEM,role:i.getHomeStore().getRole(),extra:{resource_id:e,resource_type:t,position:r}})},e.prototype.logClickStarOverflowMenu=function(e,t,r){return n.logHomeActivity({eventName:o.LoggingTypes.CLICK_STAR_OVERFLOW_MENU,role:i.getHomeStore().getRole(),extra:{resource_id:e,resource_type:t,position:r}})},e.prototype.logClickStarOverflowShare=function(e,t,r){return n.logHomeActivity({eventName:o.LoggingTypes.CLICK_STAR_OVERFLOW_SHARE,role:i.getHomeStore().getRole(),extra:{resource_id:e,resource_type:t,position:r}})},e.prototype.logClickRightMenu=function(e,t){var o=t?{modalSessionId:t}:{};return n.logHomeActivity({eventName:e,role:i.getHomeStore().getRole(),extra:o})},e.prototype.logCreateNewFile=function(e){return n.logHomeActivity({eventName:e,role:i.getHomeStore().getRole()})},e})();t.HomeActivityLogger=r,t.homeActivityLogger=new r})),define("modules/clean/react/home/util/logging/availability_logger",["require","exports","tslib","external/lodash","modules/clean/flux/dispatcher","modules/clean/react/home/constants","modules/clean/web_timing_logger","modules/clean/react/home/store","modules/core/exception","modules/clean/react/home/util/prefetch_handler","modules/clean/react/home/util/logging/availability_logger_common","modules/clean/react/home/post_tti/api"],(function(e,t,n,i,o,r,a,s,c,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i);var m=(function(){function e(){this.didLog=!1,this.sectionToTTData={},this.sectionToTTI={},this.sectionToIsSkipped={},this.typeToExecutionData=i.mapValues(u.HOME_PREFETCH_TYPE_TO_INFO,(function(e){return{info:e,homeTiming:{}}}))}return e.prototype.logPrefetch=function(e,t){var n=this.typeToExecutionData[e];if(void 0===n.success){var i={type:r.HomeActionTypes.HOME_PREFETCH_RECEIVED_DATA,payload:{homePrefetchType:e}};n.homeTiming.asynchronous?o.Dispatcher.dispatch(i):s.getHomeStore().__onDispatch({action:i}),n.success=t,this.pendingPrefetchesCount&&this.pendingPrefetchesCount--,this.logIfPossible()}},e.prototype.logIfPossible=function(){var e=this;!this.didLog&&void 0!==this.pendingPrefetchesCount&&this.pendingPrefetchesCount<=0&&(d.waitForHomeTTI().then((function(t){return(0,t.logHomeAvailability)({typeToExecutionData:e.typeToExecutionData,sectionToTTData:e.sectionToTTData,sectionToTTI:e.sectionToTTI,sectionToIsSkipped:e.sectionToIsSkipped})})),this.didLog=!0)},e.prototype.logTTData=function(e){this.sectionToTTData.hasOwnProperty(e)||(this.sectionToTTData[e]=a.time_since_start(),this.logIfPossible())},e.prototype.logTTI=function(e,t,n){var o=this;if(!this.sectionToTTI.hasOwnProperty(e)&&(this.sectionToTTI[e]=a.time_since_start(),this.sectionToIsSkipped[e]=Number(t),n)){this.pendingPrefetchesCount=0;var r=s.getHomeStore();i.map(this.typeToExecutionData,(function(e){u.isPendingPrefetch(r,e)&&o.pendingPrefetchesCount++})),this.logIfPossible()}},e.prototype.handlePrefetch=function(e,t){var n=this,i=u.HOME_PREFETCH_TYPE_TO_INFO[e],o=i.handle,a=i.conditionalSection,c=function(){return n.handlePrefetchImpl(e,o,t)};s.getHomeStore().getSectionLoadingPreference(a)===r.ConditionalSectionLoadingPreference.POST_TTI?d.waitForHomeTTI().then(c):c()},e.prototype.handlePrefetchImpl=function(e,t,n){var o=this,r=l.getPrefetchHandler(t),s=this.typeToExecutionData[e],u=s.homeTiming,d=s.didInvoke,m=function(t){c.reportStack("prefetch for "+e+" failed",{severity:c.SEVERITY.CRITICAL,exc_extra:{error:t,type:e}}),o.logPrefetch(e,!1)};if(r){if(!d){s.didInvoke=!0,u.register_prefetch_callback=a.time_since_start();u.asynchronous=l.handlePrefetch(r,(function(t){try{u.json_parse_start=a.time_since_start();var r=JSON.parse(t);u.json_parse_end=a.time_since_start(),u.json_string_size=16*t.length,i.isEqual(r,{})?m("payload is {}"):(o.logPrefetch(e,!0),u.payload_processing_start=a.time_since_start(),n(r),u.payload_processing_end=a.time_since_start())}catch(e){m(e)}}),m)?0:1}}else m("no prefetch handler")},e})();t.HomeAvailabilityLogger=m;var _=null;t.getHomeAvailabilityLogger=function(){return _=_||new m}})),define("modules/clean/react/home/util/logging/availability_logger_common",["require","exports","modules/clean/react/home/constants"],(function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0});var o=[n.ConditionalSectionLoadingPreference.IMMEDIATE,n.ConditionalSectionLoadingPreference.POST_TTI];t.HOME_PREFETCH_TYPE_TO_INFO=((i={})[n.HomePrefetchTypes.RETRIEVE_STARRED]={fragment:"retrieve_starred",handle:"__REGISTER_RETRIEVE_STARRED_PRELOAD_HANDLER",section:n.HomeSections.STARRED,conditionalSection:n.HomeSections.STARRED},i[n.HomePrefetchTypes.RECENTS_JSON]={fragment:"recents/json",handle:"__REGISTER_RECENTS_PRELOAD_HANDLER",section:n.HomeSections.RECENTS,conditionalSection:n.HomeSections.RECENTS},i[n.HomePrefetchTypes.RETRIEVE_PAPER_RECENTS]={fragment:"retrieve_paper_recents",handle:"__REGISTER_PAPER_RECENTS_PRELOAD_HANDLER",section:n.HomeSections.RECENTS,conditionalSection:n.ConditionalSections.PAPER_RECENTS},i[n.HomePrefetchTypes.RETRIEVE_UNREAD]={fragment:"retrieve_unread",handle:"__REGISTER_UNREAD_PREFETCH_HANDLER",section:n.HomeSections.UNREAD,conditionalSection:n.HomeSections.UNREAD},i[n.HomePrefetchTypes.GET_SUGGESTED]={fragment:"get_suggested",handle:"__REGISTER_SUGGEST_GRID_PRELOAD_HANDLER",section:n.HomeSections.SUGGEST,conditionalSection:n.HomeSections.SUGGEST,isOptional:!0},i),t.isPendingPrefetch=function(e,t){var n=t.success,i=t.info;return void 0===n&&(!i.isOptional||o.indexOf(e.getSectionLoadingPreference(i.conditionalSection))>=0)},t.withHomePrefix=function(e){return"home_"+e}})),define("modules/clean/react/home/util/logging/timing_component",["require","exports","tslib","react","modules/clean/react/home/util/logging/timing_logger"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),t.timingComponent=function(e,t){return(function(r){function a(){return null!==r&&r.apply(this,arguments)||this}return n.__extends(a,r),a.prototype.logTTIIfCanRenderItems=function(){return this.props.canRenderItems&&o.homeTimingLogger.logTTI(t)},a.prototype.componentDidMount=function(){var e=this;this.logTTIIfCanRenderItems();var t=this.refs.wrapped,n=t.componentDidUpdate;t.componentDidUpdate=function(){e.logTTIIfCanRenderItems(),n&&n.call(t)}},a.prototype.render=function(){return i.default.createElement(e,n.__assign({ref:"wrapped"},this.props))},a})(i.default.PureComponent)}})),define("modules/clean/react/home/util/logging/timing_logger",["require","exports","tslib","modules/clean/js_client_stopwatch","external/lodash","modules/clean/web_timing_logger","modules/clean/react/home/util/logging/timing_state","modules/clean/react/home/util/logging/activity_logger","modules/core/exception","modules/clean/react/home/util/logging/availability_logger","modules/clean/react/home/util/logging/availability_logger_common"],(function(e,t,n,i,o,r,a,s,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o),r=n.__importStar(r);var d=o.once(s.homeActivityLogger.logHomePageShown),m=(function(){function e(){this.timingStates=new a.HomeTimingStates,this.activate=o.once((function(){return i.JSStopwatch.create_stopwatch_if_not_exist("home_access_tti")}))}return e.prototype.validateActivated=function(e,t){return!!i.JSStopwatch.stopwatch_exists("home_access_tti")||(c.reportStack("Did not activate when "+e+" before logging "+t,{severity:c.SEVERITY.NONCRITICAL}),!1)},e.prototype.logTTData=function(e){if(this.validateActivated(e,a.HomeTimingState.TTDATA)&&this.timingStates.progressState(e,a.HomeTimingState.TTDATA))return this.timingStates.haveAllSectionsReachedState(a.HomeTimingState.TTDATA)&&r.log_js_modules_fetched_data_required_for_tti(),l.getHomeAvailabilityLogger().logTTData(e),!0;return!1},e.prototype.logSkippedSection=function(e){this.activate(),this.logTTData(e),this.logTTI(e,!0)},e.prototype.logTTI=function(e,t){if((void 0===t&&(t=!1),this.validateActivated(e,a.HomeTimingState.TTI))&&this.timingStates.progressState(e,a.HomeTimingState.TTI)){d(),i.JSStopwatch.recordTrace(u.withHomePrefix(e),{stopwatchName:"home_access_tti"});var n=this.timingStates.haveAllSectionsReachedState(a.HomeTimingState.TTI);return n&&(r.mark_time_to_interactive(),i.JSStopwatch.flush_current_data()),l.getHomeAvailabilityLogger().logTTI(e,t,n),!0}return!1},e})();t._HomeTimingLogger=m,t.homeTimingLogger=new m})),define("modules/clean/react/home/util/logging/timing_state",["require","exports","tslib","external/lodash","modules/clean/react/home/constants"],(function(e,t,n,i,o){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),(function(e){e[e.INIT=0]="INIT",e[e.TTDATA=1]="TTDATA",e[e.TTI=2]="TTI"})(r=t.HomeTimingState||(t.HomeTimingState={}));var a=(function(){function e(){var e=this;this.homeSectionToState={},i.values(o.HomeSections).forEach((function(t){return e.homeSectionToState[t]=r.INIT}))}return e.prototype.progressState=function(e,t){return this.homeSectionToState[e]+1===t&&(this.homeSectionToState[e]=t,!0)},e.prototype.haveAllSectionsReachedState=function(e){return i.every(this.homeSectionToState,(function(t){return t>=e}))},e})();t.HomeTimingStates=a})),define("modules/clean/react/home/util/navigation",["require","exports","modules/core/browser"],(function(e,t,n){"use strict";var i;function o(e){return e.metaKey||e.ctrlKey}Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.REDIRECT=1]="REDIRECT",e[e.NEW_TAB=2]="NEW_TAB",e[e.UNSAFE_NEW_TAB=3]="UNSAFE_NEW_TAB"})(i=t.NavigationMethod||(t.NavigationMethod={})),t.isMetaKeyPressed=o,t.getNavigationMethod=function(e){return o(e)?i.NEW_TAB:i.REDIRECT},t.logAndNavigate=function(e,t,o){switch(void 0===o&&(o=i.NEW_TAB),o){case i.REDIRECT:return void(t?t().then((function(){return n.redirect(e)})):n.redirect(e));case i.NEW_TAB:n.open_tab(e);break;case i.UNSAFE_NEW_TAB:n.unsafe_open_tab(e)}t&&t()}})),define("modules/clean/react/home/util/resource_icon",["require","exports","tslib","react","spectrum/icon_content","spectrum/file_icon","modules/clean/react/home/constants"],(function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderIcon=function(){var e=this.props.displayType;if(a.DisplayTypeToResourceType[e]===a.FILE_RESOURCE_TYPE)return i.default.createElement(r.FileIcon,{path:this.props.fileName,variant:"small"});var t=a.DisplayTypeToIconName[e]||a.DisplayTypeToIconName.FOLDER;return i.default.createElement(o.IconContent,{name:t})},t.prototype.render=function(){return i.default.createElement("span",{className:this.props.className},this.renderIcon())},t.displayName="HomeResourceIcon",t})((i=n.__importDefault(i)).default.PureComponent);t.HomeResourceIcon=s})),define("modules/clean/react/home/util/show_hide_link",["require","exports","tslib","classnames","react","spectrum/icon_arrow","modules/core/i18n"],(function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getLinkText=function(){return this.props.isExpanded?a._("Collapse section"):this.props.hiddenItemCount<=0?a._("Show more"):this.props.canLoadMore?a._("Show %(number)s+ more").format({number:this.props.hiddenItemCount}):a._("Show %(number)s more").format({number:this.props.hiddenItemCount})},t.prototype.getLinkClass=function(){return i.default({"button-as-link":!0,"show-hide-link":!0,"show-hide-link--expanded":this.props.isExpanded})},t.prototype.render=function(){return o.default.createElement("div",{className:"show-hide-link__container"},o.default.createElement("button",{onClick:this.props.onClick,className:this.getLinkClass()},o.default.createElement("div",{className:"show-hide-link__arrow"},o.default.createElement(r.IconArrow,{name:"right"})),this.getLinkText()))},t.displayName="ShowHideLink",t})((o=n.__importDefault(o)).default.PureComponent);t.ShowHideLink=s})),define("modules/clean/react/home/starred/starred_empty_state",["require","exports","tslib","react","modules/core/i18n"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),t.StarredEmptyState=function(){return i.default.createElement("div",{className:"home-access__empty-text starred--empty"},o._("When you star items, they’ll show up here for easy access.")+" ",i.default.createElement("a",{href:"/help/desktop-web/star-doc-file-folder",target:"_blank",rel:"noopener noreferrer"},o._("Learn more")))}})),define("modules/clean/react/home/starred/starred_empty_layout",["require","exports","tslib","react","modules/clean/react/home/starred/starred_empty_state","modules/clean/react/home/starred/starred_layout"],(function(e,t,n,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),t.StarredEmptyLayout=function(e){var t=e.isHiddenByUser;return i.default.createElement(r.StarredLayout,{starredComponent:o.StarredEmptyState,isHiddenByUser:t,itemModels:[],canShowSpinner:!1,hasMore:!1,hasLoadedInitial:!1})}})),define("modules/clean/react/home/starred/starred_layout",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/home/section_header","modules/clean/react/home/store","modules/clean/react/home/constants","modules/clean/react/home/actions","modules/clean/react/home/util/logging/activity_logger"],(function(e,t,n,i,o,r,a,s,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),t.STARRED_HEADER_TITLE=o._("Starred",{comment:"Home's starred section"});var u=(function(e){function u(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChangeVisibility=function(){var e=t.props.isHiddenByUser;c.HomeActions.setSectionVisibility(a.getUserId(),{".tag":"starred"},e),l.homeActivityLogger.logShowHideSection(s.HomeSections.STARRED,!e)},t}return n.__extends(u,e),u.prototype.render=function(){var e=this.props,a=e.isHiddenByUser,s=e.starredComponent,c=n.__rest(e,["isHiddenByUser","starredComponent"]),l=s,u=a?o._("Show"):o._("Hide");return i.default.createElement("li",{className:"home-access-section"},i.default.createElement(r.SectionHeader,{title:t.STARRED_HEADER_TITLE,ueName:"starred",buttonText:u,buttonAction:this.onChangeVisibility}),a?null:i.default.createElement(l,n.__assign({},c)))},u})(i.default.PureComponent);t.StarredLayout=u})),define("modules/clean/react/home/resource/store",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/constants","modules/clean/react/starred/constants","modules/clean/react/starred/id_type_pair","modules/clean/flux/flux_store"],(function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=e.call(this,i.Dispatcher)||this;return t.pendingPreviewResourceId=null,t.resourceIdToFile={},t.fileToPreview=null,t.resourceIdToEquivalentResourceId={},t}return n.__extends(t,e),t.prototype.getFileToPreview=function(){return this.fileToPreview},t.prototype.emitIfPendingFileExists=function(){if(null!==this.pendingPreviewResourceId){var e=this.resourceIdToEquivalentResourceId[this.pendingPreviewResourceId]||this.pendingPreviewResourceId;this.fileToPreview=this.resourceIdToFile[this.pendingPreviewResourceId]||this.resourceIdToFile[e]||null,null!==this.fileToPreview&&(this.pendingPreviewResourceId=null,this.__emitChange())}},t.prototype.onRequestPreview=function(e){this.pendingPreviewResourceId=e,this.emitIfPendingFileExists()},t.prototype.onReceivedResourceIdToFile=function(e){this.resourceIdToFile=n.__assign(n.__assign({},this.resourceIdToFile),e),this.emitIfPendingFileExists()},t.prototype.onStarredSetStatus=function(e){var t=this;e.forEach((function(e){if(e.canonicalIdTypePair){var n=a.idTypePairToString(e.idTypePair),i=a.idTypePairToString(e.canonicalIdTypePair);n!==i&&(t.resourceIdToEquivalentResourceId[i]=n,t.resourceIdToEquivalentResourceId[n]=i)}})),this.emitIfPendingFileExists()},t.prototype.__onDispatch=function(e){var t=e.action;switch(t.type){case o.HomeResourceStoreActionTypes.REQUEST_PREVIEW:this.onRequestPreview(t.resourceId);break;case o.HomeResourceStoreActionTypes.RECEIVED_RESOURCE_ID_TO_FILE:this.onReceivedResourceIdToFile(t.resourceIdToFile);break;case r.StarredActionTypes.SET_STATUS:this.onStarredSetStatus(t.starredStatuses)}},t})(s.FluxStore);t.HomeResourceStore=c;var l=null;t.getHomeResourceStore=function(){return null===l&&(l=new c),l}})),define("modules/clean/react/home/recents/recent_activity_constants",["require","exports","tslib","modules/constants/python","modules/core/i18n"],(function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importStar(i),t.RECENT_EVENT_TYPES=i.RECENT_EVENT_TYPES,t.RECENT_EVENT_FILTER_TYPE=i.RECENT_EVENT_FILTER_TYPE,t.ARCHIVE_PAPER_DOCUMENT_COMMIT="ARCHIVE_PAPER_DOCUMENT_COMMIT",t.ARCHIVE_PAPER_DOCUMENT_PENDING="ARCHIVE_PAPER_DOCUMENT_PENDING",t.ARCHIVE_PAPER_DOCUMENT_ROLLBACK="ARCHIVE_PAPER_DOCUMENT_ROLLBACK",t.DELETE_FILES_COMMIT="DELETE_FILES_COMMIT",t.DELETE_FILES_PENDING="DELETE_FILES_PENDING",t.DELETE_FILES_ROLLBACK="DELETE_FILES_ROLLBACK",t.RAW_RECENT_ACTIVITY_PARSE_ERROR="RAW_RECENT_ACTIVITY_PARSE_ERROR",t.RAW_RELATED_ACTIVITY_PARSE_ERROR="RAW_RELATED_ACTIVITY_PARSE_ERROR",t.RECEIVE_CAN_OPEN_INFO="RECEIVE_CAN_OPEN_INFO",t.RECEIVE_FILE_IN_ROOT_COLLECTION_INFO="RECEIVE_FILE_IN_ROOT_COLLECTION_INFO",t.RECEIVE_PAPER_RECENT_ITEMS="RECEIVE_PAPER_RECENT_ITEMS",t.RECEIVE_RAW_RECENT_ACTIVITIES="RECEIVE_RAW_RECENT_ACTIVITIES",t.RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY="RECEIVE_RAW_RELATED_ACTIVITIES_BY_KEY",t.REFRESH_RECENT_ACTIVITIES="REFRESH_RECENT_ACTIVITIES",t.ADD_PENDING_ACTIVITY_KEYS="ADD_PENDING_ACTIVITY_KEYS",t.REMOVE_PENDING_ACTIVITY_KEYS="REMOVE_PENDING_ACTIVITY_KEYS",t.MAX_INITIAL_DOC_ATTACHMENTS=3,t.SHOW_MORE_DOC_ATTACHMENT_INCREMENT=10,t.MAX_INITIAL_THUMBNAIL_ATTACHMENTS=8,t.SHOW_MORE_THUMBNAIL_ROW_INCREMENT=4,(function(e){e.CREATED="CREATE",e.OPENED="VIEW",e.EDITED="EDIT"})(t.PaperRecentItemAction||(t.PaperRecentItemAction={})),t.PaperRecentItemTypes={DOCUMENT:"DOCUMENT",FOLDER:"FOLDER",PROJECT:"PROJECT"},t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_PRE_TTI=10,t.MAX_RECENT_ITEM_COUNT_ON_RECENTS_V2_POST_TTI=100,t.MAX_ENSURE_ATTACHMENT_LOAD_ATTACHMENTS_ATTEMPTS=1,(function(e){e.OPENED="OPENED",e.EDITED="EDITED",e.ADDED="ADDED"})(t.RecentItemActionType||(t.RecentItemActionType={})),t.I18N={OPENED:o._("Opened"),EDITED:o._("Edited"),ADDED:o._("Added")},(function(e){e.COMMENT="comment",e.DELETE="delete",e.DOWNLOAD="download",e.HIDE="hide",e.OPEN="open",e.OPEN_DIR="open_dir",e.OPEN_PATH="open_path",e.PAPER_ARCHIVE="paper_archive",e.PAPER_OPEN="paper_open",e.PAPER_SHARE="paper_share",e.REPORT_JUNK="report_junk",e.SHARE="share",e.SHARE_COLLECTION="share_collection",e.UNITY_OPEN="unity_open",e.VERSIONS="versions",e.VIEW_FILE="view",e.VIEW_SHARED_LINK="view_shared_link",e.VIEW_IN_FOLDER="view_in_folder",e.COLLAPSE="collapse",e.UNCOLLAPSE="uncollapse",e.ONBOARDING_DISMISSED="onboarding_dismissed",e.FULL_ONBOARDING_OPENED="full_onboarding_opened",e.FULL_ONBOARDING_DISMISSED="full_onboarding_dismissed"})(t.ActionType||(t.ActionType={})),(function(e){e.SINGLE="single",e.SUBSET="subset",e.AGGREGATION="aggregation"})(t.ActionScope||(t.ActionScope={})),(function(e){e.RECENTS_JSON_CONTINUATION="handleAndLogRecentsJson",e.SHARE_FILE="shareFile",e.PREVIEW_RECENT_ITEM="previewRecentItem",e.OPEN_FILE="openFile",e.DOWNLOAD_FILES="downloadFiles",e.OPEN_VERSIONS="openVersions",e.PROMPT_AND_DELETE_ATTACHMENTS="promptAndDeleteAttachments",e.LOAD_REMAINING_ATTACHMENTS="loadRemainingAttachments"})(t.EnsureAttachmentsPurpose||(t.EnsureAttachmentsPurpose={}))})),define("modules/clean/react/home/recents/recent_activity_federated_model",["require","exports","modules/clean/react/home/recents/recent_activity_constants"],(function(e,t,n){"use strict";function i(e){return e.paperRecentItem.type===n.PaperRecentItemTypes.DOCUMENT}function o(e){return i(e)&&e.paperRecentItem.shareUrl||""}Object.defineProperty(t,"__esModule",{value:!0}),t.isPaperDocument=i,t.isPaperProject=function(e){return e.paperRecentItem.type===n.PaperRecentItemTypes.PROJECT},t.getPaperShareUrl=o,t.equalsPaperRecentItem=function(e,t){return e.paperRecentItem.id===t.id&&e.paperRecentItem.type===t.type};var r=(function(){function e(e){this.paperRecentItem=e}return e.prototype.isShareable=function(){return i(this)&&!!o(this)},e.prototype.isArchiveable=function(){return i(this)&&!!this.paperRecentItem.isEditable},e.prototype.hasMenuActions=function(){return this.isArchiveable()},e.prototype.getIdTypePair=function(){return{id:this.paperRecentItem.resource_id,type:this.paperRecentItem.id_type}},e.prototype.getStarredStatus=function(){return{starred:this.paperRecentItem.isFavorite,idTypePair:this.getIdTypePair()}},e.prototype.getIcon=function(){switch(this.paperRecentItem.display_type){case"PAPER_DOCUMENT":return"paper_doc";case"PAPER_FOLDER":return"folder";case"PAPER_PUBLIC_FOLDER":return"folder_team";case"PAPER_PROJECT":return"paper_project";default:return"file"}},e.prototype.getDisplayType=function(){return this.paperRecentItem.display_type},e.prototype.getIsDir=function(){return!1},e.prototype.getFolderPath=function(){return[""].concat(this.paperRecentItem.path.map((function(e){return e.name}))).join("/")},e.prototype.getFqPath=function(){return this.getFolderPath()+"/"+this.paperRecentItem.name},e.prototype.getActivityKey=function(){return"paper_id_"+this.paperRecentItem.id},e.prototype.getUrl=function(){return this.paperRecentItem.url},e})();t.FederatedRecentItem=r})),define("modules/clean/react/starred/id_type_pair",["require","exports","modules/clean/react/home/resource_id_types"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.idTypePairToString=function(e){return e.type+":"+e.id},t.idTypePairFromStarrableItem=function(e){return(function(e){return!!e.file_id})(e)?{id:e.file_id,type:n.HOME_RESOURCE_ID_TYPE.ENCODED_FILE_OBJ_ID}:(function(e){return!!e.pad_id})(e)?{id:e.pad_id,type:n.HOME_RESOURCE_ID_TYPE.PAPER_DOCUMENT_ID}:(function(e){return!!e.folder_id})(e)?{id:e.folder_id,type:n.HOME_RESOURCE_ID_TYPE.PAPER_FOLDER_ID}:(function(e){return!!e.fq_path})(e)?{id:e.fq_path,type:n.HOME_RESOURCE_ID_TYPE.FQ_PATH}:e}})),define("modules/clean/react/home/api",["require","exports","tslib","modules/clean/ajax","external/lodash","modules/core/exception","modules/clean/web_timing_logger"],(function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importStar(o);t.now=function(){return Date.now()};var s=0,c=0,l=t.now();function u(e){return n.__awaiter(this,void 0,void 0,(function(){var i,o;return n.__generator(this,(function(n){switch(n.label){case 0:return i=l,l=t.now(),e||l-i<40?(c++,o=10+~~(90*Math.random()),[4,new Promise((function(e){return setTimeout(e,o)}))]):[3,2];case 1:return n.sent(),c--,[2,o];case 2:return[2,0]}}))}))}t.makeRequest=function(e,o){var a=this,l=void 0===o?{}:o,d=l.delayRequest,m=l.isBackground;l.shouldAssertResponse;s++;var _=new Promise((function(o,l){return n.__awaiter(a,void 0,void 0,(function(){var a,_;return n.__generator(this,(function(h){switch(h.label){case 0:return[4,u(!!d)];case 1:return a=h.sent(),_=t.now(),(m?i.SilentBackgroundRequest:i.WebRequest)(n.__assign({dataType:"json",success:o,error:function(n,i,o){if("abort"!==i){var u=e&&e.url||"no url",h=o?": '"+o+"'":"",p="makeRequest to '"+u+"' failed - "+i+h;r.reportStack(p,{severity:r.SEVERITY.NONCRITICAL,exc_extra:{errorThrown:o,textStatus:i,requestParams:e,delayRequest:d,isBackground:m,requestDelay:a,openRequests:s,delayedRequests:c,requestDuration:t.now()-_,status:n.status,"exclog.exc_group":"homeapi:"+i+":"+o+":"+u}}),l(Error(o+" ("+u+")"))}}},e)),[2]}}))}))}));return _.finally((function(){return s--})),_};var d={},m=o.throttle((function(){o.size(d)>1&&r.reportStack("Multiple role activities",{severity:r.SEVERITY.NONCRITICAL,exc_extra:d}),Object.keys(d).forEach((function(e){var n=d[e];t.makeRequest({url:"/home_feed/log_activities",type:"POST",data:{role:e,activities_json:JSON.stringify(o.map(n,"json")),send_ts:t.now(),page_start_ts:window.performance&&window.performance.timing?window.performance.timing.navigationStart||window.performance.timing.fetchStart:void 0}},{isBackground:!0,delayRequest:!0,shouldAssertResponse:!0}).then((function(){return n.forEach((function(e){return e.resolve()}))}),(function(){return n.forEach((function(e){return e.reject()}))}))})),d={}}),1e3,{leading:!0,trailing:!0});t.logHomeActivity=function(e){var i=this,r=e.role,s=e.eventName,c=e.extra;return new Promise((function(e,l){return n.__awaiter(i,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return d[r]=d[r]||[],d[r].push({json:{event_name:s,event_time:t.now(),extra:o.mapValues(c||{},(function(e){return String(e)}))},resolve:e,reject:l}),[4,a.waitForTTI()];case 1:return n.sent(),m(),[2]}}))}))}))}})),define("modules/clean/react/starred/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredLoadingState={LOADING:"LOADING",LOAD_SUCCESS:"LOAD_SUCCESS",LOAD_FAILED:"LOAD_FAILED"},t.StarredActionTypes={LOADING:"STARRED_LOADING",SET_STATUS:"STARRED_SET_STATUS",LOAD_FAILURE:"STARRED_LOAD_FAILURE"},t.IdTypes={ENCODED_FILE_OBJ_ID:"ENCODED_FILE_OBJ_ID",EXTERNAL_RESOURCE_ID:"EXTERNAL_RESOURCE_ID",PAPER_ID_PATH:"PAPER_ID_PATH",FQ_PATH:"FQ_PATH"},(function(e){e.HOME_STARRED="HOME_STARRED",e.HOME_RECENTS="HOME_RECENTS",e.BROWSE="BROWSE",e.FILE_VIEWER="FILE_VIEWER",e.SUGGESTED_STARS="SUGGESTED_STARS",e.HOME_TASKS="HOME_TASKS"})(t.StarredSource||(t.StarredSource={}))})),define("modules/clean/react/home/content_suggestions/grid_layout",["require","exports","modules/clean/react/home/constants"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLayout=function(e,t){var i={minTileWidth:t?n.SUGGEST_GRID_V2_MIN_TILE_WIDTH:n.SUGGEST_GRID_MIN_TILE_WIDTH,maxColWidth:t?n.SUGGEST_GRID_V2_MAX_TILE_WIDTH:n.SUGGEST_GRID_MAX_TILE_WIDTH,tilePadding:t?n.SUGGEST_GRID_V2_TILE_PADDING:n.SUGGEST_GRID_TILE_PADDING},o=i.minTileWidth,r=i.maxColWidth,a=i.tilePadding,s=e-2*a-2;if(s<2*n.SUGGEST_GRID_MAX_TILE_WIDTH)return{itemsToShow:2,tileWidth:(s-a)/2};var c=Math.max(1,Math.floor(s/r)),l=n.SUGGEST_GRID_MAX_TILE_WIDTH;if(s%r>1){var u=s/(c+1)-a;u>=o&&(c++,l=u)}return{itemsToShow:c,tileWidth:l}}})),define("modules/clean/react/home/content_suggestions/loading",["require","exports","tslib","classnames","react","modules/clean/react/home/content_suggestions/grid_layout","modules/clean/react/home/content_suggestions/home_suggest_frame"],(function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.isHiddenByUser;return o.default.createElement(a.SuggestFrame,{isHiddenByUser:e},o.default.createElement(a.SuggestHeader,{isHiddenByUser:e}),o.default.createElement(c,n.__assign({},this.props)))},t})((o=n.__importDefault(o)).default.PureComponent);t.SuggestedLoading=s;var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderLoadingTile=function(e){return o.default.createElement("div",{className:i.default(["tile","home-suggest-preview-tile"])},o.default.createElement("div",{className:"tile__loading-container",style:{width:e+"px"}},o.default.createElement("div",{className:"tile__loading-thumbnail",style:{width:e+"px"}})),o.default.createElement("div",{className:"loading-tile-label"},o.default.createElement("div",{className:"loading-tile-label__detail-text"}),o.default.createElement("div",{className:"loading-tile-label__detail-subheader"})))},t.prototype.render=function(){for(var e=this.props,t=e.containerWidth,n=e.isHiddenByUser,a=e.useNewTile,s=r.getLayout(t,a),c=s.itemsToShow,l=s.tileWidth,u={"home-access-section__content":!0,"home__suggest-items":!0,"home__suggest-v2":a},d=[],m=0;m<c;m++)d.push(this.renderLoadingTile(l));return n?null:o.default.createElement("div",{className:i.default(u)},o.default.createElement("div",{className:"home-tile__container"},d))},t})(o.default.PureComponent);t.SuggestedLoadingInner=c})),define("modules/clean/react/home/content_suggestions/home_suggest_frame",["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/react/home/section_header","modules/clean/react/title_bubble"],(function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i),o=n.__importDefault(o),t.SuggestInfoIcon=function(){var e=r._("Quick access to files you’ve been working on.");return o.default.createElement(s.TitleBubble,{position:s.TitleBubble.POSITIONS.RIGHT,content:e,ariaLabel:e},o.default.createElement("div",{className:"info-icon-svg"},o.default.createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},o.default.createElement("g",{fill:"none",fillRule:"evenodd"},o.default.createElement("path",{d:"M12 20a8 8 0 1 1 0-16 8 8 0 0 1 0 16zm0-1.5a6.5 6.5 0 1 0 0-13 6.5 6.5 0 0 0 0 13z",fill:"#B4BBC2"}),o.default.createElement("path",{stroke:"#B4BBC2",d:"M11.5 12h1v3.5h-1zM11.5 8.5h1v1h-1z"})))))},t.SuggestHeader=function(e){var n=e.isHiddenByUser,i=e.buttonAction;return o.default.createElement(a.SectionHeader,{title:r._("Suggested from your activity",{comment:"Title for Home's suggested files section"}),ueName:"suggest",buttonText:n?r._("Show"):r._("Hide"),buttonAction:i,infoIcon:o.default.createElement(t.SuggestInfoIcon,null)})},t.SuggestFrame=function(e){var t=e.isHiddenByUser,n=e.children;return o.default.createElement("li",{className:i.default({"home-access-section":!0,"home-access-section-suggest-nonempty":!t})},n)}})),define("modules/clean/react/home/actions_post_tti",["require","exports","tslib","modules/clean/flux/dispatcher","modules/clean/react/home/constants","modules/core/notify","modules/clean/react/home/api_post_tti","modules/core/i18n"],(function(e,t,n,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSectionVisibilityPostTTI=function(e,i,o){t.setSectionVisibilityHelper(e,i,o,(function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){return[2,a.setSectionVisibility]}))}))}))},t.setSectionVisibilityHelper=function(e,t,a,c){return n.__awaiter(void 0,void 0,void 0,(function(){var l,u,d;return n.__generator(this,(function(n){switch(n.label){case 0:l=t[".tag"],i.Dispatcher.dispatch({type:o.HomeActionTypes.SET_SECTION_VISIBILITY,payload:{section:l,visible:a}}),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,c()];case 2:return[4,n.sent()(e,t,a)];case 3:return n.sent(),[3,5];case 4:throw u=n.sent(),d=a?s._("Unable to show section."):s._("Unable to hide section."),r.Notify.error(d),i.Dispatcher.dispatch({type:o.HomeActionTypes.SET_SECTION_VISIBILITY,payload:{section:l,visible:!a}}),u;case 5:return[2]}}))}))}})),define("modules/clean/react/home/api_post_tti",["require","exports","modules/clean/api_v2/user_client"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSectionVisibility=function(e,t,i){return(new n.UserApiV2Client).ns("home").rpc("set_section_visibility",{section:t,visible:i},{subjectUserId:e})},t.createPaperDoc=function(e){return(new n.UserApiV2Client).ns("paper").upload("docs/create",{import_format:{".tag":"plain_text"}},"",{subjectUserId:e})}})),define("modules/clean/react/home/modals/async_home_modals",["require","exports","tslib"],(function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncShowNewFolderModal=function(t){var i=t.user,o=t.origin,r=t.initialPath,a=t.onShowModal,s=t.onErrorShowingModal,c=t.redirectOnClose;return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,new Promise((function(t,n){e(["modules/clean/react/home/modals/new_folder_modal"],t,n)})).then(n.__importStar)];case 1:return(0,t.sent().showNewFolderModal)({user:i,onShowModal:a,initialPath:r,origin:o,redirectOnClose:c}),[3,3];case 2:return t.sent(),s&&s(),[3,3];case 3:return[2]}}))}))}}));
//# sourceMappingURL=pkg-home.min.js-vflG9CstR.map