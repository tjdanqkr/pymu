define(["require","exports","tslib","external/lodash","rondo/v1/behavior","modules/clean/teams/admin/pages/activity/filters/members_picker_behavior","modules/clean/rondo/forms/behaviors/form_auto_submit_behavior","modules/clean/rondo/forms/behaviors/form_behavior","modules/clean/teams/admin/pages/activity/activity_api","modules/clean/rondo/forms/behaviors/form_submit_behavior","rondo/v1/index","modules/clean/teams/admin/pages/activity/filters/initial_values","modules/clean/teams/admin/pages/activity/filters/submit","modules/clean/rondo/components/members_picker/contacts_picker_behavior","modules/clean/teams/admin/pages/activity/filters/filters_url","rondo/v1/selectors","modules/clean/teams/admin/pages/activity/filters/filter_logger","modules/clean/teams/admin/pages/activity/behaviors/activity_page","modules/clean/rondo/components/members_picker/contacts_picker_behavior"],(function(e,t,i,a,r,l,s,o,n,c,u,m,h,d,v,y,f,F,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=i.__importStar(a),t.FiltersBehaviorFactory=function(e,t,l){return(function(){function o(){var o=this;this.initialState=function(){return{allowSetFilter:!1}},this.actionAllowSetFilters=u.createAction().handle((function(){return{allowSetFilter:!0}})),this.actionClearFilters=u.createAction().watch((function(){o.actionSetValues({fieldsToValue:m.filtersValuesClear()})})),this.canSubmitFilters=y.createSelector((function(e){return e.allowSetFilter})),this.actionSubmit=u.createOrUseIn(this,F.activityPage.actionSubmit).watch((function(){var e=o.validValues(),t=v.filtersToURLSearch(e),i=F.activityPage.search();a.isEqual(t,i)||F.activityPage.actionLocationPush({search:t,merge:!1})})),this.actionSetMemberFilter=u.createOrUseIn(this,F.activityPage.filters.actionSetMemberFilter).watch((function(e,t){var a=t.account_id,r=t.email;return i.__awaiter(o,void 0,void 0,(function(){var e;return i.__generator(this,(function(t){switch(t.label){case 0:return[4,n.partakerByAccountIdAndEmail(r,a)];case 1:return(e=t.sent())&&this.actionSetValues({fieldsToValue:i.__assign(i.__assign({},m.filtersValuesClearNoDate()),{members:e.map((function(e){return d.parseTokenObject(e)}))})}),[2]}}))}))})),this.acionSetActivityFilter=u.createOrUseIn(this,F.activityPage.filters.actionSetActivityFilter).watch((function(e,t){var a=t;a&&o.actionSetValues({fieldsToValue:i.__assign(i.__assign({},m.filtersValuesClearNoDateAndTeams()),{activity:[a]})})})),r.extendBehavior(this,s.FormAutoSubmitBehavior({commitAction:F.activityPage.actionResults,dirtyAction:F.activityPage.actionDirty,submitFunction:t,submitAction:[F.activityPage.actionSubmit,F.activityPage.actionFetch],fields:e,additionalStateFieldsGenerator:c.additionalStateFieldsAPIv2,submitPartialValid:!0,canSubmit:this.canSubmitFilters})),r.extendBehavior(this,l)}return o.displayName="Filters",o})()};var p=(function(){function e(){this.initialState=function(){return{}},this.date=o.FieldBehaviorFactory({initialValue:m.dateFilterValueClear(),clearValue:m.dateFilterValueClear()}),this.members=u.createBehavior(b.TypeAheadFactory(l.ActivityDataSource)),this.participants=o.FieldBehaviorFactory({initialValue:m.emptyEnumValueClear(),clearValue:m.emptyEnumValueClear()}),this.file=o.FieldBehaviorFactory({initialValue:m.fileFilterValueClear(),clearValue:m.fileFilterValueClear()}),this.teams=o.FieldArrayBehaviorFactory({initialValue:m.emptyListFilterValueClear(),clearValue:m.emptyListFilterValueClear()}),this.activity=o.FieldArrayBehaviorFactory({initialValue:m.emptyListFilterValueClear(),clearValue:m.emptyListFilterValueClear()}),r.extendBehavior(this,t.FiltersBehaviorFactory({file:this.file,teams:this.teams,activity:this.activity,members:this.members,participants:this.participants,date:this.date},h.submit,f.FilterLogger))}return e.displayName="FiltersBehaviorInherit",e})();t.FiltersBehavior=p}));
//# sourceMappingURL=filters_behavior.min.js-vfl1Ffnwo.map