define("modules/clean/account_page/widgets/billing/payment_methods_util",["require","exports","tslib","react","modules/core/i18n","modules/constants/trademark","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/account_page/widgets/billing/payment_method_constants","modules/clean/payments/cash"],(function(e,t,r,n,o,a,i,s,u,l){"use strict";function c(e){return[u.GOOGLE_PLAY_SUBSCRIPTION,u.IOS_ONE_TIME_PAYMENT,u.IOS_SANDBOX_ONE_TIME_PAYMENT,u.IOS_RECURRING_PAYMENT,u.IOS_SANDBOX_RECURRING_PAYMENT,u.NO_CHARGE_GATEWAY,u.RESELLER_LICENSE_KEY].includes(e)}function p(e){return[u.IOS_ONE_TIME_PAYMENT,u.IOS_RECURRING_PAYMENT,u.IOS_SANDBOX_ONE_TIME_PAYMENT,u.IOS_SANDBOX_RECURRING_PAYMENT].includes(e)}function d(){i.ProEventsLogger.log("account_plan_ios_apple_cancel_help_clicked")}function m(){return n.default.createElement("a",{className:"plan-status-section__mobile_help_link",href:"https://support.apple.com/HT202039",target:"_blank",rel:"noopener noreferrer",onClick:d},o._("Learn how to manage your Apple App Store subscription"))}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),t.shouldHidePaymentMethod=c,t.isLicenseKey=function(e){return e===u.RESELLER_LICENSE_KEY},t.isIOS=p,t.shouldHideBillingChange=function(e,t){return t||c(e)},t.shouldHideBillingSummary=function(e,t){return e===u.NO_CHARGE_GATEWAY&&t===s.ProductPlanType.FREE},t.getAppleLink=m,t.getTrialDescription=function(e,t,r){var i,s=p(e);i=t.is_trial_overdue?s?n.default.createElement("div",null,o._("You started a Dropbox %(plus)s trial through the iOS app.").format({plus:a.TRADEMARK_PLUS}),n.default.createElement("br",null),o._("For billing details, please check your iTunes receipt."),n.default.createElement("br",null),o._("Your subscription is on an extension period.")):o._("Your trial has expired but we were unable to process            your credit card for the Dropbox %(plus)s upgrade.").format({plus:a.TRADEMARK_PLUS}):t.is_close_to_trial_conversion?o._("Your trial will automatically upgrade to a Dropbox %(plus)s account         in the next 48 hours.").format({plus:a.TRADEMARK_PLUS}):o._("Your trial will automatically upgrade to a Dropbox %(plus)s account       in %(num_days)s days.").format({plus:a.TRADEMARK_PLUS,num_days:t.days_left});var u=n.default.createElement("noscript",null);return s&&!t.is_trial_overdue&&(u=m()),n.default.createElement("span",null,i,n.default.createElement("br",null),u)},t.getProfessionalTrialPlanDescription=function(e){if(e&&e.nextBillingSummary&&e.subState.billingSchedule)return o._("Starting on %(conversion_date)s, we’ll bill you once a %(period_noun)s for your     Dropbox %(professional)s plan. Your new %(period_adj)s total will be %(price)s.").format({professional:a.TRADEMARK_PROFESSIONAL,conversion_date:e.formattedNextBillingDate,period_noun:e.subState.billingSchedule.scheduleDescriptionNoun,period_adj:e.subState.billingSchedule.scheduleDescriptionAdjective,price:l.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)})},t.getProfessionalTrialScheduleDescription=function(e){if(e&&e.nextBillingSummary&&e.subState.billingSchedule)return o._("Your Dropbox %(professional)s plan will convert on %(conversion_date)s.       Your %(period)s total will be %(price)s (including taxes).").format({professional:a.TRADEMARK_PROFESSIONAL,conversion_date:e.formattedNextBillingDate,period:e.subState.billingSchedule.scheduleDescriptionAdjective,price:l.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)})},t.getBillingDisabledMessage=function(e){return e.isResellerBilling?n.default.createElement("a",{href:e.resellerLink,target:"_blank",rel:"noopener noreferrer"},o._("Go to %(reseller_name)s to view or make changes to your account details.").format({reseller_name:e.resellerName})):e.gatewayId===u.GOOGLE_PLAY_SUBSCRIPTION?o._("You purchased Dropbox %(dropbox_plan)s through Google Play.\n            To make changes to your subscription, visit the Google Play Store.").format({dropbox_plan:e.dropboxPlan}):e.gatewayId===u.IOS_ONE_TIME_PAYMENT?o._("You purchased Dropbox %(dropbox_plan)s through the iOS app.\n        Your plan will expire on %(end_date)s.").format({dropbox_plan:e.dropboxPlan,end_date:e.endDate}):[u.IOS_RECURRING_PAYMENT,u.IOS_SANDBOX_RECURRING_PAYMENT].includes(e.gatewayId)?e.deactivated?o._("Your subscription from Apple is no longer active."):e.isOnTrial?n.default.createElement("div",null,n.default.createElement("span",null,o._("You started a Dropbox %(dropbox_plan)s trial through the iOS app.").format({dropbox_plan:e.dropboxPlan})),n.default.createElement("br",null),m()):n.default.createElement("div",null,n.default.createElement("span",null,o._("You purchased Dropbox %(dropbox_plan)s through the iOS app.").format({dropbox_plan:e.dropboxPlan})),n.default.createElement("br",null),m()):o._("Sorry, you cannot change your billing schedule at this time.")},t.getPaymentMethodDisabledMessage=function(e,t,r,a,i,s){return t?o._("You’re being externally billed."):e===u.GOOGLE_PLAY_SUBSCRIPTION?o._("You purchased Dropbox %(dropbox_plan)s through Google Play.           To make changes to your subscription, visit the Google Play Store.").format({dropbox_plan:r}):e===u.IOS_ONE_TIME_PAYMENT?o._("You purchased Dropbox %(dropbox_plan)s through the iOS app.\n        Your plan will expire on %(end_date)s.").format({dropbox_plan:r,end_date:a}):[u.IOS_RECURRING_PAYMENT,u.IOS_SANDBOX_RECURRING_PAYMENT].includes(e)?i?o._("Your subscription from Apple is no longer active."):s?n.default.createElement("div",null,n.default.createElement("span",null,o._("You started a Dropbox %(dropbox_plan)s trial through the iOS app.").format({dropbox_plan:r})),n.default.createElement("br",null),m()):n.default.createElement("div",null,n.default.createElement("span",null,o._("You purchased Dropbox %(dropbox_plan)s through the iOS app.").format({dropbox_plan:r})),n.default.createElement("br",null),m()):o._("Sorry, you cannot change your billing schedule at this time.")}})),define("modules/clean/payments/cvv_hint",["require","exports","tslib","react","modules/core/i18n","modules/clean/static_urls"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return this.props.showServerViewVersion?n.createElement("div",{className:"cvv-hint-view-desktop","aria-live":"assertive"},n.createElement("div",null,n.createElement("h5",null,o._("Visa/Mastercard",{comment:"Credit card types"})),n.createElement("p",null,o._("The 3 digit number on the back of your card")),n.createElement("h5",null,o._("American Express",{comment:"Credit card type"})),n.createElement("p",null,o._("The 4 digit number on the front of your card")),n.createElement("h5",null)),n.createElement("img",{src:a.static_url("/static/images/cvv2_side_by_side-vflKpqWew.png"),alt:""})):n.createElement("div",{className:"cvv-hint-view","aria-live":"assertive"},n.createElement("div",null,n.createElement("p",null,o._("Your card code is a 3 or 4 digit number that is found in these locations:",{comment:"card refers to credit card"})),n.createElement("img",{src:a.static_url("/static/images/cvv2-vflQL_5Od.png"),alt:""}),n.createElement("h5",null,o._("Visa/Mastercard",{comment:"Credit card types"})),n.createElement("p",null,o._("The security code is a 3 digit number on the back of your credit card.                 It immediately follows your main card number.")),n.createElement("h5",null,o._("American Express",{comment:"Credit card type"})),n.createElement("p",null,o._("The security code is a 4 digit number on the front of your card,                 just above and to the right of your main card number."))))},t})((n=r.__importStar(n)).Component);t.CvvHint=i})),define("modules/clean/payments/cvv_hint_container",["require","exports","tslib","react","modules/clean/payments/cvv_hint","modules/clean/react/css","modules/clean/react/tooltip","spectrum/tooltip"],(function(e,t,r,n,o,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setSpectrumTooltipRef=function(e){t.spectrumTooltipRef=e},t.setTooltipRef=function(e){t.tooltipRef=e},t.showTooltip=function(){t.spectrumTooltipRef?t.spectrumTooltipRef.showTooltip():t.tooltipRef._show()},t.hideTooltip=function(){t.spectrumTooltipRef?t.spectrumTooltipRef.hideTooltip():t.tooltipRef._hide()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.targetDimensions,t=n.createElement(i.Tooltip,{position:i.TooltipPosition.BOTTOM_RIGHT,tooltip_contents:n.createElement(o.CvvHint,{showServerViewVersion:this.props.showServerViewVersion}),ref:this.setTooltipRef,is_focusable:!1},n.createElement("div",{style:{width:e.width,height:e.height}}));return this.props.showServerViewVersion&&(t=n.createElement(s.Tooltip,{ref:this.setSpectrumTooltipRef,positioning:"above",tooltipContent:n.createElement(o.CvvHint,{showServerViewVersion:this.props.showServerViewVersion})},n.createElement("div",{style:{width:e.width,height:e.height}}))),n.createElement("div",{className:"cvv-hint-container"},n.createElement("div",{style:{left:e.left,top:e.top}},t))},t})((n=r.__importStar(n)).Component);t.CvvHintContainerView=u,t.CvvHintContainer=a.requireCssWithComponent(u,["/static/css/payments/cvv_hint_container-vfliTfcQ2.css"])})),define("modules/clean/payments/payment_form/iframe_rpc",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameRpc={ADYEN_ENCRYPTED:"ADYEN_ENCRYPTED",BLUR_FIELD:"BLUR_FIELD",DATA:"DATA",ENCRYPT_WITH_ADYEN:"ENCRYPT_WITH_ADYEN",ENCRYPT_FOR_NETWORK_TOKEN:"ENCRYPT_FOR_NETWORK_TOKEN",FOCUS_OUTSIDE_IFRAME:"FOCUS_OUTSIDE_IFRAME",HIDE_TOOLTIP:"HIDE_TOOLTIP",INIT_ADYEN:"INIT_ADYEN",INIT_BRAINTREE:"INIT_BRAINTREE",INIT_NETWORK_TOKEN:"INIT_NETWORK_TOKEN",NETWORK_TOKEN_ENCRYPTED:"NETWORK_TOKEN_ENCRYPTED",READY:"READY",SET_SERVER_TIME:"SET_SERVER_TIME",SHOW_CVV_MODAL:"SHOW_CVV_MODAL",SHOW_FORM_ERRORS:"SHOW_FORM_ERRORS",SHOW_TOOLTIP:"SHOW_TOOLTIP",SIZE_UPDATE:"SIZE_UPDATE",STATUS_UPDATE:"DATA_STATUS_UPDATE",TOKENIZE:"TOKENIZE",TOKENIZED:"TOKENIZED",VALIDATION_FAILED:"VALIDATION_FAILED",VALIDATION_UPDATE:"VALIDATION_UPDATE"};var r=(function(){function e(e,r){var n=this;this.origin=e,this.handler=r,this.messageHandler=function(e){if(n.origin===e.origin){var r;try{r=JSON.parse(e.data)}catch(e){return}if(r.hasOwnProperty("action")){var o=r.action,a=r.DATA;switch(o){case t.IFrameRpc.READY:n.handler.originReady&&e.source&&n.handler.originReady(e.source);break;case t.IFrameRpc.TOKENIZE:n.handler.tokenize&&n.handler.tokenize();break;case t.IFrameRpc.ADYEN_ENCRYPTED:a&&a.encrypted&&n.handler.submitEncryptedAdyenCard&&n.handler.submitEncryptedAdyenCard(a.encrypted);break;case t.IFrameRpc.HIDE_TOOLTIP:a&&a.tooltipId&&n.handler.hideTooltip&&n.handler.hideTooltip(a.tooltipId);break;case t.IFrameRpc.INIT_BRAINTREE:a&&a.token&&n.handler.init_bt&&n.handler.init_bt(a.token);break;case t.IFrameRpc.NETWORK_TOKEN_ENCRYPTED:a&&a.encrypted&&a.cardType&&n.handler.submitEncryptedCardForNetworkToken&&n.handler.submitEncryptedCardForNetworkToken(a.cardType,a.encrypted);break;case t.IFrameRpc.TOKENIZED:a&&a.nonce&&a.bin&&n.handler.submitTokenized&&n.handler.submitTokenized(a.nonce,a.bin);break;case t.IFrameRpc.SHOW_CVV_MODAL:n.handler.showCvvModal&&n.handler.showCvvModal();break;case t.IFrameRpc.SHOW_TOOLTIP:a&&a.tooltipId&&a.tooltipTarget&&n.handler.showTooltip&&n.handler.showTooltip(a.tooltipId,a.tooltipTarget);break;case t.IFrameRpc.FOCUS_OUTSIDE_IFRAME:n.handler.focusOutsideIframe&&n.handler.focusOutsideIframe();break;case t.IFrameRpc.STATUS_UPDATE:n.handler.handleDataStatusUpdate&&n.handler.handleDataStatusUpdate(a);break;case t.IFrameRpc.VALIDATION_FAILED:n.handler.handleValidationFailure&&n.handler.handleValidationFailure(a);break;case t.IFrameRpc.VALIDATION_UPDATE:n.handler.handleValidationUpdate&&n.handler.handleValidationUpdate(a);break;case t.IFrameRpc.SIZE_UPDATE:a&&a.formHeight&&n.handler.handleSizeUpdate&&n.handler.handleSizeUpdate(a.formHeight);break;case t.IFrameRpc.BLUR_FIELD:n.handler.handleBlurField&&n.handler.handleBlurField(a)}}}},window.addEventListener("message",this.messageHandler)}return e.prototype.removeMessageListener=function(){window.removeEventListener("message",this.messageHandler)},e})();t.IFrameRpcListener=r;var n=(function(){function e(e,t){this.origin=e,this.target=t}return e.prototype.sendMessage=function(e,t){var r={action:e};t&&(r.DATA=t),this.target.postMessage(JSON.stringify(r),this.origin)},e})();t.IFrameRpcTransport=n})),define("modules/clean/payments/payment_form/payment_form_spec",["require","exports","external/lodash"],(function(e,t,r){"use strict";var n,o,a;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.CreditCard=1]="CreditCard",e[e.PayPal=2]="PayPal",e[e.DirectDeposit=3]="DirectDeposit",e[e.Ideal=5]="Ideal"})(n=t.PaymentMethod||(t.PaymentMethod={})),(function(e){e.DirectDebit="direct_debit",e.ApplePay="apple_pay",e.GooglePay="google_pay",e.ACH="ach",e.Other="other"})(o=t.PaymentMethodSurveyOption||(t.PaymentMethodSurveyOption={})),(function(e){e.DirectDebit="DIRECT_DEBIT",e.MobileWallet="MOBILE_WALLET"})(a||(a={}));var i=(function(){function e(e){this.spec=e}return e.prototype.showPSD2FieldsToUser=function(e,t,r){return r&&e===n.CreditCard&&this.should_show_PSD2_address_fields_for_country(t)},e.prototype.isTeam=function(){return this.spec.is_team},e.prototype.remove_payment_method=function(e){for(var t in this.spec.available_payment_methods_overrides_by_country)if(this.spec.available_payment_methods_overrides_by_country[t].length>1){var r=this.spec.available_payment_methods_overrides_by_country[t].indexOf(e);-1!==r&&this.spec.available_payment_methods_overrides_by_country[t].splice(r,1)}if(this.spec.default_available_payment_methods.length>1){var n=this.spec.default_available_payment_methods.indexOf(e);-1!==n&&this.spec.default_available_payment_methods.splice(n,1)}},e.prototype.available_payment_methods_for_country=function(e){return this.spec.available_payment_methods_overrides_by_country[e]?this.spec.available_payment_methods_overrides_by_country[e]:this.spec.default_available_payment_methods},e.prototype.only_default_payment_methods=function(){return this.spec.default_available_payment_methods},e.prototype.default_payment_method=function(){return this.spec.default_available_payment_methods[0]},e.prototype.default_payment_method_for_country=function(e){return this.available_payment_methods_for_country(e)[0]},e.prototype.supported_credit_cards_for_country=function(e){return this.spec.supported_credit_cards_overrides_by_country[e]?this.spec.supported_credit_cards_overrides_by_country[e]:this.spec.default_supported_credit_cards},e.prototype.should_show_vat_for_country=function(e){return this.spec.countries_with_vat.indexOf(e)>-1},e.prototype.should_show_PSD2_address_fields_for_country=function(e){return this.spec.countries_with_PSD2_address_fields.indexOf(e)>-1},e.prototype.should_require_cpf=function(e,t){return"BR"===e&&t===n.CreditCard},e.prototype.paymentMethodSurveyOptions=function(e,t){return void 0===this.surveyOptions&&(this.surveyOptions=this.getPaymentMethodSurveyOptions(e,t)),this.surveyOptions},e.prototype.getPaymentMethodSurveyOptions=function(e,t){return t===a.DirectDebit&&"GB"===e?[o.DirectDebit,o.Other]:t===a.MobileWallet&&"US"===e?r.shuffle([o.ApplePay,o.GooglePay,o.ACH]).concat(o.Other):[]},e.prototype.allow_zip_code_for_country=function(e){return-1===this.spec.countries_without_zip_code.indexOf(e)},e.prototype.filter_payment_methods_by_price_limit=function(e,t){for(var r=[],n=this.spec.price_limit_for_payment_methods,o=0,a=e;o<a.length;o++){var i=a[o],s=n[i];s[t.currency]?t.amount<=s[t.currency]&&r.push(i):r.push(i)}return r},e.prototype.filter_payment_methods_by_currency=function(e,t){for(var r=[],n=this.spec.supported_currencies_for_payment_methods,o=0,a=e;o<a.length;o++){var i=a[o];n[i]?n[i].indexOf(t)>-1&&r.push(i):r.push(i)}return r},e})();t.PaymentFormSpec=i})),define("modules/clean/payments/payments_web_request",["require","exports","tslib","modules/clean/ajax","modules/core/browser","modules/core/html","modules/core/i18n","modules/core/notify"],(function(e,t,r,n,o,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),o=r.__importStar(o);var u=function(e){var t=this;this.request=function(){n.WebRequest({url:t.options.url,type:null!=t.options.type?t.options.type:void 0,data:t.options.data||{},success:t.success,complete:t.complete,error:t.error})},this.success=function(e,r,n){var a=t.extractErrors(n.responseText);if(a)return t.handleErrors(a),void("function"==typeof t.options.error&&t.options.error(n,r,a));(e=JSON.parse(n.responseText)).redirect?o.unsafeRedirect(e.redirect):e.reload?o.reload():(t.performActions(e.actions||[]),"function"==typeof t.options.success&&t.options.success(e,r,n))},this.performActions=function(e){return(function(){for(var r=[],n=0,o=Array.from(e);n<o.length;n++){var i=o[n],u=Array.from(i),l=u[0],c=u[1];switch(l){case"notify":r.push(s.Notify.success(c));break;case"notifyError":r.push(s.Notify.error(new a.HTML(c),t.options.errorDuration||void 0));break;default:r.push(void 0)}}return r})()},this.extractErrors=function(e){if(0!==e.indexOf("err:"))return!1;e=e.substr(4);try{return JSON.parse(e)}catch(t){return"string"==typeof e?e:i._("There was a problem completing this request.")}},this.error=function(e,r,n){var o=t.extractErrors(e.responseText);return"abort"!==r&&t.handleErrors(o),"function"==typeof t.options.error?t.options.error(e,r,n):void 0},this.handleErrors=function(e){return!1===e?s.Notify.error(i._("There was a problem completing this request.")):"string"==typeof e?s.Notify.error(e):void 0},this.complete=function(e,r){return"function"==typeof t.options.complete?t.options.complete(e,r):void 0},null==e&&(e={}),this.options=e};t.PaymentsWebRequest=u})),define("modules/clean/payments/skus/billing_schedule",["require","exports","modules/core/i18n","modules/clean/payments/skus/constants"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(){}return e.deserialize=function(t){var r=new e;return r.serializedBillingSchedule=t,r},Object.defineProperty(e.prototype,"id",{get:function(){return this.serializedBillingSchedule.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this.serializedBillingSchedule.description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scheduleDescriptionAdjective",{get:function(){switch(this.id){case n.ScheduleId.MONTHLY:return r._("monthly");case n.ScheduleId.YEARLY:return r._("yearly");default:return""}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scheduleDescriptionNoun",{get:function(){switch(this.id){case n.ScheduleId.MONTHLY:return r._("month");case n.ScheduleId.YEARLY:return r._("year");default:return""}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unlocalizedName",{get:function(){return this.serializedBillingSchedule.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){switch(this.serializedBillingSchedule.id){case n.ScheduleId.MONTHLY:return r._("monthly");case n.ScheduleId.YEARLY:return r._("yearly")}return""},enumerable:!0,configurable:!0}),e})();t.BillingSchedule=o})),define("modules/clean/payments/skus/billing_summary",["require","exports","modules/core/i18n","modules/clean/payments/skus/billing_summary_line_item","modules/clean/payments/skus/constants","modules/clean/payments/cash"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){}return e.deserialize=function(t){var r=new e;return t?(r._lineItems=t.lineItems.map((function(e){return n.BillingSummaryLineItem.deserialize(e)})),r.baseAmount=a.Cash.fromObject(t.baseAmount),r.discountAmount=a.Cash.fromObject(t.discountAmount),r._discountPercentage=t.discountPercentage,r._doesTaxApply=t.doesTaxApply,r.taxAmount=a.Cash.fromObject(t.taxAmount),r.totalAmount=a.Cash.fromObject(t.totalAmount),r._taxRate=t.taxRate,r._taxName=t.taxName,r):r},Object.defineProperty(e.prototype,"lineItems",{get:function(){return this._lineItems.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"base",{get:function(){return this.baseAmount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"discount",{get:function(){return this.discountAmount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"discountPercentage",{get:function(){return this._discountPercentage},enumerable:!0,configurable:!0}),e.prototype.getPerLicenseCost=function(e){for(var t=0,r=this.lineItems;t<r.length;t++){var n=r[t];if(n.sku.code===e){var o=n.price.amount/n.quantity,i=1-this.discountPercentage/100;return new a.Cash(o*i,n.price.currency)}}},Object.defineProperty(e.prototype,"tax",{get:function(){return this.taxAmount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taxRate",{get:function(){return this._taxRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taxName",{get:function(){return this._taxName},enumerable:!0,configurable:!0}),e.prototype.taxString=function(){return this.taxRate<=0?"":r._("(including %(tax_rate_str)s tax)").format({tax_rate_str:r.format_percent(this.taxRate)})},Object.defineProperty(e.prototype,"total",{get:function(){return this.totalAmount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalLicenses",{get:function(){return this._lineItems.reduce((function(e,t){return t.sku.productClass===o.ProductClass.LICENSE&&(e+=t.quantity),e}),0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"doesTaxApply",{get:function(){return this._doesTaxApply},enumerable:!0,configurable:!0}),e})();t.BillingSummary=i})),define("modules/clean/payments/skus/billing_summary_line_item",["require","exports","modules/clean/payments/skus/catalog_sku","modules/clean/payments/cash"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(){}return e.deserialize=function(t){var o=new e;return o._sku=r.CatalogSku.deserialize(t.sku),o._quantity=t.quantity,o._price=n.Cash.fromObject(t.price),t.lineItemPrice?o._displayPrice=n.Cash.fromObject(t.lineItemPrice):o._displayPrice=n.Cash.fromObject(t.price),o},Object.defineProperty(e.prototype,"sku",{get:function(){return this._sku},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quantity",{get:function(){return this._quantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"price",{get:function(){return this._price},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayPrice",{get:function(){return this._displayPrice},enumerable:!0,configurable:!0}),e})();t.BillingSummaryLineItem=o})),define("modules/clean/payments/skus/catalog_sku",["require","exports","modules/core/i18n","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/account_page/widgets/billing/payment_method_constants","modules/clean/payments/skus/billing_schedule","modules/clean/payments/cash","modules/clean/display_format","modules/clean/payments/skus/sku_content","modules/clean/payments/skus/constants","modules/constants/trademark"],(function(e,t,r,n,o,a,i,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(){function e(e){this.serializedSku=e,this.billingSchedule=a.BillingSchedule.deserialize(e.billingSchedule),e.content&&(this.content=u.SkuContentClient.deserialize(e.content))}return e.deserialize=function(t){return new e(t)},e.prototype.displayName=function(e,t,n){return void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=o.NOT_APPLICABLE),e?this.displayUntranslatableNameDirectFromSku:this.productFamily===l.ProductFamily.TEAM||this.productFamily===l.ProductFamily.ENTERPRISE?t&&l.ProductPlanType.STANDARD?r._("%(trademark_business)s").format({trademark_business:c.TRADEMARK_BUSINESS}):this.displayNameForBusinessPlans():this.productFamily===l.ProductFamily.PRO?this.displayNameForIndividualPlans(n):this.displayUntranslatableNameDirectFromSku},e.prototype.displayNameForIndividualPlans=function(e){void 0===e&&(e=o.NOT_APPLICABLE);var t=n.isIOS(e);return this.productClass===l.ProductClass.PLAN?l.productPlanTypeToIndividualDisplayName(this.productType,t):this.productClass===l.ProductClass.ADDON&&this.productType===l.ProductAddonType.EVH?r._("%(quota)s space").format({quota:this.formattedSpecQuotaGb}):""},e.prototype.displayNameForBusinessPlans=function(){return this.productClass===l.ProductClass.PLAN?l.productPlanTypeToBusinessDisplayName(this.productType,this.productFamily):this.productClass===l.ProductClass.LICENSE?r._("License(s)"):this.productClass===l.ProductClass.ADDON&&this.productType===l.ProductAddonType.QUOTA?r._("%(quota)s space").format({quota:this.formattedSpecQuotaGb}):""},e.prototype.displaySpace=function(){if(this.productClass===l.ProductClass.PLAN){if(this.productType===l.ProductPlanType.STANDARD||this.productType===l.ProductPlanType.TRIAL||this.productType===l.ProductPlanType.ADVANCED||this.productType===l.ProductPlanType.ADVANCED_TRIAL)return r._("As much space as you need");var e=this.longFormSpecQuotaGb;if(e)return r._("%(space_quota)s of space").format({space_quota:e})}return""},e.prototype.descriptionName=function(){if(this.productClass===l.ProductClass.LICENSE)switch(this.productType){case l.ProductPlanType.STANDARD:return r._("Prior %(trademark_business)s").format({trademark_business:c.TRADEMARK_BUSINESS});case l.ProductPlanType.NEW_STANDARD:switch(this.billingSchedule.id){case l.ScheduleId.MONTHLY:return r._("Standard, billed monthly");case l.ScheduleId.YEARLY:return r._("Standard, billed yearly");default:return r._("Standard")}case l.ProductPlanType.ADVANCED:switch(this.billingSchedule.id){case l.ScheduleId.MONTHLY:return r._("Advanced, billed monthly");case l.ScheduleId.YEARLY:return r._("Advanced, billed yearly");default:return r._("Advanced")}default:return r._("Current Plan")}return this.productClass===l.ProductClass.ADDON&&this.productType===l.ProductAddonType.QUOTA?r._("Addl. space"):""},Object.defineProperty(e.prototype,"code",{get:function(){return this.serializedSku.code},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayUntranslatableNameDirectFromSku",{get:function(){return this.serializedSku.displayName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exclusionGroup",{get:function(){return this.serializedSku.exclusionGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"productFamily",{get:function(){return this.serializedSku.productFamily},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adminCxId",{get:function(){return this.serializedSku.adminCxId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"productClass",{get:function(){return this.serializedSku.productClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"productType",{get:function(){return this.serializedSku.productType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"productSpec",{get:function(){return this.serializedSku.productSpec},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schedule",{get:function(){return this.serializedSku.schedule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scheduleId",{get:function(){return this.serializedSku.billingSchedule.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scheduleName",{get:function(){return this.serializedSku.billingSchedule.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scheduleDescription",{get:function(){return this.serializedSku.billingSchedule.description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayCost",{get:function(){return i.Cash.fromObject(this.serializedSku.price.displayCost)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayCostIsTaxInclusive",{get:function(){return this.serializedSku.price.isTaxInclusive},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isProductPlan",{get:function(){return this.productClass===l.ProductClass.PLAN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"specQuotaGb",{get:function(){return this.serializedSku.specQuotaGb},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedSpecQuotaGb",{get:function(){if(this.specQuotaGb)return s.formatGigabytes(this.specQuotaGb)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longFormSpecQuotaGb",{get:function(){if(this.specQuotaGb)return"%(formatted_quota)s (%(space_quota)s GB)".format({formatted_quota:this.formattedSpecQuotaGb,space_quota:this.specQuotaGb})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adminCxName",{get:function(){return this.serializedSku.adminCxName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTrialPlan",{get:function(){return this.productType===l.ProductPlanType.TRIAL||this.productType===l.ProductPlanType.STANDARD_TRIAL||this.productType===l.ProductPlanType.ADVANCED_TRIAL||this.productType===l.ProductPlanType.SERVER_TRIAL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLegacyPlan",{get:function(){return!this.isStandardPlan&&!this.isAdvancePlan&&!this.isServerPlan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStandardPlan",{get:function(){return this.productType===l.ProductPlanType.NEW_STANDARD||this.productType===l.ProductPlanType.STANDARD_TRIAL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAdvancePlan",{get:function(){return this.productType===l.ProductPlanType.ADVANCED||this.productType===l.ProductPlanType.ADVANCED_TRIAL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isServerPlan",{get:function(){return this.productType===l.ProductPlanType.SERVER||this.productType===l.ProductPlanType.SERVER_TRIAL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEnterprise",{get:function(){return this.productFamily===l.ProductFamily.ENTERPRISE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adminCxDescription",{get:function(){if(this.productClass===l.ProductClass.PLAN)return this.adminCxName;if(this.productClass===l.ProductClass.ADDON)switch(this.productSpec){case l.ProductSpec.SPACE_PACK_100G:return"100GB Team Space Extra";case l.ProductSpec.SPACE_PACK_10T:return"10TB Team Space Extra";case l.ProductSpec.SPACE_PACK_50T:return"50TB Team Space Extra";case l.ProductSpec.SPACE_PACK_200T:return"200TB Team Space Extra";case l.ProductSpec.SPACE_PACK_500T:return"500TB Team Space Extra";case l.ProductSpec.SPACE_PACK_1000T:return"1000TB Team Space Extra";case l.ProductSpec.SPACE_PACK_5000T:return"5000TB Team Space Extra"}return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adminCxIsValid",{get:function(){return this.productClass===l.ProductClass.PLAN&&(this.billingSchedule.id!==l.ScheduleId.FIVE_YEARS&&(this.productFamily!==l.ProductFamily.ENTERPRISE||this.billingSchedule.id!==l.ScheduleId.MONTHLY))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adminCxIsUnlimited",{get:function(){if(this.productClass!==l.ProductClass.PLAN)return!1;if(this.productFamily===l.ProductFamily.TEAM)switch(this.productType){case l.ProductPlanType.NEW_STANDARD:case l.ProductPlanType.STANDARD_TRIAL:case l.ProductPlanType.SERVER:case l.ProductPlanType.SERVER_TRIAL:return!1}else{if(this.productFamily===l.ProductFamily.ENTERPRISE&&this.productType===l.ProductPlanType.SERVER)return!1;if(this.productFamily===l.ProductFamily.EDUCATION)return!1}return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adminCxIsSpacePackEligible",{get:function(){return this.productClass===l.ProductClass.PLAN&&!(this.adminCxIsUnlimited||this.productFamily===l.ProductFamily.TEAM&&this.productType===l.ProductPlanType.NEW_STANDARD)},enumerable:!0,configurable:!0}),e})();t.CatalogSku=p})),define("modules/clean/payments/skus/catalog_sku_set",["require","exports","modules/clean/payments/skus/catalog_sku","modules/clean/payments/skus/constants"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e){this._skus=e}return e.fromSerializedSkus=function(t){return new e(t.map((function(e){return new r.CatalogSku(e)})))},Object.defineProperty(e.prototype,"sku",{get:function(){if(1!==this._skus.length)throw new Error("Unable to resolve to a single SKU");return this._skus[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skus",{get:function(){return this._skus.slice()},enumerable:!0,configurable:!0}),e.prototype.filter=function(t){return new e(this._skus.filter(t))},e.prototype.withAdminCxId=function(e){return this.filter((function(t){return t.adminCxId===e}))},e.prototype.withCode=function(e){return this.filter((function(t){return t.code===e}))},e.prototype.withFamily=function(e){return this.filter((function(t){return t.productFamily===e}))},e.prototype.withClass=function(e){return this.filter((function(t){return t.productClass===e}))},e.prototype.withType=function(e){return this.filter((function(t){return t.productType===e}))},e.prototype.withSchedule=function(e){return this.filter((function(t){return t.schedule===e}))},e.prototype.monthly=function(){return this.withSchedule(n.ProductSchedule.MONTHLY)},e.prototype.yearly=function(){return this.withSchedule(n.ProductSchedule.YEARLY)},e.prototype.peekSkus=function(){if(this._skus.length>0)return this._skus[0]},e.prototype.contains=function(e){for(var t=0;t<this._skus.length;t++)if(this._skus[t].code===e.code)return!0;return!1},e})();t.CatalogSkuSet=o})),define("modules/clean/payments/skus/pricing_data",["require","exports","tslib","modules/clean/payments/cash","modules/clean/payments/skus/constants","modules/clean/payments/skus/sku_content","modules/core/exception","modules/core/i18n"],(function(e,t,r,n,o,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(){}return e.createFromState=function(e,t){var r=e.formData,n=e.pricingState,a=o.ProductPlanType.NEW_STANDARD,i=r.productPlanType.formattedValue||t.productPlanType||a,s=n.discountInfo&&n.discountInfo.discountPercentage;if(0!==n.subChangePlans.plans.length){var u=n.subChangePlans.withProductPlanType(i),c=u.yearly().plans.pop(),m=u.monthly().plans.pop(),h=Math.min(c&&c.nextBillingSummary.totalLicenses,m&&m.nextBillingSummary.totalLicenses);return m&&c?isNaN(h)||h<=0?l.NO_LICENSES:new p(n.subChangePlans,i,s):l.NO_PRODUCT_TYPE}switch(i){case o.ProductPlanType.NEW_STANDARD:return new d(t.orionPlanInfo.standard,s);case o.ProductPlanType.ADVANCED:return new d(t.orionPlanInfo.advanced,s);default:return void l.reportException({cause:l.NO_PRODUCT_TYPE,message:"Unable to calculate pricing data for unsupported product type",extra:{productPlanType:i}})}},e})();t.PricingDataFactory=u;var l=(function(){function e(){}return e.reportException=function(e){var t=e.cause,r=e.message,n=e.extra;i.reportStack(t+": "+r,{tags:["BusinessPaymentPages","PricingData"],severity:i.SEVERITY.CRITICAL,exc_extra:n})},e.NO_DATA_SOURCE="No data source",e.NO_LICENSES="No licenses",e.NO_TRANSITION="No transition",e.NO_PRODUCT_TYPE="No product type",e.INCOMPLETE_DATA_SOURCE="Incomplete data source",e.notifyErrorMessage=s._("We’re having some trouble right now. Please try again later or contact sales."),e.notifyErrorMessagePersonal=s._("We’re having some trouble right now. Please try again later."),e})();t.PricingDataException=l;var c=(function(){function e(e){this.promoDiscountPercentage=e||0}return e.prototype.getTotalYearlyDiscountWithPromoInPercent=function(){var e=this.getMonthlyPerUserPrice(),t=this.getMonthlyPlanData();void 0!==t&&void 0!==t.nextBillingSummary&&t.nextBillingSummary.discountPercentage>0&&(e=e.divide(1-t.nextBillingSummary.discountPercentage/100));var r=this.getYearlyPerUserPrice(),n=e.amount-r.amount;return Math.round(n/e.amount*100)},e.prototype.getYearlyPerUserPrice=function(e){void 0===e&&(e=!1);var t=this.getYearlyPrice(e),r=this.getNumLicenses();return r>0?t.divide(12).divide(r):t},e.prototype.getYearlyPricePerUserPerYear=function(e){void 0===e&&(e=!1);var t=this.getYearlyPrice(e),r=this.getNumLicenses();return r>0?t.divide(r):t},e.prototype.getMonthlyPerUserPrice=function(e){void 0===e&&(e=!1);var t=this.getMonthlyPrice(e),r=this.getNumLicenses();return r>0?t.divide(r):t},e.prototype.getPromoDiscount=function(){return this.promoDiscountPercentage},e.prototype.getYearlySavings=function(){var e=this.getMonthlyPrice(),t=this.getYearlyPrice();return e.multiply(12).subtract(t)},e.prototype.getMonthlyPriceWithoutPromo=function(e){void 0===e&&(e=!1);var t=this.getMonthlyPrice(e),r=this.getMonthlyPlanData();return void 0!==r&&void 0!==r.nextBillingSummary&&r.nextBillingSummary.discountPercentage>0&&(t=t.divide(1-r.nextBillingSummary.discountPercentage/100)),t},e.prototype.getYearlyPriceWithoutPromo=function(e){return void 0===e&&(e=!1),this.getYearlyPrice(e).divide(1-this.promoDiscountPercentage/100)},e.prototype.getYearlySavingsPercentage=function(){var e=this.getMonthlyPerUserPrice(),t=this.getYearlyPerUserPrice(),r=e.amount-t.amount;return Math.round(r/e.amount*100)},e.prototype.getYearlySavingsWithoutPromo=function(){var e=this.getMonthlyPrice(!0),t=this.getMonthlyPlanData();void 0!==t&&void 0!==t.nextBillingSummary&&t.nextBillingSummary.discountPercentage>0&&(e=e.divide(1-t.nextBillingSummary.discountPercentage/100));var r=this.getYearlyPrice(!0).divide(1-this.promoDiscountPercentage/100);return e.multiply(12).subtract(r)},e.prototype.getYearlySavingsWithoutPromoPerUser=function(){var e=this.getYearlySavingsWithoutPromo(),t=this.getNumLicenses();return t>0?e.divide(t):e},e.prototype.getYearlySavingsWithoutPromoPercentage=function(){var e=this.getMonthlyPerUserPrice(),t=this.getMonthlyPlanData();void 0!==t&&void 0!==t.nextBillingSummary&&t.nextBillingSummary.discountPercentage>0&&(e=e.divide(1-t.nextBillingSummary.discountPercentage/100));var r=this.getYearlyPerUserPrice().divide(1-this.promoDiscountPercentage/100),n=e.amount-Math.abs(r.amount);return Math.abs(Math.round(n/e.amount*100))},e})(),p=(function(e){function t(t,r,n){var o=e.call(this,n)||this,a=t.withProductPlanType(r),i=a.yearly().plans.pop(),s=a.monthly().plans.pop();if(o.yearlySubChangePlan=i,o.monthlySubChangePlan=s,o.numLicenses=Math.min(i&&i.nextBillingSummary.totalLicenses,s&&s.nextBillingSummary.totalLicenses),!o.monthlySubChangePlan||!o.yearlySubChangePlan){var u=o.monthlySubChangePlan?"yearly":"monthly";l.reportException({cause:l.NO_TRANSITION,message:"Unable to find a "+u+" subChangePlan in PricingDataOrion",extra:{subChangePlans:t}})}return(isNaN(o.numLicenses)||o.numLicenses<=0)&&l.reportException({cause:l.NO_LICENSES,message:"Number of licenses is 0 in PricingDataOrion",extra:{yearlySubChangePlan:o.yearlySubChangePlan}}),o}return r.__extends(t,e),t.prototype.getPlanDisplayName=function(){var e=this.yearlySubChangePlan||this.monthlySubChangePlan;if(!e)return"";var t=e.finalSubState.plan;return t?t.displayName():""},t.prototype.getPlanDisplaySpace=function(){var e=this.yearlySubChangePlan||this.monthlySubChangePlan;if(!e)return"";var t=e.finalSubState.plan;return t?t.displaySpace():""},t.prototype.getMonthlyPlanData=function(){return this.monthlySubChangePlan},t.prototype.getYearlyPlanData=function(){return this.yearlySubChangePlan},t.prototype.getMinLicensesLimit=function(e){return void 0===e&&(e=3),this.yearlySubChangePlan?this.yearlySubChangePlan.finalSubState.minLicenseLimitForPlan||e:this.monthlySubChangePlan&&this.monthlySubChangePlan.finalSubState.minLicenseLimitForPlan||e},t.prototype.getNumLicenses=function(){return this.numLicenses},t.prototype.getYearlyPrice=function(e){var t;return void 0===e&&(e=!1),this.yearlySubChangePlan?(t=this.yearlySubChangePlan.nextBillingSummary.total,e&&(t=t.subtract(this.yearlySubChangePlan.nextBillingSummary.tax))):t=new n.Cash(0,"USD"),t},t.prototype.getMonthlyPrice=function(e){var t;return void 0===e&&(e=!1),this.monthlySubChangePlan?(t=this.monthlySubChangePlan.nextBillingSummary.total,e&&(t=t.subtract(this.monthlySubChangePlan.nextBillingSummary.tax))):t=new n.Cash(0,"USD"),t},t})(c);t.PricingDataOrion=p;var d=(function(e){function t(t,r){var n=e.call(this,r)||this;return n.planInfo=t,n}return r.__extends(t,e),t.prototype.getPlanDisplayName=function(){return this.planInfo.skuContent.name},t.prototype.getPlanDisplaySpace=function(){return a.SkuContentClient.deserialize(this.planInfo.skuContent).spaceShortFormTb()},t.prototype.getMonthlyPlanData=function(){},t.prototype.getYearlyPlanData=function(){},t.prototype.getMinLicensesLimit=function(e){return void 0===e&&(e=3),this.planInfo.minLicenseCount||e},t.prototype.getNumLicenses=function(){return this.getMinLicensesLimit()},t.disallowTaxCalculations=function(e){e||l.reportException({cause:l.INCOMPLETE_DATA_SOURCE,message:"Cannot calculate price with tax from plan info",extra:{}})},t.prototype.getYearlyPrice=function(e){return void 0===e&&(e=!1),t.disallowTaxCalculations(e),n.Cash.fromObject(this.planInfo.yearlyPrice)},t.prototype.getMonthlyPrice=function(e){return void 0===e&&(e=!1),t.disallowTaxCalculations(e),n.Cash.fromObject(this.planInfo.monthlyPrice)},t})(c);t.PricingDataFromPlan=d})),define("modules/clean/payments/skus/quota_info",["require","exports","modules/core/i18n","modules/clean/display_format","modules/clean/payments/skus/constants"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(){}return e.deserialize=function(t){var r=new e;return r.serializedQuotaInfo=t,r},Object.defineProperty(e.prototype,"extrasQuota",{get:function(){return this.serializedQuotaInfo.extrasQuota},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedExtrasQuota",{get:function(){return n.format_bytes(this.extrasQuota)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"licensesQuota",{get:function(){return this.serializedQuotaInfo.licensesQuota},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedLicenseQuota",{get:function(){return n.format_bytes(this.licensesQuota)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"planQuota",{get:function(){return this.serializedQuotaInfo.planQuota},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedPlanQuota",{get:function(){return n.format_bytes(this.planQuota)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalQuota",{get:function(){return this.serializedQuotaInfo.totalQuota},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedTotalQuota",{get:function(){return n.format_bytes(this.totalQuota)},enumerable:!0,configurable:!0}),e.prototype.getFormattedQuotaByPlanType=function(e){if(e===o.ProductPlanType.STANDARD||e===o.ProductPlanType.TRIAL||e===o.ProductPlanType.ADVANCED||e===o.ProductPlanType.ADVANCED_TRIAL)return r._("As much space as you need");var t=this.formattedTotalQuota;return t?r._("%(space_quota)s of space").format({space_quota:t}):""},e})();t.QuotaInfo=a})),define("modules/clean/payments/skus/subscription_change_plan",["require","exports","tslib","modules/clean/payments/skus/subscription_status","modules/clean/react/payments/transition_view_model"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.deserialize=function(e){return(new t).deserialize(e)},t.prototype.deserialize=function(t){return e.prototype.deserialize.call(this,t),t.tvm&&(this.transitionViewModel=new o.TransitionViewModel(t.tvm)),this},Object.defineProperty(t.prototype,"tvm",{get:function(){return this.transitionViewModel},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return this.tvm&&(t.expectedPriceToken=this.tvm.getExpectedPriceToken()),t},t})(n.SubscriptionStatus);t.SubscriptionChangePlan=a})),define("modules/clean/payments/skus/subscription_change_result",["require","exports","tslib","modules/clean/payments/skus/subscription_status"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.deserialize=function(e){return(new t).deserialize(e)},t})(n.SubscriptionStatus);t.SubscriptionChangeResult=o})),define("modules/clean/payments/skus/subscription_diff",["require","exports","tslib","modules/clean/payments/skus/catalog_sku_set","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_sku_set"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.fromSubscriptionStatus=function(e){var r=e.isOnTrial?e.subState:e.finalSubState;return t.fromSubscriptionState(r)},t.fromSubscriptionState=function(e){return t.fromSubscriptionSkuSet(e)},t.fromSubscriptionSkuSet=function(e){return(new t).fromSubscriptionSkuSet(e)},t.prototype.setPlan=function(e){if(e.productClass!==o.ProductClass.PLAN)throw"Can only set plan skus.";return this.planSku=e,this},t.prototype.setTotalLicenses=function(e){return 1!==this.licenses.skus.length?this.totalLicensesOverride=e:this.setLicenseQuantity(this.licenses.sku,e),this},t.prototype.setLicenseQuantity=function(e,t){if(void 0===t&&(t=1),e.productClass!==o.ProductClass.LICENSE)throw"Can only set license skus.";if(this.totalLicensesOverride=void 0,this.quantityMap[e.code]=t,!this.licenses.contains(e)){var r=this.licenses.skus;r.push(e),this.licenseSkuSet=new n.CatalogSkuSet(r)}return this},t.prototype.setAddonQuantity=function(e,t){if(void 0===t&&(t=1),e.productClass!==o.ProductClass.ADDON)throw"Can only set addon skus.";if(this.quantityMap[e.code]=t,!this.addons.contains(e)){var r=this.addons.skus;r.push(e),this.addonSkuSet=new n.CatalogSkuSet(r)}return this},t.prototype.setBillingScheduleId=function(e){return this.overrideBillingScheduleId=e,this},t.prototype.equals=function(t){return this.overrideBillingScheduleId===t.overrideBillingScheduleId&&e.prototype.equals.call(this,t)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return this.overrideBillingScheduleId&&(t.billingScheduleId=this.overrideBillingScheduleId),t},t})(a.SubscriptionSkuSet);t.SubscriptionDiff=i})),define("modules/clean/payments/skus/subscription_service",["require","exports","modules/clean/ajax_as_promised","modules/core/notify","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/subscription_change_result","modules/core/browser","modules/clean/payments/three_ds_helper"],(function(e,t,r,n,o,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(){var e=this;this.subChangePlanCache={},this.handlePerformTransitionResponse=function(t){if(0===t.indexOf("err:")){var r=t.substr(4);return e.handlePerformTransitionError(r),Promise.reject(r)}var o=JSON.parse(t);return o.errorMessage?(n.Notify.error(o.errorMessage),Promise.reject(o.errorMessage)):o.redirect?(i.redirect(o.redirect),Promise.reject(o.redirect)):Promise.resolve(a.SubscriptionChangeResult.deserialize(o.result))},this.handlePerformTransitionError=function(t){var r=null;try{r=JSON.parse(t)}catch(e){}finally{e.handle3DsMessage&&r&&e.handle3DsMessage(r)}},this.updateThreeDsData=function(t){e.threeDsData=t},this.updateThreeDsMessageHandler=function(t){e.handle3DsMessage=t},this.handlePriceTransitionResponse=function(e){var t=JSON.parse(e);return t.errorMessage?(n.Notify.error(t.errorMessage),Promise.reject(t.errorMessage)):Promise.resolve(o.SubscriptionChangePlan.deserialize(t))}}return e.prototype.performPersonalTransition=function(e){return this.performTransition(e,!0)},e.prototype.performTransition=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var o=r.WebRequest({url:"/payments/ajax_perform_transition",data:{sub_change_plan:JSON.stringify(e),for_personal:t,reapply_scheduled_changes:n,browser_info:s.collectBrowserInfo(),three_ds_data:this.threeDsData}}).then(this.handlePerformTransitionResponse);return this.updateThreeDsData(""),o},e.prototype.priceTransition=function(e,t){return r.WebRequest({url:"/payments/ajax_price_transition",data:{sku_code:e.code,team_id:t}}).then(this.handlePriceTransitionResponse)},e.prototype.validateAndPerformTransition=function(e,t){return void 0===t&&(t=!1),r.WebRequest({url:"/payments/ajax_validate_and_perform_transition",data:{sub_diff:JSON.stringify(e),for_personal:t}}).then(this.handlePerformTransitionResponse)},e.prototype.fetchPriceData=function(e){var t=this;return new Promise((function(n,o){clearTimeout(t.currentPriceTimeout),t.currentPriceTimeout=setTimeout((function(){r.WebRequest({url:"/payments/ajax_transition_view_model",data:e}).then(n,o)}),200)}))},e.prototype.price=function(e,t,r){return this.priceBatch({transition:e},t).then((function(e){return e?e.transition:void 0}))},e.prototype.priceSet=function(e,t,r,n){for(var o={},a=e.length,i=0;i<a;i++)o["subDiff:"+i]=e[i];return this.priceBatch(o,t,r,n).then((function(e){return Object.getOwnPropertyNames(e).reduce((function(t,r){return t.push(e[r]),t}),[])}))},e.prototype.priceBatch=function(e,t,r,n){var a=this,i={},s={};Object.keys(e).forEach((function(n){var o=new l(e[n],t,r).hash();o in a.subChangePlanCache?i[n]=a.subChangePlanCache[o]:s[n]=e[n]}));var u=this.priceRequestToken=Math.random()*Number.MAX_VALUE;return Object.keys(s).length?this.fetchPriceData({requests:JSON.stringify(s),billing_details:t?JSON.stringify(t):"",pricing_options:r?JSON.stringify(r):"",is_pro:n?"true":""}).then((function(e){if(u===a.priceRequestToken){var n=JSON.parse(e);return Object.keys(n).forEach((function(e){var u=new l(s[e],t,r);i[e]=a.subChangePlanCache[u.hash()]=o.SubscriptionChangePlan.deserialize(n[e])})),i}})):Promise.resolve(i)},e.prototype.cancelPriceRequest=function(){this.priceRequestToken=-1,clearTimeout(this.currentPriceTimeout)},e})();t.SubscriptionService=u;var l=(function(){function e(e,t,r){this.request=e,this.billingDetails=t,this.pricingOptions=r}return e.prototype.hash=function(){return JSON.stringify(this)},e})()})),define("modules/clean/payments/skus/subscription_sku_set",["require","exports","modules/clean/payments/skus/billing_schedule","modules/clean/payments/skus/catalog_sku","modules/clean/payments/skus/catalog_sku_set","modules/clean/payments/skus/constants"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){this.licenseSkuSet=new o.CatalogSkuSet([]),this.addonSkuSet=new o.CatalogSkuSet([]),this.quantityMap={}}return e.deserialize=function(t){return(new e).deserialize(t)},e.prototype.deserialize=function(e){var t=this;if(e.billingSchedule&&(this.schedule=r.BillingSchedule.deserialize(e.billingSchedule)),e.planSku&&(this.planSku=new n.CatalogSku(e.planSku)),e.licenseSkus){var a=e.licenseSkus.map((function(e){var r=new n.CatalogSku(e.sku);return t.quantityMap[r.code]=e.quantity,r}));this.licenseSkuSet=new o.CatalogSkuSet(a)}else this.licenseSkuSet=new o.CatalogSkuSet([]);if(e.addonSkus){var i=e.addonSkus.map((function(e){var r=new n.CatalogSku(e.sku);return t.quantityMap[r.code]=e.quantity,r}));this.addonSkuSet=new o.CatalogSkuSet(i)}else this.addonSkuSet=new o.CatalogSkuSet([]);return this},e.prototype.fromSubscriptionSkuSet=function(e){for(var t in this.schedule=e.schedule,this.planSku=e.plan,this.licenseSkuSet=new o.CatalogSkuSet(e.licenses.skus),this.addonSkuSet=new o.CatalogSkuSet(e.addons.skus),e.quantityMap)this.quantityMap[t]=e.quantityMap[t];return this},Object.defineProperty(e.prototype,"allSkus",{get:function(){var e=this.licenses.skus.concat(this.addons.skus);return this.planSku&&e.push(this.planSku),new o.CatalogSkuSet(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"plan",{get:function(){return this.planSku},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"billingSchedule",{get:function(){return this.schedule},enumerable:!0,configurable:!0}),e.prototype.quantityForSkuCode=function(e){var t=this.quantityMap[e];return void 0!==t?t:-1},e.prototype.quantityForEvhAddOn=function(){if(this.addonSkuSet.skus.length<=0)return 0;var e=this.addonSkuSet.withType(a.ProductAddonType.EVH);return void 0===e.peekSkus()&&(e=this.addonSkuSet.withType(a.ProductAddonType.EVH_FREE)),void 0!==e.peekSkus()?this.quantityMap[e.sku.code]:0},e.prototype.quantityForSku=function(e){var t=this.quantityMap[e.code];return void 0!==t?t:-1},Object.defineProperty(e.prototype,"licenses",{get:function(){return this.licenseSkuSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalLicenses",{get:function(){var e=this;return void 0!==this.totalLicensesOverride?this.totalLicensesOverride:this.licenseSkuSet.skus.map((function(t){return e.quantityMap[t.code]})).reduce((function(e,t){return e+t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"addons",{get:function(){return this.addonSkuSet},enumerable:!0,configurable:!0}),e.prototype.equals=function(e){var t=this,r=e.allSkus.skus,n=this.allSkus.skus;return r.length===n.length&&n.every((function(n){return!!r.some((function(e){return e.code===n.code}))&&t.quantityForSku(n)===e.quantityForSku(n)}))},e.prototype.toJSON=function(){var e=void 0;if(void 0===this.totalLicensesOverride){e={};for(var t=0,r=this.licenseSkuSet.skus;t<r.length;t++){e[(i=r[t]).code]=this.quantityMap[i.code]}}for(var n={},o=0,a=this.addonSkuSet.skus;o<a.length;o++){var i;n[(i=a[o]).code]=this.quantityMap[i.code]}return{addonSkus:n,billingScheduleId:this.billingSchedule?this.billingSchedule.id:void 0,licenseSkus:e,planSku:this.planSku?this.planSku.code:void 0,trialDuration:this.trialDuration,totalLicenses:this.totalLicensesOverride}},e})();t.SubscriptionSkuSet=i})),define("modules/clean/payments/skus/subscription_state",["require","exports","tslib","modules/clean/payments/skus/quota_info","modules/clean/payments/skus/sku_content","modules/clean/payments/skus/subscription_sku_set"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.deserialize=function(e){return(new t).deserialize(e)},t.prototype.deserialize=function(t){return e.prototype.deserialize.call(this,t),this._minLicenseLimitForPlan=t.minLicenseLimitForPlan,this._maxSelfServiceLicenseLimitForPlan=t.maxSelfServiceLicenseLimitForPlan,this._formattedNextBillingDate=t.formattedNextBillingDate,this._isDeactivatedTeam=t.isDeactivatedTeam,t.quotaInfo&&(this.quotaInfo=n.QuotaInfo.deserialize(t.quotaInfo)),t.content&&(this.content=o.SubStateContentClient.deserialize(t.content)),this},Object.defineProperty(t.prototype,"minLicenseLimitForPlan",{get:function(){return this._minLicenseLimitForPlan},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxSelfServiceLicenseLimitForPlan",{get:function(){return this._maxSelfServiceLicenseLimitForPlan},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formattedNextBillingDate",{get:function(){return this._formattedNextBillingDate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quota",{get:function(){return this.quotaInfo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDeactivatedTeam",{get:function(){return this._isDeactivatedTeam},enumerable:!0,configurable:!0}),t.prototype.equals=function(t){return!!e.prototype.equals.call(this,t)&&this.formattedNextBillingDate===t.formattedNextBillingDate},t})(a.SubscriptionSkuSet);t.SubscriptionState=i})),define("modules/clean/payments/skus/subscription_status",["require","exports","modules/clean/payments/skus/subscription_state","modules/clean/payments/skus/billing_summary","modules/clean/payments/skus/constants"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(){}return e.deserialize=function(t){return(new e).deserialize(t)},e.prototype.deserialize=function(e){return e.currentBillingSummary&&(this._currentBillingSummary=n.BillingSummary.deserialize(e.currentBillingSummary)),e.nextBillingSummary&&(this._nextBillingSummary=n.BillingSummary.deserialize(e.nextBillingSummary)),this._subState=r.SubscriptionState.deserialize(e.subState),e.scheduledSubState&&(this._scheduledSubState=r.SubscriptionState.deserialize(e.scheduledSubState)),this},Object.defineProperty(e.prototype,"subState",{get:function(){return this._subState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scheduledSubState",{get:function(){return this._scheduledSubState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"finalSubState",{get:function(){return this.scheduledSubState?this.scheduledSubState:this.subState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOnTrial",{get:function(){return!!this.subState.plan&&this.subState.plan.isTrialPlan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedNextBillingDate",{get:function(){return this.subState.formattedNextBillingDate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vacuumingPolicyMaxDays",{get:function(){return this.subState.content?this.subState.content.vacuumingPolicyMaxDays():o.VacuumingPolicyMaxDays.VACUUMING_DEFAULT},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentBillingSummary",{get:function(){return this._currentBillingSummary},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextBillingSummary",{get:function(){return this._nextBillingSummary},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{scheduledSubState:this.scheduledSubState,subState:this.subState}},e})();t.SubscriptionStatus=a})),define("modules/clean/payments/validation",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={AT:{prefix:"AT",regex:/^ATU[0-9]{8}$/,examples:["ATU12345678"],maxLength:11},BE:{prefix:"BE",regex:/^BE(0?|1)[0-9]{9}$/,examples:["BE0123456789","BE1123456789","BE1234567890"],maxLength:12},BG:{prefix:"BG",regex:/^BG[0-9]{9,10}$/,examples:["BG123456789","BG1234567890"],maxLength:12},CH:{prefix:"CH",regex:/^CHE[0-9]{9}(TVA|MWST|IVA)$/,examples:["CHE123456789TVA","CHE123456789MWST","CHE123456789IVA"],maxLength:16},CY:{prefix:"CY",regex:/^CY[0-9]{8}[A-Z]$/,examples:["CY12345678X"],maxLength:11},CZ:{prefix:"CZ",regex:/^CZ[0-9]{8,10}$/,examples:["CZ12345678","CZ123456789","CZ1234567890"],maxLength:12},DE:{prefix:"DE",regex:/^DE[0-9]{9}$/,examples:["DE123456789"],maxLength:11},DK:{prefix:"DK",regex:/^DK[0-9]{8}$/,examples:["DK12345678"],maxLength:10},EE:{prefix:"EE",regex:/^EE[0-9]{9}$/,examples:["EE123456789"],maxLength:11},GR:{prefix:"EL",regex:/^EL[0-9]{9}$/,examples:["EL123456789"],maxLength:11},ES:{prefix:"ES",regex:/^ES([A-Z][0-9]{7}[0-9A-Z]|[0-9A-Z][0-9]{7}[A-Z])$/,examples:["ESX12345678","ES12345678X","ESX1234567X"],maxLength:11},FI:{prefix:"FI",regex:/^FI[0-9]{8}$/,examples:["FI12345678"],maxLength:10},FR:{prefix:"FR",regex:/^FR[0-9A-Z]{2}[0-9]{9}$/,examples:["FR12345678901","FRX1234567890","FR1X123456789","FRXX123456789"],maxLength:13},GB:{prefix:"GB",regex:/^GB([0-9]{9}|[0-9]{12}|GD[0-9]{3}|HA[0-9]{3})$/,examples:["GB123456789","GB123456789012","GBGD123","GBHA123"],maxLength:14},HR:{prefix:"HR",regex:/^HR[0-9]{11}$/,examples:["HR12345678901"],maxLength:13},HU:{prefix:"HU",regex:/^HU[0-9]{8}$/,examples:["HU12345678"],maxLength:10},IE:{prefix:"IE",regex:/^IE([0-9][0-9A-Z+*][0-9]{5}[A-Z]{1,2}|[0-9]{7}WI)$/,examples:["IE1X23456X","IE1234567XX"],maxLength:11},IT:{prefix:"IT",regex:/^IT[0-9]{11}$/,examples:["IT12345678901"],maxLength:13},LT:{prefix:"LT",regex:/^LT([0-9]{9}|[0-9]{12})$/,examples:["LT123456789","LT123456789012"],maxLength:14},LU:{prefix:"LU",regex:/^LU[0-9]{8}$/,examples:["LU12345678"],maxLength:10},LV:{prefix:"LV",regex:/^LV[0-9]{11}$/,examples:["LV12345678901"],maxLength:13},MT:{prefix:"MT",regex:/^MT[0-9]{8}$/,examples:["MT12345678"],maxLength:10},NL:{prefix:"NL",regex:/^NL[0-9]{9}B[0-9]{2}$/,examples:["NL123456789B01"],maxLength:14},NO:{prefix:"NO",regex:/^NO[0-9]{9}(MVA)?$/,examples:["NO123456789","NO123456789MVA"],maxLength:14},PL:{prefix:"PL",regex:/^PL[0-9]{10}$/,examples:["PL1234567890"],maxLength:12},PT:{prefix:"PT",regex:/^PT[0-9]{9}$/,examples:["PT123456789"],maxLength:11},RO:{prefix:"RO",regex:/^RO[0-9]{2,10}$/,examples:["RO12","RO1234567890"],maxLength:12},SE:{prefix:"SE",regex:/^SE[0-9]{12}$/,examples:["SE123456789012"],maxLength:14},SI:{prefix:"SI",regex:/^SI[0-9]{8}$/,examples:["SI12345678"],maxLength:10},SK:{prefix:"SK",regex:/^SK[0-9]{10}$/,examples:["SK1234567890"],maxLength:12}};t.validateCpf=function(e){if(14===e.length)return!0;if(11!==e.length)return!1;for(var t=0,r=0;r<9;r++)t+=parseInt(e.charAt(r),10)*(10-r);var n=t%11;if((t=n<2?0:11-n)!==parseInt(e.charAt(9),10))return!1;var o=0;for(r=0;r<10;r++)o+=parseInt(e.charAt(r),10)*(11-r);return(o=(n=o%11)<2?0:11-n)===parseInt(e.charAt(10),10)},t.hasVat=function(e){return!!r[e]},t.validateVat=function(e,t){return!t.trim().length||(t=t.replace(/\s+/g,""),!!r[e]&&r[e].regex.test(t))},t.getVatPrefix=function(e){return r[e]?r[e].prefix:""},t.getVatExamples=function(e){return r[e]?r[e].examples:[]},t.getVatMaxLength=function(e){return r[e]?r[e].maxLength:0},t.validIBANForCountry=function(e){if((e=e.replace(/\s+/g,"")).length<2)return!1;switch(e.substring(0,2)){case"AT":return/^AT[0-9]{18}$/.test(e);case"BE":return/^BE[0-9]{14}$/.test(e);case"CY":return/^CY[0-9]{10}[0-9a-zA-Z]{16}$/.test(e);case"CZ":return/^CZ[0-9]{22}$/.test(e);case"DE":return/^DE[0-9]{20}$/.test(e);case"EE":return/^EE[0-9]{18}$/.test(e);case"ES":return/^ES[0-9]{22}$/.test(e);case"FI":return/^FI[0-9]{16}$/.test(e);case"FR":return/^FR[0-9]{12}[0-9a-zA-Z]{11}[0-9]{2}$/.test(e);case"GR":return/^GR[0-9]{9}[0-9a-zA-Z]{16}$/.test(e);case"HU":return/^HU[0-9]{26}$/.test(e);case"HR":return/^HR[0-9]{19}$/.test(e);case"IE":return/^IE[0-9]{2}[0-9a-zA-Z]{4}[0-9]{14}$/.test(e);case"IT":return/^IT[0-9]{2}[A-Z]{1}[0-9]{10}[0-9a-zA-Z]{12}$/.test(e);case"LU":return/^LU[0-9]{5}[0-9a-zA-Z]{13}$/.test(e);case"NL":return/^NL[0-9]{2}[A-Z]{4}[0-9]{10}$/.test(e);case"PL":return/^PL[0-9]{26}$/.test(e);case"PT":return/^PT[0-9]{23}$/.test(e);case"SE":return/^SE[0-9]{22}$/.test(e)}return!1}})),define("modules/clean/react/payments/business/state/business_state",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldsToServerProps={accountHolderName:"owner_name",adyenEncryptedCard:"adyen_encrypted_card",encryptedCardForNetworkToken:"encrypted_card_for_network_token",bin:"bin",browserInfo:"browser_info",threeDsData:"three_ds_data",captcha:"recaptcha_response",companySize:"company_size",countryCode:"country_code",cpf:"cpf",cpfName:"cpf_name",email:"email",emailsToInvite:"emails_to_invite",firstName:"fname",iban:"iban",idealBankId:"bank_id",idealBankName:"bank_name",lastName:"lname",mandateSigned:"mandate_signed",nonce:"nonce",numberOfUsers:"team_num_users",password:"password",paymentMethod:"payment_method",schedule:"schedule_id",scheduleId:"schedule_id",selectedUser:"selected_user",teamName:"team_name",teamPhone:"team_phone",termsAndService:"tos_agree",vat:"vat",zipCode:"zip",city:"city",phone:"phone",name:"name",address:"address"},t.serverPropsToFields={};for(var r=0,n=Object.keys(t.fieldsToServerProps);r<n.length;r++){var o=n[r],a=t.fieldsToServerProps[o];a&&(t.serverPropsToFields[a]=o)}t.TEAM_RESTORE_STEP=-1,t.SKU_SELECTION_STEP=0,t.ACCOUNT_INFO_OR_CHECKOUT_STEP=1,t.PLAN_SELECTION_STEP=2,t.PAYMENT_INFO_STEP=3,t.TryFormSteps=function(){return{skuSelectionStep:t.SKU_SELECTION_STEP,accountInfoStep:t.ACCOUNT_INFO_OR_CHECKOUT_STEP,planSelectionStep:t.PLAN_SELECTION_STEP,paymentInfoStep:t.PAYMENT_INFO_STEP}},t.BuyFormSteps=function(){return{skuSelectionStep:t.SKU_SELECTION_STEP,checkoutStep:t.ACCOUNT_INFO_OR_CHECKOUT_STEP}},t.BillingFormSteps=function(){return{teamRestoreStep:t.TEAM_RESTORE_STEP,skuSelectionStep:t.SKU_SELECTION_STEP,checkoutStep:t.ACCOUNT_INFO_OR_CHECKOUT_STEP}}})),define("modules/clean/react/payments/buy/components/inputs/inputs",["require","exports","tslib","react","react-dom","classnames"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importDefault(o),a=r.__importDefault(a);var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=a.default({input__label:!0,"input__label--before":Boolean(!this.props.labelAfterElement)},this.props.className),t=this.props.containerClassName,r=n.default.createElement("label",{className:e,htmlFor:this.props.htmlFor},this.props.labelText),o=null;this.props.labelAfterElement&&(o=r,r=null);var i,s=null;return this.props.secondaryLabel&&(s=n.default.createElement("label",{className:"input__label input__label--secondary",htmlFor:this.props.htmlFor},this.props.secondaryLabel)),this.props.errorText&&(i=n.default.createElement("label",{className:"input__label--error",htmlFor:this.props.htmlFor},this.props.errorText)),n.default.createElement("div",{className:t},r,this.props.children,o,s,i)},t})(n.default.Component);t.LabeledInput=i;var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(o.default.findDOMNode(t.input))},t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(o.default.findDOMNode(t.input))},t.onFocus=function(e){t.props.onFocus&&t.props.onFocus(t.input)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=o.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,o=t.autocomplete,s=t.className,u=t.disabled,l=t.labelText,c=t.secondaryLabel,p=t.errorText,d=t.hasError,m=t.value,h=t.maxLength,f=t.containerClassName,_=t.placeholder,y=this.props.type||"text",g=a.default({input__text:!0,"input__text--error":Boolean(p)||d},this.props.inputClassName);return n.default.createElement(i,{className:s,containerClassName:f,labelText:l,htmlFor:r,errorText:p,secondaryLabel:c},n.default.createElement("input",{autoComplete:o,className:g,type:y,placeholder:_,name:r,id:r,ref:function(t){e.input=t},value:m,disabled:u,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,maxLength:h}))},t})(n.default.Component);t.LabeledTextInput=s;var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCheckboxChange=function(e){t.props.onClick&&("click"!==e.type&&"Enter"!==e.key&&13!==e.charCode&&" "!==e.key&&32!==e.charCode||(t.props.onClick(o.default.findDOMNode(t.input)),e.preventDefault()))},t.onBlur=function(){t.props.onBlur&&t.props.onBlur(o.default.findDOMNode(t.input))},t.preventSpacebarScrolling=function(e){" "!==e.key&&32!==e.charCode||e.preventDefault()},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onClick){var e=o.default.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onClick(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,o=t.className,s=t.containerClassName,u=t.disabled,l=t.labelText,c=t.labelClassName,p=t.errorText,d=t.checked,m=a.default({input__checkbox:!0,"input__checkbox--valid":d,"input__checkbox--disabled":Boolean(u)},o);return n.default.createElement(i,{containerClassName:s,className:c,errorText:p,htmlFor:r,labelAfterElement:!0,labelText:l},n.default.createElement("div",{"aria-checked":d,"aria-labelledby":r,tabIndex:0,role:"checkbox",className:m,onClick:this.handleCheckboxChange,onKeyDown:this.preventSpacebarScrolling,onKeyUp:this.handleCheckboxChange,onBlur:this.onBlur}),n.default.createElement("input",{"aria-hidden":!0,tabIndex:-1,checked:d,disabled:u,id:r,name:r,ref:function(t){e.input=t},type:"checkbox"}))},t})(n.default.Component);t.LabeledCheckboxInput=u;var l=(function(e){function t(t){var r=e.call(this,t)||this;return r.focus=function(){null!==r.radio.current&&r.radio.current.focus()},r.handleClick=function(e){r.props.disabled?e.stopPropagation():r.focus()},r.handleRadioChange=function(e){r.props.disabled?e.stopPropagation():r.props.onClickOrChange&&(r.props.onClickOrChange(e,r.props.inputId,r.props.value),e.preventDefault())},r.handleRadioKeyUp=function(e){if(r.props.disabled)e.stopPropagation();else{(["Tab","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(e.key)||[9,37,38,39,40].includes(e.keyCode))&&r.props.onClickOrChange&&(e.preventDefault(),r.focus(),r.props.onClickOrChange(e,r.props.inputId,r.props.value))}},r.radio=n.default.createRef(),r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.name,r=e.inputId,o=e.ariaLabelId,i=e.disabled,s=e.value,u=e.checked,l=e.labelSpan,c=e.labelClassName,p=a.default({input__radio:!0,"input__radio--valid":Boolean(u),"input__radio--disabled":Boolean(i)},this.props.className),d=u?0:-1;return n.default.createElement("label",{htmlFor:s,className:c},n.default.createElement("span",{className:p,onClick:this.handleClick},n.default.createElement("input",{"aria-labelledby":o,ref:this.radio,type:"radio",name:t,id:r,value:s,tabIndex:d,"aria-checked":Boolean(u),checked:Boolean(u),onChange:this.handleRadioChange,onKeyUp:this.handleRadioKeyUp,disabled:i}),l))},t})(n.default.Component);t.LabeledRadioInput=l;var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(o.default.findDOMNode(t.input))},t.onBlur=function(){t.props.onBlur&&t.props.onBlur(o.default.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=o.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,o=t.className,s=t.containerClassName,u=t.hasError,l=t.labelClassName,c=t.labelText,p=t.errorText,d=t.autoComplete,m=a.default({input__select:!0,"input__select--error":Boolean(p)||u},o);return n.default.createElement(i,{containerClassName:s,className:l,errorText:p,htmlFor:r,labelText:c},n.default.createElement("select",{className:m,id:r,name:r,onChange:this.onChange,onBlur:this.onBlur,value:this.props.value,autoComplete:d,ref:function(t){e.input=t}},this.props.children))},t})(n.default.Component);t.LabeledSelectInput=c;var p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement("div",{className:this.props.className},this.props.children,this.props.errors&&this.props.errors.map((function(e,t){return n.default.createElement("div",{className:e.className,key:e.name+"-"+t},n.default.createElement("label",{className:"input__label--error",htmlFor:e.name},e.text))})))},t})(n.default.Component);t.LabeledInputRow=p})),define("modules/clean/react/payments/checkout/components/inputs/labeled_checkbox_input",["require","exports","tslib","react","react-dom","modules/clean/react/payments/checkout/components/inputs/labeled_input"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importStar(o);var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(){t.props.onBlur&&t.props.onBlur(o.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(o.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=o.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,o=t.className,i=t.labelText,s=t.errorText,u=t.errorHTML,l=t.checked,c=t.disabled;return n.default.createElement(a.LabeledInput,{className:o,errorHTML:u,errorText:s,htmlFor:r,labelAfterElement:!0,labelText:i},n.default.createElement("input",{checked:l,disabled:c,id:r,name:r,onChange:this.onChange.bind(this),onBlur:this.onBlur,ref:function(t){e.input=t},type:"checkbox"}))},t})(n.default.Component);t.LabeledCheckboxInput=i})),define("modules/clean/react/payments/checkout/components/inputs/labeled_input",["require","exports","tslib","classnames","purify","react"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importStar(o);var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=n.default({"input__label--errormodal":Boolean(this.props.errorText)},this.props.className,"label-input","input__label"),t=a.default.createElement("label",{className:"label "+(this.props.labelClass?this.props.labelClass:""),htmlFor:this.props.htmlFor},this.props.labelText),r=null;this.props.labelAfterElement&&(r=t,t=null);var i=null;i=this.props.rightLabelElement?a.default.createElement("div",{className:"grid__item grid--x-bookend"},t,a.default.createElement("div",null,this.props.rightLabelElement)):t;var s=null;this.props.errorText?s=this.props.errorText:this.props.errorHTML&&(s=a.default.createElement("span",{dangerouslySetInnerHTML:{__html:o.sanitize(this.props.errorHTML)}}));var u=a.default.createElement("label",{className:"error-message",htmlFor:this.props.htmlFor},s);return a.default.createElement("div",{className:e},i,this.props.children,r,u)},t})((a=r.__importDefault(a)).default.Component);t.LabeledInput=i})),define("modules/clean/react/payments/checkout/components/inputs/labeled_text_input",["require","exports","tslib","classnames","react","react-dom","modules/clean/react/payments/checkout/components/inputs/labeled_input"],(function(e,t,r,n,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importDefault(o),a=r.__importStar(a);var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(a.findDOMNode(t.input))},t.onFocus=function(e){t.props.onFocus&&t.props.onFocus(a.findDOMNode(t.input))},t.onChange=function(e){t.props.onChange&&t.props.onChange(a.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=a.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.className,a=t.disabled,s=t.errorText,u=t.errorHTML,l=t.labelClass,c=t.labelText,p=t.maxLength,d=t.name,m=t.placeholder,h=t.value,f=t.autoComplete,_=this.props.type||"text",y=n.default({input__text:!0,"input__text--errormodal":Boolean(s)},this.props.inputClassName);return o.default.createElement(i.LabeledInput,{className:r,errorHTML:u,errorText:s,htmlFor:d,labelClass:l,labelText:c},o.default.createElement("input",{autoComplete:f,className:y,type:_,name:d,id:d,ref:function(t){e.input=t},value:null===h?"":h,disabled:a,onBlur:this.onBlur,onChange:this.onChange,onFocus:this.onFocus,maxLength:p,placeholder:m}))},t})(o.default.Component);t.BizLabeledTextInput=s})),define("modules/clean/react/payments/checkout/components/inputs/labeled_select_input",["require","exports","tslib","react","react-dom","modules/clean/react/payments/checkout/components/inputs/labeled_input"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importStar(o);var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(o.findDOMNode(this.input))},t.prototype.onClick=function(e){this.props.onClick&&this.props.onClick(o.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=o.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,o=t.className,i=t.labelClass,s=t.labelText,u=t.rightLabelElement,l=t.errorText,c=t.errorHTML,p=t.autoComplete;return n.default.createElement(a.LabeledInput,{className:o,errorHTML:c,errorText:l,labelClass:i,htmlFor:r,labelText:s,rightLabelElement:u},n.default.createElement("select",{autoComplete:p,className:"option-selector",id:r,name:r,onChange:this.onChange.bind(this),onClick:this.onClick.bind(this),value:this.props.value,ref:function(t){e.input=t}},this.props.children))},t})(n.default.Component);t.BizLabeledSelectInput=i})),define("modules/clean/react/payments/checkout/components/payment_method_form/address_form",["require","exports","tslib","react","modules/core/i18n","modules/clean/analytics","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/react/payments/checkout/components/inputs/labeled_text_input","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/checkout/components/inputs/labeled_select_input","modules/clean/react/payments/common/constants"],(function(e,t,r,n,o,a,i,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCountryCodeChange=function(e){t.props.actions.updateCountryCode(e.value);var r=t.props.showServerViewVersion,n=e.value;a.ProEventsLogger.log("uj-billing-country",{country:n},void 0,r),"BR"===n&&t.props.showCpf&&a.ProEventsLogger.log("uj-cpf-viewed-field",{},void 0,r)},t.onAddressChange=function(e){t.props.actions.updateAddress(e.value)},t.onCityChange=function(e){t.props.actions.updateCity(e.value)},t.onAddressBlur=function(e){"ON"===t.props.paymentFormErrorsExperiment&&t.props.actions.showFormFieldErrors(["address"],"AddressBlur"),t.props.actions.blurAddress(e.value)},t.onCityBlur=function(e){"ON"===t.props.paymentFormErrorsExperiment&&t.props.actions.showFormFieldErrors(["city"],"CityBlur"),t.props.actions.blurCity(e.value)},t.onZipCodeBlur=function(e){"ON"===t.props.paymentFormErrorsExperiment&&t.props.actions.showFormFieldErrors(["zipCode"],"ZipCodeBlur"),t.props.actions.blurZipCode(e.value)},t.onZipCodeChange=function(e){t.props.actions.updateZipCode(e.value)},t}return r.__extends(t,e),t.prototype.renderCountrySelector=function(e){var t=this,r="grid__item--2-3";e?r="grid__item":"ON"===this.props.paymentFormErrorsExperiment&&(r="grid__item--fluid grid__item--margin-right--1-24"),this.props.showServerViewVersion&&(r="grid__item grid__item--3-4");var a=this.props.countryList.map((function(e){var r=e[0],o=e[1];return n.default.createElement("option",{key:"location-"+r,value:r,"aria-selected":r===t.props.formData.countryCode.formattedValue},o)}));return 1==this.props.businessStyling?n.default.createElement(l.BizLabeledSelectInput,{autoComplete:"country",className:r,labelText:o._("Country"),name:"country_code",onChange:this.onCountryCodeChange.bind(this),value:this.props.formData.countryCode.rawValue},a):n.default.createElement(i.LabeledSelectInput,{autoComplete:"country",className:"payment-info__country",containerClassName:r,labelText:o._("Country"),name:"country_code",onChange:this.onCountryCodeChange,value:this.props.formData.countryCode.rawValue},a)},t.prototype.zipCodeErrorString=function(){var e=this.props.formData.zipCode;return!u.FormValueHelper.isValid(e)&&e.showError?"ON"===this.props.paymentFormErrorsExperiment&&"US"===this.props.formData.countryCode.formattedValue?o._("Please enter a valid billing ZIP code."):c.ZipCodeErrorMessage:""},t.prototype.cityErrorString=function(){var e=this.props.formData.city;return this.showPSD2FieldsToUser()&&!u.FormValueHelper.isValid(e)&&e.showError?c.CityErrorMessage:""},t.prototype.addressErrorString=function(){var e=this.props.formData.address;return this.showPSD2FieldsToUser()&&!u.FormValueHelper.isValid(e)&&e.showError?c.AddressErrorMessage:""},t.prototype.renderBillingFields=function(){return!0===this.showPSD2FieldsToUser()?this.renderPSD2AddressFields():!0===this.props.businessStyling?n.default.createElement(n.default.Fragment,null,this.renderCountrySelector(!1),this.renderZipCodeInput()):n.default.createElement(i.LabeledInputRow,{className:"payment-info__location grid__item grid--x-bookend grid--y-top"},this.renderCountrySelector(!1),this.renderZipCodeInput())},t.prototype.renderZipCodeInput=function(e){void 0===e&&(e=!1);var t,r=o._("Postal Code",{comment:"This is the label for the zip code field, and should be kept short."}),a="US"===this.props.formData.countryCode.formattedValue?o._("Billing ZIP"):r,u=!this.props.paymentSpec.allow_zip_code_for_country(this.props.formData.countryCode.formattedValue),l=this.props.formData.zipCode.errorState&&this.props.formData.zipCode.showError;if(!0===this.props.businessStyling)return n.default.createElement(s.BizLabeledTextInput,{autoComplete:"postal-code",className:"billing-zip payment-info__zip grid__item grid__item--7-24",disabled:u,errorText:this.zipCodeErrorString(),errorHTML:this.props.formData.zipCode.serverError,labelText:a,name:"zip",onChange:this.onZipCodeChange.bind(this),value:this.props.formData.zipCode.rawValue,onBlur:this.onZipCodeBlur.bind(this)});var c="grid__item grid__item--7-24";return this.props.showServerViewVersion&&(c="grid__item grid__item--1-4 billing-zip"),"ON"===this.props.paymentFormErrorsExperiment&&(c=e?"grid__item--fluid grid__item--margin-right--1-24":"grid__item--fluid",t=this.zipCodeErrorString()),n.default.createElement(i.LabeledTextInput,{className:"payment-info__zip",containerClassName:c,name:"zip",placeholder:this.props.showServerViewVersion?a:"",autocomplete:"postal-code",labelText:a,value:this.props.formData.zipCode.rawValue,hasError:Boolean(l),disabled:u,onBlur:this.onZipCodeBlur,onChange:this.onZipCodeChange,errorText:t})},t.prototype.renderCityInput=function(){var e,t=o._("City/town",{comment:"This is for the billing address City/Town. Use the name best for locale"}),r=this.props.formData.city.errorState&&this.props.formData.city.showError;if(!0===this.props.businessStyling)return n.default.createElement(s.BizLabeledTextInput,{autoComplete:"address-level2",className:"payment-info__city grid__item--16-24",name:"city",labelText:t,onChange:this.onCityChange.bind(this),value:this.props.formData.city.rawValue,errorText:this.cityErrorString(),errorHTML:this.props.formData.city.serverError,onBlur:this.onCityBlur.bind(this)});var a="grid__item grid__item--16-24";return"ON"===this.props.paymentFormErrorsExperiment&&(a="grid__item--fluid",e=this.cityErrorString()),n.default.createElement(i.LabeledTextInput,{autocomplete:"address-level2",className:"payment-info__city",containerClassName:a,name:"city",labelText:t,onChange:this.onCityChange,hasError:Boolean(r),value:this.props.formData.city.rawValue,onBlur:this.onCityBlur,errorText:e})},t.prototype.renderAddressInput=function(){var e,t=o._("Address",{comment:"Billing Address for Credit Card"}),r=this.props.formData.address.errorState&&this.props.formData.address.showError;return!0===this.props.businessStyling?n.default.createElement(s.BizLabeledTextInput,{autoComplete:"street-address",className:"payment-info__addr grid__item",labelText:t,name:"address",onChange:this.onAddressChange.bind(this),value:this.props.formData.address.rawValue,errorText:this.addressErrorString(),errorHTML:this.props.formData.address.serverError,onBlur:this.onAddressBlur.bind(this)}):("ON"===this.props.paymentFormErrorsExperiment&&(e=this.addressErrorString()),n.default.createElement(i.LabeledTextInput,{autocomplete:"street-address",className:"payment-info__addr",containerClassName:"grid__item",labelText:t,name:"address",onChange:this.onAddressChange,hasError:Boolean(r),value:this.props.formData.address.rawValue,onBlur:this.onAddressBlur,errorText:e}))},t.prototype.showPSD2FieldsToUser=function(){return this.props.paymentSpec.showPSD2FieldsToUser(this.props.formData.paymentMethod.formattedValue,this.props.formData.countryCode.formattedValue,!!this.props.psd2AddressFields)},t.prototype.renderPSD2AddressFields=function(){return!0===this.props.businessStyling?n.default.createElement(n.default.Fragment,null,this.renderCountrySelector(!0),this.renderAddressInput(),this.renderZipCodeInput(!0),this.renderCityInput()):n.default.createElement("span",{className:"grid__item"},n.default.createElement(i.LabeledInputRow,{className:"payment-info__option grid__item grid--x-bookend grid--y-top"},this.renderCountrySelector(!0)),n.default.createElement(i.LabeledInputRow,{className:"payment-info__option grid__item grid--x-bookend grid--y-top"},this.renderAddressInput()),n.default.createElement(i.LabeledInputRow,{className:"payment-info__option grid__item grid--x-bookend grid--y-top"},this.renderZipCodeInput(!0),this.renderCityInput()))},t.prototype.render=function(){return this.renderBillingFields()},t})((n=r.__importDefault(n)).default.Component);t.AddressForms=p})),define("modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame",["require","exports","tslib","jquery","react","react-dom","modules/clean/ajax","classnames","modules/core/exception","modules/core/notify","modules/core/i18n","modules/clean/payments/cvv_hint_container","modules/clean/react/payments/common/form/actions/actions","modules/clean/payments/payment_form/iframe_rpc","modules/clean/payments/three_ds_helper"],(function(e,t,r,n,o,a,i,s,u,l,c,p,d,m,h){"use strict";function f(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),o=r.__importDefault(o),a=r.__importStar(a),i=r.__importStar(i),s=r.__importDefault(s),u=r.__importStar(u);var _=(function(e){function t(t){var o=e.call(this,t)||this;return o.setCvvHintContainerRef=function(e){o.cvvHintContainerRef=e},o.setIframeRef=function(e){o.iframeRef=e},o.submitThreeDsChallenge=function(){o.props.submitForm(d.SubmitFormTriggerType.ThreeDsChallenge)},o.submitThreeDsFingerprint=function(){o.props.submitForm(d.SubmitFormTriggerType.ThreeDsFingerprint)},o.showTooltip=function(e,t){if("cvv"===e){var i=n.default(o.iframeRef).offset(),s=n.default(a.findDOMNode(o.cvvHintContainerRef)).offset(),u=i.left-s.left,l=i.top-s.top,c={left:t.left+u,top:t.top+l,width:t.width,height:t.height};o.setState((function(e){return r.__assign(r.__assign({},e),{cvvHintDimensions:c})})),o.cvvHintContainerRef&&o.cvvHintContainerRef.getWrappedComponent().showTooltip()}},o.hideTooltip=function(e){"cvv"===e&&o.cvvHintContainerRef&&o.cvvHintContainerRef.getWrappedComponent().hideTooltip()},o.handle3DsMessage=function(e){o.threeDsHandler&&o.threeDsHandler.handle3DsMessage(e)},o.iframeReady=!1,o.state={cvvHintDimensions:{left:0,top:0,width:0,height:0},iframeFormHeight:null},o}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.isSeleniumChangesTest())return this.props.actions.updateNonce("fake-valid-nonce",{ccn:{error:!1},ccode:{error:!1},ccexp:{error:!1}}),void this.props.actions.updateBIN("457173");this.braintreeTokenLoaded=f(),this.adyenKeyLoaded=f(),this.iFrameRpcListener=new m.IFrameRpcListener(this.getCCIframeOrigin(),this);var e=frames.cc_iframe.window;this.iframeMessageTransport=new m.IFrameRpcTransport(this.props.iframeUrl,e),this.pingIframe()},t.prototype.componentWillUnmount=function(){this.isSeleniumChangesTest()||this.iFrameRpcListener.removeMessageListener()},t.prototype.componentWillReceiveProps=function(e){var t=this.props.nonce,r=e.nonce;"ON"!==this.props.paymentFormErrorsExperiment?(t.showError||r.showError)&&this.showFormErrors():r.showError&&this.showFormErrors()},t.prototype.render=function(){var e=this.props,t=e.hidden,r=e.iframeUrl,n=s.default({grid__item:!0,hidden:t}),a=s.default("iframe-holder",{"iframe-holder--responsive":this.props.isResponsive,"iframe-holder-desktop":this.props.showServerViewVersion,"iframe-holder--full-width":"ON"===this.props.paymentFormErrorsExperiment}),i={};return this.props.getHeightFromIframe&&(i={height:this.state.iframeFormHeight}),o.default.createElement("div",{id:"iframe-holder",className:n},o.default.createElement(p.CvvHintContainer,{targetDimensions:this.state.cvvHintDimensions,ref:this.setCvvHintContainerRef,showServerViewVersion:this.props.showServerViewVersion}),o.default.createElement("div",{className:a,style:i,ref:this.setIframeRef},o.default.createElement("iframe",{src:r,name:"cc_iframe",frameBorder:"0",title:c._("Form for entering credit card information")})))},t.prototype.isSeleniumChangesTest=function(){return""===this.props.iframeUrl&&!1},t.prototype.getCCIframeOrigin=function(){var e=this.props.iframeUrl.split("/");return e[0]+"//"+e[2]},t.prototype.startServerTimeUpdate=function(){var e=this,t=function(t,r,n){var o=JSON.parse(t);if(o&&o.hasOwnProperty("server_time")){var a={serverTime:o.server_time};e.iframeMessageTransport.sendMessage(m.IFrameRpc.SET_SERVER_TIME,a)}e.startServerTimeUpdate()},r=function(t,r,n){e.startServerTimeUpdate()};setTimeout((function(){i.BackgroundRequest({url:"/credit_card_secrets/server_time",type:"GET",success:t,error:r})}),216e5)},t.prototype.encryptWithAdyen=function(){var e=this;return this.adyenEncrypting?this.adyenEncryptionDeferred.promise:(this.adyenEncrypting=!0,this.adyenEncryptionDeferred=f(),this.isSeleniumChangesTest()?this.submitEncryptedAdyenCard("brisket"):this.adyenKeyLoaded.promise.then((function(t){e.iframeMessageTransport.sendMessage(m.IFrameRpc.ENCRYPT_WITH_ADYEN)})),this.adyenEncryptionDeferred.promise)},t.prototype.encryptForNetworkToken=function(){return this.networkTokenEncrypting?this.networkTokenEncryptionDeferred.promise:(this.networkTokenEncrypting=!0,this.networkTokenEncryptionDeferred=f(),this.isSeleniumChangesTest()?this.submitEncryptedCardForNetworkToken("mastercard","test_for_network_token"):this.iframeMessageTransport.sendMessage(m.IFrameRpc.ENCRYPT_FOR_NETWORK_TOKEN),this.networkTokenEncryptionDeferred.promise)},t.prototype.tokenizeWithBraintree=function(){var e=this;return this.braintreeTokenizing?this.braintreeTokenizingDeferred.promise:(this.braintreeTokenizing=!0,this.braintreeTokenizingDeferred=f(),this.isSeleniumChangesTest()?this.submitTokenized("fake-valid-nonce","457173"):this.braintreeTokenLoaded.promise.then((function(t){e.iframeMessageTransport.sendMessage(m.IFrameRpc.TOKENIZE)})),this.braintreeTokenizingDeferred.promise)},t.prototype.tokenize=function(){return this.encryptWithAdyen(),this.encryptForNetworkToken(),Promise.all([this.tokenizeWithBraintree()]).then((function(e){for(var t=!0,r=0,n=e;r<n.length;r++){var o=n[r];t=t&&o}return t}))},t.prototype.submitTokenized=function(e,t){this.props.actions.updateNonce(e),this.props.actions.updateBIN(t),this.braintreeTokenizing=!1,this.braintreeTokenizingDeferred.resolve(!0)},t.prototype.submitEncryptedAdyenCard=function(e){var t=h.collectBrowserInfo();t&&this.props.actions.updateBrowserInfo(t),this.props.actions.updateAdyenEncryptedCard(e),this.adyenEncrypting=!1,this.adyenEncryptionDeferred.resolve(!0)},t.prototype.submitEncryptedCardForNetworkToken=function(e,t){this.props.actions.updateEncryptedCardForNetworkToken(e,t),this.networkTokenEncrypting=!1,this.networkTokenEncryptionDeferred.resolve(!0)},t.prototype.originReady=function(e){var t=this;this.iframeReady||(this.iframeReady=!0,this.isSeleniumChangesTest()||(this.iframeMessageTransport.sendMessage(m.IFrameRpc.READY),this.iframeMessageTransport.sendMessage(m.IFrameRpc.INIT_NETWORK_TOKEN,{isProd:!0}),this.fetchBraintreeToken().then((function(e){t.iframeMessageTransport.sendMessage(m.IFrameRpc.INIT_BRAINTREE,{token:e}),t.braintreeTokenLoaded.resolve(!0)})).catch((function(){l.Notify.error(c._("Unable to connect to our servers - Refresh page"))})),this.fetchAdyenKey().then((function(e){t.iframeMessageTransport.sendMessage(m.IFrameRpc.INIT_ADYEN,e),t.adyenKeyLoaded.resolve(!0)})).catch((function(){l.Notify.error(c._("Unable to connect to our servers - Refresh page"))})),this.threeDsHandler=new h.ThreeDsHandler({updateThreeDsData:this.props.actions.updateThreeDsData,submitThreeDsChallenge:this.submitThreeDsChallenge,triggerThreeDsChallenge:this.props.actions.triggerThreeDsChallenge,submitThreeDsFingerprint:this.submitThreeDsFingerprint,triggerThreeDsFingerprint:this.props.actions.triggerThreeDsFingerprint,isDesktop:!!this.props.showServerViewVersion,isSeleniumChangesTest:this.isSeleniumChangesTest()})))},t.prototype.fetchAdyenKey=function(e,t){var r=this;void 0===e&&(e=2),void 0===t&&(t=f());return i.BackgroundRequest({url:"/credit_card_secrets/adyen_key",type:"GET",success:function(e,n,o){var a=JSON.parse(e);if(a&&a.hasOwnProperty("key")&&a.hasOwnProperty("server_time")){var i={key:a.key,serverTime:a.server_time};t.resolve(i)}else t.reject(c._("Unable to connect to our servers - Refresh page"));r.startServerTimeUpdate()},error:function(n,o,a){r.tokenErrorHandler(e,r.fetchAdyenKey,t,n,"get adyen key failed:",["fetch_adyen_key_failed"],a)}}),t.promise},t.prototype.fetchBraintreeToken=function(e,t){var r=this;void 0===e&&(e=2),void 0===t&&(t=f());return i.BackgroundRequest({url:"/payments/braintree_token",success:function(e,r,n){try{var o=JSON.parse(e);if(!o||!o.hasOwnProperty("token"))throw new Error("Invalid response from server");t.resolve(o.token)}catch(e){t.reject(c._("Unable to connect to our servers - Refresh page"))}},error:function(n,o,a){r.tokenErrorHandler(e,r.fetchBraintreeToken,t,n,"ajax /braintree_token failed:",["fetch_braintree_token_failed"],a)}}),t.promise},t.prototype.tokenErrorHandler=function(e,t,r,n,o,a,i){if(--e>0)setTimeout((function(){t(e,r)}),2e3);else{var s=o+" "+(JSON.stringify(n.status)+", "+n.statusText+", "+n.readyState);u.reportException({err:new Error(s),severity:u.SEVERITY.CRITICAL,tags:a}),r.reject(i)}},t.prototype.pingIframe=function(){var e=this;this.iframeReady||(this.pingTimeoutLogged||(this.firstPing?(new Date).getTime()-this.firstPing>12e4&&(u.reportException({err:new Error("PCI iFrame timeout"),severity:u.SEVERITY.NONCRITICAL,tags:["iframe_ping_timeout"]}),this.pingTimeoutLogged=!0):this.firstPing=(new Date).getTime()),this.iframeMessageTransport.sendMessage(m.IFrameRpc.READY),setTimeout((function(){e.pingIframe()}),250))},t.prototype.showCvvModal=function(){},t.prototype.showFormErrors=function(){this.isSeleniumChangesTest()||this.iframeMessageTransport.sendMessage(m.IFrameRpc.SHOW_FORM_ERRORS)},t.prototype.focusOutsideIframe=function(){},t.prototype.handleValidationFailure=function(e){this.braintreeTokenizing=!1,this.braintreeTokenizingDeferred.resolve(!1),this.adyenEncrypting=!1,this.adyenEncryptionDeferred.resolve(!1)},t.prototype.handleDataStatusUpdate=function(e){},t.prototype.handleValidationUpdate=function(e){this.props.actions.updateNonce(this.props.nonce.rawValue,e),this.props.actions.updateBIN(this.props.bin.rawValue)},t.prototype.handleSizeUpdate=function(e){this.setState({iframeFormHeight:e})},t.prototype.handleBlurField=function(e){this.props.actions.blurCCField(e)},t.defaultProps={isResponsive:!1},t})(o.default.Component);t.CreditCardFrame=_})),define("modules/clean/payments/three_ds_helper",["require","exports","tslib","modules/core/browser","modules/core/exception"],(function(e,t,r,n,o){"use strict";var a;function i(t,n,o,a){return new Promise((function(i,s){t||a?s():new Promise((function(t,r){e(["adyen-checkout"],t,r)})).then(r.__importStar).then((function(){var e=(function(e,t){var r,n;return e?(r="pub.v2.1115569318761439.aHR0cHM6Ly93d3cuZHJvcGJveC5jb20.0qcdSLg1Z9fkg0jVafTITHpHnWXMLHlN6AJNY32SBmo",n="live"):(r="pub.v2.8215476853122361.aHR0cHM6Ly9tZXRhLWxlaS1kYnguZGV2LmNvcnAuZHJvcGJveC5jb20.OyPyKCNBSA0_6dB5nYI4bOu9O-2egkLII-LayLtGbaI",n="test"),{locale:t,environment:n,originKey:r,paymentMethodsResponse:function(){}}})(n,o),t=new window.AdyenCheckout(e);i(t)})).catch((function(){s()}))}))}function s(e){var t=document.getElementById(e);null!==t&&(t.outerHTML="")}function u(e,t){s("fingerPrintIframe");var r=document.createElement("iframe");return r.setAttribute("id","fingerPrintIframe"),r.setAttribute("src","/threeds2?"+l(!0,t,e)),r.setAttribute("style","display:none"),document.body.appendChild(r),new Promise((function(e){window.addEventListener("message",(function(t){t.data.fingerPrintResult&&(e(t.data.fingerPrintResult),s("fingerPrintIframe"))}))}))}function l(e,t,r){return"isFingerPrint="+e+"&locale="+t+"&threeDsData="+r}function c(e){var t=n.get_href();e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return r&&r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""}function p(e,t,r,n){i(t,r,n,!1).then((function(t){return m(t,e)})).then((function(e){window.parent.postMessage({fingerPrintResult:e},document.origin)}))}function d(e,t,r,n){i(t,r,n,!1).then((function(t){return f(t,e)})).then((function(e){window.parent.postMessage({challengeResult:e},document.origin)}))}function m(e,t){return new Promise((function(r,n){var o=document.createElement("div");o.setAttribute("style","display: none"),o.setAttribute("id","threeDS2"),document.body.appendChild(o),e.create("threeDS2DeviceFingerprint",{fingerprintToken:t,onComplete:function(e){var t=e.data.details["threeds2.fingerprint"];r(t),s("threeDS2")},onError:function(){s("threeDS2"),n()}}).mount("#threeDS2")}))}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),o=r.__importStar(o),(function(e){e.ChallengeShopper="ChallengeShopper",e.IdentifyShopper="IdentifyShopper"})(a=t.ThreeDsResultType||(t.ThreeDsResultType={})),t.LoadAdyenCheckoutApi=i,t.fingerPrintInIframe=u,t.challengeInIframe=function(e,t){s("challengeIframe");var r=document.createElement("iframe");return r.setAttribute("id","challengeIframe"),r.setAttribute("src","/threeds2?"+l(!1,t,e)),document.body.appendChild(r),new Promise((function(e){window.addEventListener("message",(function(t){t.data.challengeResult&&(e(t.data.challengeResult),s("challengeIframe"))}))}))},t.handleHostedPage=function(e,t){("true"===(c("isFingerPrint")||"").toLowerCase()?p:d)(c("threeDsData")||"",t,e,c("locale")||"")},t.fingerPrintViaHostedPage=p,t.challengeViaHostedPage=d,t.fingerPrint3Ds=m;function h(){s("threeDS2Wrapper"),s("threeDS2ChallengeBackground")}function f(e,t){return new Promise((function(r,n){function o(){h(),n()}(function(e){var t=document.createElement("div");t.setAttribute("id","threeDS2ChallengeBackground"),t.setAttribute("style","width: 100%; height: 100%; position: fixed; top: 0px; left: 0px; z-index: 1001;background-color: rgba(0, 0, 0, 0.24);"),t.onclick=e;var r=document.createElement("div");r.setAttribute("id","threeDS2Wrapper"),r.setAttribute("style","position: fixed; bottom: 50%; left: 50%; transform: translateX(-50%) translateY(50%);background-color: white; border: 1px solid #dddfe1; border-radius: 4px; z-index: 1050;padding: 35px 35px 60px 35px;");var n=document.createElement("p");n.setAttribute("style","font-size: 16px; line-height: 24px; color: #717781; margin: 0 0 25px 0;"),n.textContent="To protect your info, please verify your payment.",r.appendChild(n);var o=document.createElement("div");o.setAttribute("id","threeDS2Challenge"),o.setAttribute("style","border: 1px solid #d9d9d9; border-radius: 3px; padding: 10px;"),r.appendChild(o),document.body.appendChild(t),document.body.appendChild(r)})(o),e.create("threeDS2Challenge",{challengeToken:t,onComplete:function(e){var t=e.data.details["threeds2.challengeResult"];h(),r(t)},onError:o,size:"01"}).mount("#threeDS2Challenge")}))}function _(){return window.navigator.language?window.navigator.language:window.navigator.browserLanguage}t.show3DsChallenge=f,t.collectBrowserInfo=function(){if(window){var e=window.screen?window.screen.width:"",t=window.screen?window.screen.height:"",r=window.screen?window.screen.colorDepth:"",n=window.navigator?window.navigator.userAgent:"",o=!!window.navigator&&navigator.javaEnabled(),a="";window.navigator&&(a=_());var i={screenWidth:e,screenHeight:t,colorDepth:r,userAgent:n,timeZoneOffset:(new Date).getTimezoneOffset(),language:a,javaEnabled:o};return JSON.stringify(i)}};var y=function(e){var t=this,r=e.updateThreeDsData,n=e.submitThreeDsChallenge,s=e.triggerThreeDsChallenge,l=e.submitThreeDsFingerprint,c=e.triggerThreeDsFingerprint,p=e.isDesktop,d=e.isSeleniumChangesTest;this.handle3DsMessage=function(e){return e.challengeToken?t.adyenCheckoutApi.then((function(r){f(r,e.challengeToken||"").then((function(r){var n=JSON.stringify({paymentData:e.paymentData,resultType:a.ChallengeShopper,result:r});t.updateThreeDsData(n),t.submitThreeDsChallenge()})),t.triggerThreeDsChallenge()})):e.fingerprintToken?t.adyenCheckoutApi.then((function(r){u(e.fingerprintToken||"",_()).then((function(r){var n=JSON.stringify({paymentData:e.paymentData,resultType:a.IdentifyShopper,result:r});t.updateThreeDsData(n),t.submitThreeDsFingerprint()})),t.triggerThreeDsFingerprint()})):(void 0===e.challengeToken&&void 0===e.fingerprintToken||o.reportException({err:new Error("Both the fingerprintToken and the challengeToken were empty"),severity:o.SEVERITY.CRITICAL,tags:["three_ds_2_message_malformed"]}),null)},this.updateThreeDsData=r,this.submitThreeDsChallenge=n,this.triggerThreeDsChallenge=s,this.submitThreeDsFingerprint=l,this.triggerThreeDsFingerprint=c,this.adyenCheckoutApi=i(d,!0,_(),p)};t.ThreeDsHandler=y})),define("modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form",["require","exports","tslib","react","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/checkout/components/inputs/labeled_text_input","modules/clean/react/payments/checkout/components/inputs/labeled_checkbox_input","modules/core/i18n","modules/clean/react/sprite_div","modules/clean/react/tooltip"],(function(e,t,r,n,o,a,i,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),u=r.__importDefault(u);var c=(l=r.__importStar(l)).Tooltip,p=l.TooltipPosition,d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAccountHolderNameBlur=function(e){"ON"===t.props.paymentFormErrorsExperiment&&t.props.actions.showFormFieldErrors(["accountHolderName"],"AccountHolderNameBlur"),t.props.actions.blurAccountHolderName(e.value)},t.onIBANBlur=function(e){"ON"===t.props.paymentFormErrorsExperiment&&t.props.actions.showFormFieldErrors(["iban"],"IBANBlur"),t.props.actions.blurIBAN(e.value)},t}return r.__extends(t,e),t.prototype.onAccountHolderNameChange=function(e){this.props.actions.updateAccountHolderName(e.value)},t.prototype.onIBANChange=function(e){this.props.actions.updateIBAN(e.value)},t.prototype.onMandateSignedChange=function(e){this.props.actions.updateMandateSigned(e.checked)},t.prototype.onMandateSignedBlur=function(e){"ON"===this.props.paymentFormErrorsExperiment&&this.props.actions.showFormFieldErrors(["mandateSigned"],"MandateSignedBlur")},t.prototype.accountHolderNameErrorString=function(){var e=this.props.formData.accountHolderName;return!o.FormValueHelper.isValid(e)&&e.showError?s._("Please enter the account holder’s name."):""},t.prototype.ibanErrorString=function(){var e=this.props.formData.iban;return!o.FormValueHelper.isValid(e)&&e.showError?s._("Please enter a valid bank account number."):""},t.prototype.mandateSignedErrorString=function(){var e=this.props.formData.mandateSigned;return!o.FormValueHelper.isValid(e)&&e.showError?s._("Please agree to the SEPA mandate terms by clicking on this check box."):""},t.prototype.renderIBANLabel=function(){var e=n.default.createElement(u.default,{group:"web",name:"info"}),t=s._("An International Bank Account Number (IBAN) is a unique identification     code for a bank account. It’s made up of a two-letter country code and up to 30 alphanumeric     characters. Check your bank statements or ask your bank for your IBAN."),r=n.default.createElement(c,{tooltip_classname:"iban-label-tooltip-bubble",position:p.RIGHT,tooltip_contents:t},e);return n.default.createElement("span",{className:"grid__item grid--y-middle"},s._("IBAN"),r)},t.prototype.render=function(){var e=this.props.formData,t=s._("I hereby authorize Dropbox International Unlimited Company,     and its payment service provider, Adyen Client Management, to collect payments from my account     via direct debit. At the same time, I instruct my bank to honor the direct debits drawn on my account.     Notice: Within eight weeks, beginning with the debit date, I am entitled to claim a refund     of the debited amount. In this case the terms and conditions agreed with my bank shall apply.");return n.default.createElement("div",{id:"sepa-direct-debit-form",className:"direct-debit-container"},n.default.createElement("div",{className:"direct-debit-fields"},n.default.createElement(a.BizLabeledTextInput,{name:"owner_name",labelText:s._("Account holder name"),value:e.accountHolderName.rawValue,errorText:this.accountHolderNameErrorString(),errorHTML:e.accountHolderName.serverError,onBlur:this.onAccountHolderNameBlur,onChange:this.onAccountHolderNameChange.bind(this)}),n.default.createElement(a.BizLabeledTextInput,{name:"iban",labelText:this.renderIBANLabel(),value:e.iban.rawValue,errorText:this.ibanErrorString(),errorHTML:e.iban.serverError,onBlur:this.onIBANBlur,onChange:this.onIBANChange.bind(this)})),this.props.locationFields,n.default.createElement(i.LabeledCheckboxInput,{checked:e.mandateSigned.rawValue,className:"billing-mandate-signed",errorHTML:e.mandateSigned.serverError,errorText:this.mandateSignedErrorString(),labelText:t,name:"mandate_signed",onBlur:this.onMandateSignedBlur.bind(this),onChange:this.onMandateSignedChange.bind(this)}))},t})(n.default.Component);t.DirectDebitForm=d})),define("modules/clean/react/payments/checkout/components/payment_method_form/credit_card_purchase_full_name",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/react/payments/checkout/components/inputs/labeled_text_input","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/constants"],(function(e,t,r,n,o,a,i,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onNameChange=function(e){t.props.actions.updateName(e.value)},t.onNameBlur=function(e){"ON"===t.props.paymentFormErrorsExperiment&&t.props.actions.showFormFieldErrors(["name"],"NameBlur"),t.props.actions.blurName(e.value)},t.nameErrorString=function(){var e=t.props.formData.name;return t.showPSD2FieldsToUser()&&!s.FormValueHelper.isValid(e)&&e.showError?u.NameErrorMessage:""},t}return r.__extends(t,e),t.prototype.showPSD2FieldsToUser=function(){return this.props.paymentSpec.showPSD2FieldsToUser(this.props.formData.paymentMethod.formattedValue,this.props.formData.countryCode.formattedValue,!!this.props.psd2AddressFields)},t.prototype.renderPSD2FullNameOnCardInput=function(){if(!1===this.showPSD2FieldsToUser())return null;var e=o._("Name on card");if(this.props.businessStyling)return n.default.createElement(i.BizLabeledTextInput,{autoComplete:"cc-name",className:"payment-info__name grid__item",errorText:this.nameErrorString(),errorHTML:this.props.formData.name.serverError,labelText:e,name:"name",onChange:this.onNameChange.bind(this),value:this.props.formData.name.rawValue,onBlur:this.onNameBlur.bind(this)});var t,r=this.props.formData.name.errorState&&this.props.formData.name.showError;return"ON"===this.props.paymentFormErrorsExperiment&&(t=this.nameErrorString()),n.default.createElement(a.LabeledInputRow,{className:"payment-info__option grid__item grid--x-bookend grid--y-top"},n.default.createElement(a.LabeledTextInput,{autocomplete:"cc-name",className:"payment-info__fullname",containerClassName:"grid__item",labelText:e,value:this.props.formData.name.rawValue,name:"name",hasError:Boolean(r),onChange:this.onNameChange,onBlur:this.onNameBlur,errorText:t}))},t.prototype.render=function(){return this.renderPSD2FullNameOnCardInput()},t})((n=r.__importDefault(n)).default.Component);t.CreditCardPurchaseFullNameIfPsd2=l})),define("modules/clean/react/payments/common/constants",["require","exports","modules/core/i18n"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PricingToggleCookie="pricing-schedule",t.PricingToggleMonthly="monthly",t.PricingToggleAnnual="annual",t.ZipCodeErrorMessage=r._("Please enter a valid postal code."),t.AddressErrorMessage=r._("Please enter a valid address."),t.CityErrorMessage=r._("Please enter a valid city/town."),t.NameErrorMessage=r._("Please enter the card holder name.")})),define("modules/clean/react/payments/common/form_value_factory",["require","exports","tslib","modules/clean/react/payments/common/form_values","modules/clean/payments/validation","modules/clean/datetime"],(function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n);var i=(function(){function e(){}return e.createInput=function(e,t){var r=e&&!!e.trim();return{rawValue:e,formattedValue:e,errorState:r?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!(!r||!t)&&t.showError,serverError:""}},e.createCheckbox=function(e,t){var r=e?n.InputErrorState.Valid:n.InputErrorState.Invalid;return{rawValue:e,formattedValue:e,errorState:r,showError:!(r===n.InputErrorState.Valid||!t)&&t.showError,serverError:""}},e.createProductPlanType=function(e,t,r){var o=!1;return e&&t&&(o=0===t.plans.length||t.withProductPlanType(e).plans.length>0),{rawValue:e,formattedValue:e,errorState:o?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!1,serverError:""}},e.createSchedule=function(e,t){return{rawValue:e,formattedValue:e,errorState:n.InputErrorState.Valid,showError:!1,serverError:""}},e.createTrialEndDate=function(e,t,r){var o="";if(t&&e){var i=t.replace("_","-");o=a.daysAfterToday(e).toLocaleDateString(i,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}return{rawValue:o,formattedValue:o,errorState:n.InputErrorState.Valid,showError:!1,serverError:""}},e.createUserSelection=function(e){return{hasSelection:void 0!==e&&-1!==e,rawValue:e||-1,formattedValue:e||-1,showError:!1,serverError:"",errorState:e?n.InputErrorState.Valid:n.InputErrorState.Invalid}},e.createNumberOfUsers=function(e,t,r,o,a){var i,s,u,l,c=t.minNumUsers,p=t.maxNumUsers,d=e,m=parseInt(d,10),h=!isNaN(m);h?(i=m<o,s=m<c,l=m>p,u=0!==a&&m<a+1,m=Math.min(Math.max(m,o),p)):(i=!1,s=!1,l=!1,u=!1,m=c);var f=h&&!s&&!u&&!l;return{rawValue:d,formattedValue:m,errorState:f?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!(f||!r)&&r.showError,isUnderLicenseLimit:i,isUnderLimit:s,isOverLimit:l,minLicenseLimit:o,minNumUsers:c,maxNumUsers:p,serverError:""}},e.createEmail=function(e,t){var r=e.trim(),o=n.EmailErrorState.Valid;if(r){var a=r.split("@");if(2!==a.length)o=n.EmailErrorState.NoAt;else{var i=a[0],s=a[1],u=new RegExp("^([a-z0-9][a-z0-9\\-]*\\.)+([a-z]+|xn--[a-z0-9\\-]+)$","i");/^[\w!#$%&'*+\-\/=?^`{|}~.]+$/.test(i)?(!s||/^[\x00-\x7f]*$/.test(s)&&!u.test(s))&&(o=n.EmailErrorState.BadDomain):o=n.EmailErrorState.BadUsername}}else o=n.EmailErrorState.Empty;return{rawValue:e,formattedValue:r,errorState:o,showError:o!==n.EmailErrorState.Valid&&!!t&&t.showError,serverError:"",isCapturable:!1}},e.createTeamPhone=function(e,t){var r=n.TeamPhoneErrorState.Valid;return e||(r=n.TeamPhoneErrorState.Empty),{rawValue:e,formattedValue:e,errorState:r,showError:!(r===n.TeamPhoneErrorState.Valid||!t)&&t.showError,serverError:""}},e.createPassword=function(e,t){var r=n.PasswordErrorState.Valid;return e&&e.length<6?r=n.PasswordErrorState.TooShort:e||(r=n.PasswordErrorState.Empty),{rawValue:e,formattedValue:e,errorState:r,showError:!(r===n.PasswordErrorState.Valid||!t)&&t.showError,serverError:""}},e.createPaymentMethod=function(e,t,r,o){return r.available_payment_methods_for_country(t).indexOf(e)<0&&(e=r.default_payment_method_for_country(t)),{rawValue:e,formattedValue:e,errorState:n.InputErrorState.Valid,showError:!1,serverError:""}},e.createCountryCode=function(e,t){var r=e?n.InputErrorState.Valid:n.InputErrorState.Invalid;return{rawValue:e,formattedValue:e,errorState:r,showError:!(r===n.InputErrorState.Valid||!t)&&t.showError,serverError:""}},e.createAddress=function(e,t){var r=e&&!!e.trim()&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:r?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!(r||!t)&&t.showError,serverError:""}},e.createPhone=function(e,t){var r=e&&!!e.trim()&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:r?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!(r||!t)&&t.showError,serverError:""}},e.createCity=function(e,t){var r=e&&!!e.trim()&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:r?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!(r||!t)&&t.showError,serverError:""}},e.createName=function(e,t){var r=e&&e.trim().length>=1;return{rawValue:e,formattedValue:e,errorState:r?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!(r||!t)&&t.showError,serverError:""}},e.createZipCode=function(e,t,r,o){var a=!0,i=/\s+$/gi;if(r.allow_zip_code_for_country(t))if("US"===t){/(^\d{5}$)|(^\d{5}-\d{4}$)/.test(e.replace(i,""))||(a=!1)}else(!e||e.length>15||""===e.trim())&&(a=!1);else e="";var s=a?n.InputErrorState.Valid:n.InputErrorState.Invalid,u=!(a||!o)&&o.showError,l=a?e.replace(i,"").replace(".",""):"";return{rawValue:e,formattedValue:l,errorState:s,showError:u,serverError:""}},e.createVat=function(e,t,r){var a=n.InputErrorState,i=a.Valid,s=a.Invalid,u=e.replace(/\s+/gi,""),l=o.validateVat(t,u)?i:s;return{rawValue:e,formattedValue:u,errorState:l,showError:!(l===i||!r)&&r.showError,serverError:""}},e.createCpf=function(e,t,r){var a,i=n.InputErrorState,s=i.Valid,u=i.Invalid,l=e.replace(/[^\d]+/g,"");return{rawValue:e,formattedValue:l,errorState:a=""===e&&r?s:o.validateCpf(l)?s:u,showError:!(a===s||!t)&&t.showError,serverError:""}},e.createCpfName=function(e,t,r){var o=e&&!!e.trim()||""===e&&r;return{rawValue:e,formattedValue:e,errorState:o?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!(!o||!t)&&t.showError,serverError:"",manuallyEdited:!0}},e.createCpfNamePrefill=function(e,t,r,o,a){var i="",s=(i=r||(e&&t?e+" "+t:e||t))&&!!i.trim()||""===i&&a;return{rawValue:i,formattedValue:i,errorState:s?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!(!s||!o)&&o.showError,serverError:"",manuallyEdited:!1}},e.createNonce=function(e,t,r,o){var a=n.InputErrorState,i=a.Valid,s=a.Invalid,u=!!r&&r.isCCNValid,l=!!r&&r.isCCodeValid,c=!!r&&r.isCCExpValid;t&&(u=t.ccn?!t.ccn.error:u,l=t.ccode?!t.ccode.error:l,c=t?t.ccexp?!t.ccexp.error:t.ccexpyr&&t.ccexpmo?!t.ccexpyr.error&&!t.ccexpmo.error:c:c);var p=e||(r?r.rawValue:""),d=u&&l&&c?i:s,m=!(d===i||!r)&&r.showError;return"ON"===o&&(m=!1),{rawValue:p,formattedValue:p,errorState:d,showError:m,serverError:"",isCCNValid:u,isCCodeValid:l,isCCExpValid:c}},e.createAdyenEncryptedCard=function(e,t){var r=e||(t?t.rawValue:"");return{rawValue:r,formattedValue:r,errorState:n.InputErrorState.Valid,showError:!1,serverError:""}},e.createEncryptedCardForNetworkToken=function(e,t,r){var o=t||(r?r.encryptedCard:""),a=e||(r?r.cardType:"");return{rawValue:{cardType:a,encryptedCard:o},formattedValue:JSON.stringify({cardType:a,encryptedCard:o}),cardType:a,encryptedCard:o,errorState:n.InputErrorState.Valid,showError:!1,serverError:""}},e.createBIN=function(e,t){var r=e||(t?t.rawValue:"");return{rawValue:r,formattedValue:r,errorState:n.InputErrorState.Valid,showError:!1,serverError:""}},e.createBrowserInfo=function(e,t){var r=e||(t?t.rawValue:"");return{rawValue:r,formattedValue:r,errorState:n.InputErrorState.Valid,showError:!1,serverError:""}},e.createThreeDsData=function(e){return{rawValue:e,formattedValue:e,errorState:n.InputErrorState.Valid,showError:!1,serverError:""}},e.createIBAN=function(e,t){var r=n.InputErrorState,a=r.Valid,i=r.Invalid,s=e.replace(/\s+/gi,""),u=o.validIBANForCountry(s)?a:i;return{rawValue:e,formattedValue:s,errorState:u,showError:!(u===a||!t)&&t.showError,serverError:""}},e.createIdealBankId=function(e,t){var r=e?n.InputErrorState.Valid:n.InputErrorState.Invalid;return{rawValue:e,formattedValue:e,errorState:r,showError:!(r===n.InputErrorState.Valid||!t)&&t.showError,serverError:""}},e.createIdealBankName=function(e,t){return{rawValue:e,formattedValue:e,errorState:e?n.InputErrorState.Valid:n.InputErrorState.Invalid,showError:!1,serverError:""}},e.createEmailsToInvite=function(e,t){return{rawValue:e=e||[],formattedValue:JSON.stringify(e),errorState:n.InputErrorState.Valid,showError:!1,serverError:""}},e})();t.FormValueFactory=i})),define("modules/clean/react/payments/common/form_value_helpers",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e.isValid=function(e){return 0===e.errorState},e.hasServerError=function(e){return!!e.serverError}})(t.FormValueHelper||(t.FormValueHelper={}))})),define("modules/clean/react/payments/common/form_values",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.Valid=0]="Valid",e[e.Invalid=1]="Invalid"})(t.InputErrorState||(t.InputErrorState={})),(function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty",e[e.NoAt=2]="NoAt",e[e.BadUsername=3]="BadUsername",e[e.BadDomain=4]="BadDomain",e[e.Taken=5]="Taken"})(t.EmailErrorState||(t.EmailErrorState={})),(function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty",e[e.TooShort=2]="TooShort"})(t.PasswordErrorState||(t.PasswordErrorState={})),(function(e){e[e.Valid=0]="Valid",e[e.Empty=1]="Empty"})(t.TeamPhoneErrorState||(t.TeamPhoneErrorState={}))})),define("modules/clean/react/payments/common/form/actions/actions",["require","exports","tslib","modules/clean/react/payments/common/constants","modules/clean/react/payments/common/pricing/actions/actions","external/lodash","modules/clean/react/payments/common/form_value_helpers","modules/clean/auth/common/recaptcha","modules/clean/payments/skus/constants","modules/clean/react/payments/business/state/business_state","modules/core/cookies","modules/clean/viewer","modules/clean/api_v2/default_user_client","modules/clean/api_v2/noauth_client","modules/core/browser","modules/core/i18n","modules/clean/api_v2/error"],(function(e,t,r,n,o,a,i,s,u,l,c,p,d,m,h,f,_){"use strict";var y;function g(t,n,o,i,u,c,g,E,T){for(var P={},C=0,x=i;C<x.length;C++){var N=x[C],I=o[N];P[l.fieldsToServerProps[N]]=I.formattedValue}a.assignIn(P,u);var w=function(e,r,n){if(t(v(e,u)),e&&e.actions)for(var o=e.actions,a=0,i=Array.from(o);a<i.length;a++){var s=i[a];if(s.length>=3){var l=s[0],c=s[2];switch(l){case"notifyError":"emailTaken"===c&&t({type:"EmailTakenError"})}}}},O=function(e,r,n){var o=null;try{o=JSON.parse(n)}catch(e){}finally{if(t(S(o||n)),g&&o&&g(o),c)s.handle_recaptcha_errors(c,o)&&t({type:"TriggerCaptcha"})}};if(T&&T.useRevenueApi)t(b(E,u)),(function(e,t,r,n){var o=p.Viewer.get_viewer().get_user_by_role("personal"),a=o?new d.DefaultUserApiV2Client(o):new m.NoAuthApiV2Client,i=r.indexOf("nonce")>=0?t.nonce.formattedValue:"",s=r.indexOf("zipCode")>=0?t.zipCode.formattedValue:"",l=r.indexOf("countryCode")>=0?t.countryCode.formattedValue:"",c=r.indexOf("cpfName")>=0?t.cpfName.formattedValue:"",y=r.indexOf("bin")>=0?t.bin.formattedValue:"",g=r.indexOf("vat")>=0?t.vat.formattedValue:"",b=r.indexOf("adyenEncryptedCard")>=0?t.adyenEncryptedCard.formattedValue:"",E=n.revenueApiProductCode,T=n.expectedPriceToken,P=n.webPlusDirect,C=u.request_id,x=u.submit_seq,N=u.schedule_id,I="/enjoy";E.startsWith("PRO-PL")&&P?I="/h":E.startsWith("PRO-PR")&&(I="/professional_onboarding");var w={payment_logging_info:{submit_seq:x,request_id:C,schedule_id:N},plan_sku_code:E,tax_info:{vat_id:g,postal_code:s,country_code:l},payment_method:{new_credit_card_details:{address:"",city:"",state:"",country:"United States",country_code:l,zip_code:s,full_name:c,phone:"",national_id:"",national_id_name:"",credit_bin:y,nonce:i,adyen_encrypted_card:b,device_data:""}},expected_price_token:T};a.ns("storefront_self_serve").rpc("start_plan_for_customer",w,{}).then((function(){e(v()),h.redirect(I)})).catch(_.catchApiError((function(t){var r=f._("There was an error completing payment.");if(t.error){var n=t.error[".tag"];"charge_failure_permanent"===n?r=f._("There was an error completing payment. Please check your payment information and try again."):"charge_failure_contact_bank"===n?r=f._("The payment has been refused. Contact your bank to enable the card for online use and/or re-enter the correct card details again."):"charge_failure_temporary"===n?r=f._("There was an error completing payment. Please retry with another form of payment."):"charge_failure_transient"===n?r=f._("We are performing some maintenance that should be finished shortly. Please try again and sorry for the inconvenience."):"mismatched_price_token"===n&&(r=f._("There was an error completing payment. Please check your payment information and try again."))}e(S({error_message:r}))})))})(t,o,i,T);else{if(c){var k=s.get_recaptcha_responses(c);k["g-recaptcha-response-v3"]&&(P["g-recaptcha-response-v3"]=k["g-recaptcha-response-v3"]),k["g-recaptcha-response"]&&(P["g-recaptcha-response"]=k["g-recaptcha-response"],E=y.RecaptchaV2,t({type:"SubmitCaptcha"}))}t(b(E,u)),new Promise((function(t,r){e(["modules/clean/payments/payments_web_request"],t,r)})).then(r.__importStar).then((function(e){new(0,e.PaymentsWebRequest)({url:n,data:P,success:w,error:O}).request()}))}c&&s.clear_recaptcha_response(c),E!==y.ThreeDsChallenge&&E!==y.ThreeDsFingerprint||t(D(""))}function b(e,t){return void 0===e&&(e=y.ButtonClick),{type:"SubmitFormStart",trigger:e,additionalData:t}}function v(e,t){return{type:"SubmitFormSuccess",data:e,additionalData:t}}function S(e){return{type:"SubmitFormError",data:e}}function E(){return{type:"TriggerCaptcha"}}function T(){return{type:"SubmitCaptcha"}}function P(e,t){return{type:"ShowFormFieldErrors",fieldNames:e,origin:t}}function C(){return{type:"EmailTakenError"}}function x(e,t){return function(r){r(o.prepareToUpdatePrice()),r(N(e)),r(o.updatePrice(t))}}function N(e){return{type:"UpdateNumberOfUsers",value:e}}function I(e){return{type:"UpdateCountryCode",value:e}}function w(e){return{type:"UpdateZipCode",value:e}}function O(e){return{type:"UpdateVat",value:e}}function D(e){return{type:"UpdateThreeDsData",value:e}}function k(e,t){for(var r=0,n=t;r<n.length;r++){var o=e[n[r]];if(!i.FormValueHelper.isValid(o))return!1}return!0}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),o=r.__importStar(o),a=r.__importStar(a),h=r.__importStar(h),(function(e){e.ButtonClick="button_click",e.RecaptchaV2="recaptcha_v2",e.ThreeDsChallenge="three_ds_challenge",e.ThreeDsFingerprint="three_ds_fingerprint"})(y=t.SubmitFormTriggerType||(t.SubmitFormTriggerType={})),t.submitForm=function(e,t,r,n,o,a,i,s){return void 0===n&&(n={}),n.time_on_page_ms=window.performance.now(),function(u,l){k(l().formData,t)?r().then((function(r){r&&g(u,e,l().formData,t,n,o,a,i,s)})):u(P(t,"SubmitForm"))}},t.submitFormData=g,t.submitFormStart=b,t.submitFormSuccess=v,t.submitFormError=S,t.triggerCaptcha=E,t.submitCaptcha=T,t.showFormFieldErrors=P,t.showEmailTakenError=C,t.updateSchedule=function(e){return c.Cookies.create(n.PricingToggleCookie,e===u.ScheduleId.MONTHLY?n.PricingToggleMonthly:n.PricingToggleAnnual,30),{type:"UpdateSchedule",value:e}},t.updateProductPlanType=function(e){var t={type:"UpdateProductPlanType",value:e};return function(e,r){var n=r();e(t),e(N(n.formData.numberOfUsers.rawValue))}},t.updateNumberOfUsers=x,t.updateFirstName=function(e){return{type:"UpdateFirstName",value:e}},t.updateLastName=function(e){return{type:"UpdateLastName",value:e}},t.blurEmail=function(e){return{type:"BlurEmail",value:e}},t.clickGoogleSignup=function(){return{type:"ClickGoogleSignup"}},t.updateEmail=function(e){return{type:"UpdateEmail",value:e}},t.updatePassword=function(e){return{type:"UpdatePassword",value:e}},t.updateTeamName=function(e){return{type:"UpdateTeamName",value:e}},t.updateTeamPhone=function(e){return{type:"UpdateTeamPhone",value:e}},t.updateCompanySize=function(e){return{type:"UpdateCompanySize",value:e}},t.updatePaymentMethod=function(e){return{type:"UpdatePaymentMethod",value:e}},t.updateCountryCodeAndPrice=function(e){return function(t){t(o.prepareToUpdatePrice()),t(I(e)),t(o.updatePrice())}},t.updateCountryCode=I,t.updateZipCodeAndPrice=function(e,t){return function(r){r(o.prepareToUpdatePrice()),r(w(e)),r(o.updatePrice(t))}},t.updateZipCode=w,t.blurZipCode=function(e){return{type:"BlurZipCode",value:e}},t.updateVatAndPrice=function(e,t){return function(r){r(o.prepareToUpdatePrice()),r(O(e)),r(o.updatePrice(t))}},t.updateVat=O,t.blurVat=function(e){return{type:"BlurVat",value:e}},t.updateAddress=function(e){return{type:"UpdateAddress",value:e}},t.blurAddress=function(e){return{type:"BlurAddress",value:e}},t.updateCity=function(e){return{type:"UpdateCity",value:e}},t.blurCity=function(e){return{type:"BlurCity",value:e}},t.updatePhone=function(e){return{type:"UpdatePhone",value:e}},t.blurPhone=function(e){return{type:"BlurPhone",value:e}},t.updateName=function(e){return{type:"UpdateName",value:e}},t.blurName=function(e){return{type:"BlurName",value:e}},t.updateCpf=function(e){return{type:"UpdateCpf",value:e}},t.blurCpf=function(e){return{type:"BlurCpf",value:e}},t.updateCpfName=function(e){return{type:"UpdateCpfName",value:e}},t.updateNonce=function(e,t){return{type:"UpdateNonce",value:e,creditCardIframeFields:t}},t.blurCCField=function(e){return{type:"BlurCCField",creditCardIframeFields:e}},t.updateAdyenEncryptedCard=function(e){return{type:"UpdateAdyenEncryptedCard",value:e}},t.updateEncryptedCardForNetworkToken=function(e,t){return{type:"UpdateEncryptedCardForNetworkToken",cardType:e,encryptedCard:t}},t.updateBrowserInfo=function(e){return{type:"UpdateBrowserInfo",value:e}},t.updateThreeDsData=D,t.triggerThreeDsChallenge=function(){return{type:"TriggerThreeDsChallenge"}},t.triggerThreeDsFingerprint=function(){return{type:"TriggerThreeDsFingerprint"}},t.updateBIN=function(e){return{type:"UpdateBIN",value:e}},t.updateAccountHolderName=function(e){return{type:"UpdateAccountHolderName",value:e}},t.blurAccountHolderName=function(e){return{type:"BlurAccountHolderName",value:e}},t.updateIBAN=function(e){return{type:"UpdateIBAN",value:e}},t.blurIBAN=function(e){return{type:"BlurIBAN",value:e}},t.updateMandateSigned=function(e){return{type:"UpdateMandateSigned",value:e}},t.updateTermsAndService=function(e){return{type:"UpdateTermsAndService",value:e}},t.updateIdealBank=function(e){return{type:"UpdateIdealBank",value:e}},t.updateEmailsToInvite=function(e,t){return function(r){r((function(e){return{type:"UpdateEmailsToInvite",value:e}})(e)),r(x(Math.max(e.length+1,t)+""))}},t.isValidSubmitState=k})),define("modules/clean/react/payments/common/pricing/actions/actions",["require","exports","tslib","external/lodash","modules/core/i18n","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_service","modules/clean/payments/dfb_util","modules/core/notify"],(function(e,t,r,n,o,a,i,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(n=r.__importStar(n)).debounce((function(e,t){e((function(e){return{type:"UpdateRecentLoadEventStatus",recentLoadEventStatus:e}})(t))}),400),c=new i.SubscriptionService,p=n.debounce((function(e,t,r,n,o,i){var s,u={discountPercentage:100*o,discountAllowMonthly:i};if(t.currentPlanSku){var l=new a.SubscriptionDiff;l.setPlan(t.currentPlanSku),l.setTotalLicenses(r),s=[l]}else s=t.subChangePlans.plans.map((function(e){var t=a.SubscriptionDiff.fromSubscriptionStatus(e);return t.setTotalLicenses(r),t}));c.priceSet(s,n,u).then((function(t){h(e,t)})).catch((function(t){e(f(t))}))}),400),d=n.debounce((function(e,t,r,n,a){var i=t().pageState.transition,l=new s.DfBTransitionInfoFetcher([i]),c={total_users:n,country_code:a.countryCode,zip_code:a.zipCode,vat_id:a.vat,renew:!0};l.get((function(t){var r=t[0].transition_view_model;e(y(r))}),c,(function(t){u.Notify.error(o._("There was a problem completing this request.")),e(g(t))}))}),400);function m(){return{type:"UpdateTransitionsStart"}}function h(e,t){e({type:"UpdateTransitionsSuccess",subChangePlans:t}),l(e,!1)}function f(e){return{type:"UpdateTransitionsError",error:e}}function _(){return{type:"UpdateRenewTransitionsStart"}}function y(e){return{type:"UpdateRenewTransitionsSuccess",transition:e}}function g(e){return{type:"UpdateRenewTransitionsError",error:e}}t.prepareToUpdatePrice=function(){return{type:"PrepareToUpdateTransitions"}},t.updatePrice=function(e){return void 0===e&&(e=!1),function(t,r){var n,o=r(),a=o.formData,i=o.pricingState,s=i.discountInfo,u=a.numberOfUsers.formattedValue,l=!0;s&&(n=s.discountRatio,l=s.allowMonthly);var c={countryCode:a.countryCode.formattedValue,zipCode:a.zipCode.formattedValue,vat:a.vat.errorState?"":a.vat.formattedValue};e?(t({type:"UpdateRenewTransitionsStart"}),d(t,r,i,u,c)):(t({type:"UpdateTransitionsStart"}),p(t,i,u,c,n,l))}},t.updateTransitionsStart=m,t.updateTransitionsSuccess=h,t.updateTransitionsError=f,t.updateRenewTransitionsStart=_,t.updateRenewTransitionsSuccess=y,t.updateRenewTransitionsError=g})),define("modules/clean/react/payments/transition_view_model",["require","exports","modules/clean/payments/cash"],(function(e,t,r){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.NONE=-1]="NONE",e[e.VAT=1]="VAT",e[e.LEGACY_VAT_EXCEPTION=2]="LEGACY_VAT_EXCEPTION",e[e.LEGACY_SALES_TAX_EXEMPTION=3]="LEGACY_SALES_TAX_EXEMPTION",e[e.MSP_TOTAL_TAX_EXCEPTION=4]="MSP_TOTAL_TAX_EXCEPTION",e[e.ADMIN_TAX_EXEMPTION=5]="ADMIN_TAX_EXEMPTION"})(n||(n={})),(function(e){e[e.InitialPlan=1]="InitialPlan",e[e.ExtraLicense=7]="ExtraLicense"})(o=t.LineItemType||(t.LineItemType={}));var a=(function(){function e(e,t){this.transition=e,this.taxName=t}return e.prototype.getExpectedPriceToken=function(){return this.transition.expected_price},e.prototype.getScheduleId=function(){return this.transition.state.schedule.id},e.prototype.hasPackrat=function(){return this.transition.prices.evh&&r.Cash.fromObject(this.transition.prices.evh).amount>0},e.prototype.getAddonExpectedPrice=function(){return this.transition.prices.evh.amount},e.prototype.getCurrency=function(){return this.transition.state.currency},e.prototype.getActualPrice=function(){return r.Cash.fromObject(this.transition.prices.actual)},e.prototype.getBilledPrice=function(){return r.Cash.fromObject(this.transition.prices.billed)},e.prototype.getPerLicensePrice=function(e){for(var t=0,n=this.transition.state.per_license_prices;t<n.length;t++){var o=n[t];if(o.license_id===e)return r.Cash.fromObject(o.price)}},e.prototype.getTotalPrice=function(){return r.Cash.fromObject(this.transition.read_only_invoice.total)},e.prototype.getTotalTaxWithheld=function(){return r.Cash.fromObject(this.transition.prices.tax_withheld)},e.prototype.getTotalRecurringPrice=function(){return r.Cash.fromObject(this.transition.state.total_recurring_price)},e.prototype.getTotalNumberOfLicenses=function(){return this.transition.state.allocated_licenses[0].license_count},e.prototype.getUserPrice=function(e){var t=r.Cash.fromObject(this.transition.state.next_license_prices[0].price);return e&&(t=t.multiply(1-e/100)),t},e.prototype._getLineItem=function(e){for(var t=0,r=this.transition.read_only_invoice.line_items;t<r.length;t++){var n=r[t];if(n.line_item_type===e)return n}return null},e.prototype.getLineItemCount=function(e){if(e===o.InitialPlan)return this.transition.state.plan.included_license_counts[0].license_count;var t=this._getLineItem(e);return t?t.quantity:0},e.prototype.getLineItemPrice=function(e){var t=this._getLineItem(e);return t?r.Cash.fromObject(t.line_item_price):new r.Cash(0,this.getCurrency())},e.prototype.getInitialPlanInfo=function(){return{count:this.getLineItemCount(o.InitialPlan),price:this.getLineItemPrice(o.InitialPlan)}},e.prototype.getExtraLicensesInfo=function(){return{count:this.getLineItemCount(o.ExtraLicense),price:this.getLineItemPrice(o.ExtraLicense)}},e.prototype.getTaxPrice=function(){return r.Cash.fromObject(this.transition.prices.tax)},e.prototype.getTaxPercentage=function(){if(!this.transition.read_only_invoice||!this.transition.read_only_invoice.line_items.length)return 0;var e=this.transition.read_only_invoice.line_items[0];return e.state_tax_percentage?parseFloat(e.state_tax_percentage):e.country_tax_percentage?parseFloat(e.country_tax_percentage):0},e.prototype.getWithheldTaxPercentage=function(){if(!this.transition.read_only_invoice||!this.transition.read_only_invoice.line_items.length)return 0;var e=this.transition.read_only_invoice.line_items[0];return e.total_withheld_tax_percentage?parseFloat(e.total_withheld_tax_percentage):0},e.prototype.getTaxCountryCode=function(){return this.transition.read_only_invoice.tax_country_code},e.prototype.getDiscountAmount=function(){return r.Cash.fromObject(this.transition.prices.discount)},e.prototype.getDiscountPercentage=function(){var e=this._getLineItem(o.InitialPlan);return e&&e.discount_percentage?parseFloat(e.discount_percentage):0},Object.defineProperty(e.prototype,"doesTaxApply",{get:function(){return this.transition.does_tax_apply},enumerable:!0,configurable:!0}),e})();t.TransitionViewModel=a})),define("modules/clean/payments/dfb_util",["require","exports","tslib","external/lodash","modules/clean/ajax","modules/clean/payments/validation","modules/clean/payments/cash","modules/core/exception"],(function(e,t,r,n,o,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),o=r.__importStar(o),a=r.__importStar(a);var u=(function(){function e(e,t,r,n,o,a,i){this.plan_ids=e,this.schedule_ids=t,this.license_ids_and_counts=r,this.currencies=n,this.country_code=o,this.zip_code=a,this.vat_id=i,this.renew=!1,this.discount_ratio=0,this.discount_allow_monthly=!1}return e.prototype.set_only_license_count=function(e){var t=Object.keys(this.license_ids_and_counts)[0];this.license_ids_and_counts[t]=e},e.prototype.get_only_license_count=function(){var e=Object.keys(this.license_ids_and_counts)[0];return this.license_ids_and_counts[e]},e.prototype.set_country_code=function(e){this.country_code=e},e.prototype.set_zip_code=function(e){this.zip_code=e},e.prototype.set_currencies=function(e){this.currencies=e},e.prototype.set_renew=function(e){this.renew=e},e.prototype.set_discount_ratio=function(e){this.discount_ratio=e},e.prototype.set_discount_allow_monthly=function(e){this.discount_allow_monthly=e},e.prototype.set_vat_id=function(e){""!==e&&a.validateVat(this.country_code||"",e)?this.vat_id=e:this.vat_id=""},e.prototype.cache_key=function(e){var t;return void 0===e&&(e=!1),this.currencies&&!e&&(t=this.currencies.join(",")),[this.plan_ids.join(","),this.schedule_ids.join(","),this.get_only_license_count(),t,this.country_code,this.zip_code,this.vat_id,this.renew,this.discount_ratio].join(":")},e.prototype.to_json=function(){var e=this.renew?{renew:1}:{};return r.__assign(r.__assign({},e),{plan_ids:JSON.stringify(this.plan_ids),schedule_ids:JSON.stringify(this.schedule_ids),license_ids_and_counts:JSON.stringify(this.license_ids_and_counts),currencies:this.currencies?JSON.stringify(this.currencies):"",country_code:this.country_code,zip_code:this.zip_code,vat_id:this.vat_id,discount_percentage:JSON.stringify(100*this.discount_ratio),discount_allow_monthly:this.discount_allow_monthly})},e.from_transition_view_models=function(t){for(var r,o=[],a=[],i=[],u=null,l=null,c=null,p=0,d=t;p<d.length;p++){var m=d[p],h=void 0;if(o.push(m.state.plan.id),a.push(m.state.schedule.id),i.push(m.state.currency),void 0===r){r={};for(var f=0,_=m.state.allocated_licenses;f<_.length;f++)r[(h=_[f]).license_id]=h.license_count;n.isObject(m.read_only_invoice)&&(u=m.read_only_invoice.tax_country_code||null,l=m.read_only_invoice.tax_exclusion_id||null,c=m.read_only_invoice.tax_zip_code||null)}else{s.assert(m.state.allocated_licenses.length===Object.keys(r).length,"License sets differ");for(var y=0,g=m.state.allocated_licenses;y<g.length;y++)h=g[y],s.assert(r.hasOwnProperty(""+h.license_id),"License sets differ"),s.assert(r[h.license_id]===h.license_count,"License count must match");s.assert(u===(m.read_only_invoice&&m.read_only_invoice.tax_country_code||null),"country code must match"),s.assert(c===(m.read_only_invoice&&m.read_only_invoice.tax_zip_code||null),"zip code must match"),s.assert(l===(m.read_only_invoice&&m.read_only_invoice.tax_exclusion_id||null),"VAT ID must match")}}return new e(n.uniq(o),n.uniq(a),r||{},n.uniq(i),u,c,l)},e})();t.DfbTransitionSpaceParams=u;var l=function(e){if(this.transition_view_model=e,this.transition_view_model.read_only_invoice?this.current_total=i.Cash.fromObject(this.transition_view_model.read_only_invoice.total):this.current_total=new i.Cash(0,this.transition_view_model.state.currency),this.price_token=this.transition_view_model.expected_price,this.transition_view_model.state.per_license_prices.length?this.per_license_price=i.Cash.fromObject(this.transition_view_model.state.per_license_prices[0].price):this.per_license_price=new i.Cash(0,this.transition_view_model.state.currency),this.recurring_total=i.Cash.fromObject(this.transition_view_model.state.total_recurring_price),this.transition_view_model.prices?this.tax=i.Cash.fromObject(this.transition_view_model.prices.tax):this.tax=new i.Cash(0,this.recurring_total.currency),this.transition_view_model.total_recurring_taxes?this.recurring_tax=i.Cash.fromObject(this.transition_view_model.total_recurring_taxes):this.recurring_tax=new i.Cash(0,this.recurring_total.currency),this.recurring_total_tax=this.recurring_total.add(this.recurring_tax),this.tax_percentage=0,this.transition_view_model.read_only_invoice){var t=this.transition_view_model.read_only_invoice.line_items,r=t.length>0?t[0]:void 0;r&&!n.isEmpty(r.country_tax_percentage)?this.tax_percentage=parseFloat(r.country_tax_percentage):r&&!n.isEmpty(r.state_tax_percentage)&&(this.tax_percentage=parseFloat(r.state_tax_percentage))}};t.DfBTransitionInfo=l;var c=(function(){function e(e){var t=this;this.has_inflight_request=function(){return Object.keys(t.transition_view_model_requests).length>0},this.add_to_cache=function(e,r){void 0===r&&(r=!1);var n=u.from_transition_view_models(e).cache_key(r),o=e.map((function(e){return new l(e)}));return t.transition_info_cache[n]=o,o},this.get_transition_info_for=function(e){return t.transition_info_cache.hasOwnProperty(e)?t.transition_info_cache[e]:null},this.default_transition_view_models=e,this.transition_view_model_requests={},this.transition_info_cache={},this.add_to_cache(this.default_transition_view_models)}return e.prototype.get=function(e,t,r){var a=this,i=u.from_transition_view_models(this.default_transition_view_models);t.total_users&&i.set_only_license_count(t.total_users),t.country_code&&i.set_country_code(t.country_code),t.currency&&i.set_currencies([t.currency]),!0===t.remove_currency&&i.set_currencies([]),t.zip_code&&i.set_zip_code(t.zip_code),n.isBoolean(t.renew)&&i.set_renew(t.renew),(t.vat_id||""===t.vat_id)&&i.set_vat_id(t.vat_id),t.discount_ratio&&i.set_discount_ratio(t.discount_ratio),n.isBoolean(t.discount_allow_monthly)&&i.set_discount_allow_monthly(t.discount_allow_monthly);var s=i.cache_key(),l=this.get_transition_info_for(s);if(l)e(l);else if(!this.transition_view_model_requests[s])return this.transition_view_model_requests[s]=!0,o.SilentBackgroundRequest({url:"/business/transition-model",type:"GET",dataType:"json",data:i.to_json(),success:function(r){delete a.transition_view_model_requests[s];var n=a.add_to_cache(r,t.remove_currency);e(n)},error:function(e){n.isFunction(r)&&r(e),delete a.transition_view_model_requests[s]}})},e})();t.DfBTransitionInfoFetcher=c}));
//# sourceMappingURL=pkg-payments-common.min.js-vfltZqsSp.map