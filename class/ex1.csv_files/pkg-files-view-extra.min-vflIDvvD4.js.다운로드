define("modules/clean/react/browse/util",["require","exports","modules/clean/filetypes","modules/clean/react/browse/models","modules/clean/react/browse/sort_helpers","modules/clean/react/files_view/types","modules/core/exception","modules/core/i18n"],(function(e,t,i,r,n,a,o,l){"use strict";function s(e,t){return{isFolder:e.is_dir,value:t,isAlwaysFirst:u(e)}}function u(e){return r.File.isTeamMemberFolder(e)||e.type===i.FileTypes.VAULT_FOLDER}function c(e,t){return e&&t?0:e?-1:t?1:0}Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectedFilesText=function(e,t){var i=e.count(),n=l._("You only have partial access");return i>0?1!==i||r.File.canViewFileMembers(e.first(),t)?l.ungettext("%(count)d item selected","%(count)d items selected",i).format({count:i}):r.File.isNoAccessSharedFolder(e.first())?l._("You don’t have access to this folder"):n:t&&!t.canViewContainingNSMembers?n:""},t.sortFiles=function(e,t,i,u){var d=t.sortField,h=t.sortDirection,m=(function(e,t){switch(e){case a.SortField.FILENAME:case a.SortField.SHARED_WITH:return function(e){return s(e,r.File.getFilename(e))};case a.SortField.MODIFIED:return function(e){return s(e,e.ts)};case a.SortField.CATEGORY:return function(e){return s(e,r.File.getCategoryDescription(e))};case a.SortField.EXTENSION:return function(e){return s(e,r.File.getExtension(e))};case a.SortField.SIZE:return function(e){return s(e,e.is_dir&&t.has(e.fq_path)?t.get(e.fq_path).size:e.bytes)};default:return}})(d,i),f=(function(e,t,i){var r=l.case_insensitive_comparator(!0),o=t===a.SortDirection.ASCENDING?1:-1,s=i?(function(e,t){return function(i,r){var a=i.value,o=i.isAlwaysFirst,l=r.value;return c(o,r.isAlwaysFirst)||n.compare(a,l,e,t)}})(o,r):(function(e,t){return function(i,r){var a=i.isFolder,o=i.value,l=i.isAlwaysFirst,s=r.isFolder,u=r.value,d=c(l,r.isAlwaysFirst);return 0!==d?d:(o||(o=1/0*e),u||(u=1/0*e),a&&s?n.compare(o,u,e,t):a?-e:s?e:n.compare(o,u,e,t))}})(o,r);switch(e){case a.SortField.FILENAME:case a.SortField.SHARED_WITH:case a.SortField.SIZE:return s;case a.SortField.MODIFIED:case a.SortField.CATEGORY:case a.SortField.EXTENSION:return(function(e,t){return function(i,r){var a=i.isFolder,o=i.value,l=i.isAlwaysFirst,s=r.isFolder,u=r.value,d=c(l,r.isAlwaysFirst);return 0!==d?d:a&&s?n.compare(o,u,e,t):a?1:s?-1:""===o?1:""===u?-1:n.compare(o,u,e,t)}})(o,r);default:return}})(d,h,u);return m&&f?e.sortBy(m,f):(o.reportException({err:new Error("sortFiles was called with an unsupported sort field"),tags:["browse_sort_invalid_field"],severity:o.SEVERITY.CRITICAL,exc_extra:{sort_field:d}}),e)},t.shouldShowRewindsUpsell=function(e){return!e.paid&&!e.is_team}})),define("modules/clean/sharing/browse_exports",["require","exports","tslib","modules/clean/sharing/access_level","modules/clean/sharing/async_share_modal_util","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/wizard/async_wizard_modals"],(function(e,t,i,r,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncMountSharedFolder=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];new Promise((function(t,i){e(["modules/clean/sharing/shared_content_link_mount_folder"],t,i)})).then(i.__importStar).then((function(e){e.mountSharedFolder.apply(void 0,t)}))},t.asyncShowCdmNewFolderModal=function(t,r,n,a,o,l,s,u){new Promise((function(t,i){e(["modules/clean/sharing/cdm_new_folder_modal"],t,i)})).then(i.__importStar).then((function(e){e.showCdmNewFolderModal(t,r,n,a,o,l,s,u)}))},t.asyncShowCdmNewFolderViaUploadModal=function(t,n,a,o,l,s){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(u){switch(u.label){case 0:return[4,new Promise((function(t,i){e(["modules/clean/sharing/cdm_new_folder_modal"],t,i)})).then(i.__importStar)];case 1:return u.sent().showCdmNewFolderViaUploadModal(t,n,a,!0,r.ACCESS_LEVEL.WRITER,o,l,s),[2]}}))}))},t.asyncShowMultiFolderPermissionsAtUploadModal=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(t,i){e(["modules/clean/sharing/multifolder_permissions_at_upload/modal"],t,i)})).then(i.__importStar)];case 1:return r.sent().showMultiFolderPermissionsAtUploadModal(t),[2]}}))}))},t.asyncShowAppropriateNewFolderModalForCdmUser=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(t,i){e(["modules/clean/sharing/cdm_new_folder_modal_util"],t,i)})).then(i.__importStar)];case 1:return r.sent().showAppropriateNewFolderModalForCdmUser(t),[2]}}))}))},t.asyncShowShareModal=n.asyncShowShareModal,t.asyncShowNewFolderShareModal=n.asyncShowNewFolderShareModal,t.asyncShowPrefilledShareModal=n.asyncShowPrefilledShareModal,t.makePublicFolderLink=a.makePublicFolderLink,t.shouldUsePublicFolderSharing=a.shouldUsePublicFolderSharing,t.showPublicFolderLinkModal=a.showPublicFolderLinkModal,t.asyncShowShareAFolderWizardModal=o.asyncShowShareAFolderWizardModal})),define("modules/clean/sharing/content_manager",["require","exports","tslib","modules/core/uri","modules/clean/filepath","modules/core/browser"],(function(e,t,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=i.__importStar(a),t.genContentManagerBridgeUri=function(e){var t,i=e.containingFolder,a=e.filenameToSelect;return i=n.normalize(i)||"",a&&(t=[i,a].join("/")),new r.URI({path:"/team/admin/content/home"+i,query:t?{select:t}:void 0})},t.goToContentManagerForPath=function(e){var i=t.genContentManagerBridgeUri(e);a.open_tab(i.toString())}})),define("modules/clean/react/selection",["require","exports","tslib","immutable"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t})((r=i.__importStar(r)).Record({selected:null,anchor:null},"Selection"));t.Selection=n,t.createSelection=function(e,t){return new n({selected:e?r.OrderedSet(e):r.OrderedSet(),anchor:t||(e?e[0]:null)})}}));var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};define("modules/clean/sharing/public_folder/public_folder",["require","exports","modules/core/uri","modules/constants/public_folder_constants"],(function(e,t,i,r){"use strict";function n(e,t){if(e.publicAppToken)return t;if(!e.isPublicFolderEnabled)return null;var i=(e.publicFolderFqPath||"/public").toLowerCase(),r=t.toLowerCase();return r===i?"/":r.startsWith(i+"/")?t.substring(i.length):null}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUsePublicFolderSharing=function(e,t){return null!=n(e,t)},t.makePublicFolderLink=function(e,t,a,o){if(o)return null;var l,s=n(t,a);if(l=r.SHOULD_REDIRECT_URL?"u"+e+".dl.dropboxusercontent.com":"dl.dropboxusercontent.com",null!=s){var u=new i.URI({scheme:"https",authority:l});return t.publicAppToken?(u.setPath("/spa/"+t.publicAppToken+s+"/data"),u.toString()):(u.setPath("/u/"+e+s),u.toString())}return null},t.showPublicFolderLinkModal=function(t){return new Promise((function(i,r){Promise.all([new Promise((function(t,i){e(["react"],t,i)})).then(__importStar),new Promise((function(t,i){e(["modules/clean/react/modal"],t,i)})).then(__importStar),new Promise((function(t,i){e(["modules/clean/sharing/public_folder/modal"],t,i)})).then(__importStar)]).then((function(e){var r=e[0],n=e[1].Modal,a=e[2].CopyPublicLinkModal;n.showInstance(r.createElement(a,{publicLink:t})),i()}))}))}})),define("modules/clean/emoji_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;t.getFirstEmojiFromTitle=function(e){var t=(function(){i||(i=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]\ufe0f?|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g);return i})();t.lastIndex=0;var r=t.exec(e);if(r&&0===r.index){var n=r[0];if("‍"===e[n.length])return"";var a=t.exec(e);return a&&a.index===n.length?"":n||""}return""}})),define("modules/clean/filename_highlights",["require","exports","tslib","classnames","react"],(function(e,t,i,r,n){"use strict";function a(e,t,i,r){if(!t)return[{text:e,isHighlighted:!1}];i||(i=0),r||(r=e.length),t=(function(e,t){if(!t||!t.length)return[];var i=[],r=0;return t.forEach((function(t){var n=t.pos;n>r&&(r=n);var a=e.indexOf(t.string,r);a>=0&&i.push({pos:a,len:t.string.length,string:t.string})})),i})(e,t);for(var n=0,a=0,o=[];n<e.length;){var l=void 0,s=void 0,u=t[a];if(a>=t.length?(s=!1,l=n+e.length):u.pos>n?(s=!1,l=u.pos):(s=!0,l=u.pos+u.len),!(n<i&&l<=i||n>=r&&l>=r)){var c=e.substring(Math.max(n,i),Math.min(l,r));o.push({text:c,isHighlighted:s})}n=l,s&&a++}return o}function o(e,t,i,r){if(i||(i=0),r||(r=e.length),!t||!(function(e,t){var i=t.map((function(e){return e.highlight_str})).join("");return e===i})(e,t))return[{text:e.substring(i,r),isHighlighted:!1}];for(var n=[],a=0,o=0,l=t;o<l.length;o++){var s=l[o],u=e.indexOf(s.highlight_str,a),c=u+s.highlight_str.length;if(a=c,!(u<i&&c<=i||u>=r)){var d=s.highlight_str;u<i&&(d=d.slice(i-u)),r<c&&(d=d.slice(0,-(c-r))),n.push({text:d,isHighlighted:s.is_highlighted})}}return n}function l(e){return n.createElement("span",null,e.map((function(e,t){return n.createElement("span",{className:r.default({highlighted:e.isHighlighted,"is-highlighted":e.isHighlighted}),key:t},e.text)})))}Object.defineProperty(t,"__esModule",{value:!0}),r=i.__importDefault(r),n=i.__importStar(n),t.highlightMatchSections=a,t.highlightMatchReact=function(e,t,i,r){return l(a(e,t,i,r))},t.highlightSectionsFromHighlightSpans=o,t.highlightReactFromHighlightSpans=function(e,t,i,r){return l(o(e,t,i,r))},t.highlightReactFromAllHighlightSpans=function(e){return l(e.map((function(e){return{text:e.highlight_str,isHighlighted:e.is_highlighted}})))}})),define("modules/clean/paper_formatting_utils",["require","exports","tslib","modules/clean/emoji_utils","react","modules/clean/filename_highlights","spectrum/icon_content"],(function(e,t,i,r,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=i.__importStar(r),n=i.__importDefault(n),a=i.__importStar(a),t.getPaperDocTitleParts=function(e,t,l,s){var u=e.title,c=e.highlight_spans,d=e.title_highlights,h=c&&c.length>0,m=r.getFirstEmojiFromTitle(u);if(m)if(u=u.substr(m.length),h){var f={highlight_str:c[0].highlight_str.substr(m.length),is_highlighted:c[0].is_highlighted};c=i.__spreadArrays([f],c.slice(1))}else if(d){var p=m.length/2;d=d.slice().map((function(e){return{pos:e.pos-p,len:e.string.length,string:e.string}}))}return{title:u,highlightedTitle:h?a.highlightReactFromHighlightSpans(u,c):a.highlightMatchReact(u,d),icon:(function(e,t,i,r){return e?n.default.createElement("div",{className:"mc-media-cell-icon brws-file-name-icon-emoji-container"},n.default.createElement(o.IconContent,{name:r?"blank-large":"blank-small",className:t}),n.default.createElement("span",{className:i},e)):n.default.createElement(o.IconContent,{name:r?"paper-large":"paper-small",className:t})})(m,t,l,s)}}})),define("modules/clean/react/maestro/components/checkbox",["require","exports","tslib","react","classnames"],(function(e,t,i,r,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),r=i.__importDefault(r),n=i.__importDefault(n),(function(e){e[e.Checked=0]="Checked",e[e.PartiallyChecked=1]="PartiallyChecked",e[e.Unchecked=2]="Unchecked"})(a=t.CheckboxState||(t.CheckboxState={})),t.Checkbox=function(e){var t=e.checkboxState,i=e.ariaLabel,o=e.onClick,l=e.onMouseDown,s=e.tabIndex,u=n.default({"checkbox-button":!0,"partial-checked":t===a.PartiallyChecked,checked:t===a.Checked});return r.default.createElement("button",{role:"checkbox","aria-checked":t===a.Checked,"aria-label":i,className:u,onClick:o,onMouseDown:l,tabIndex:s})}})),define("modules/clean/react/maestro/components/tile_element",["require","exports","tslib","classnames","react","modules/clean/keycode","modules/clean/paper_formatting_utils","modules/clean/react/files_view/double_click","modules/clean/react/icon/file_folder_icon","modules/clean/react/maestro/components/checkbox","modules/clean/react/maestro/components/tile_grid_logger","modules/clean/user_education/react/user_education_effect","modules/clean/react/icon/lock_badge"],(function(e,t,i,r,n,a,o,l,s,u,c,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=i.__importDefault(r),n=i.__importDefault(n),o=i.__importStar(o);var m=function(){return null};t.TileLabel=function(e){var t=e.ariaLabel,i=e.children,r=e.onClick;if(!i)return null;var a=n.default.createElement("div",{className:"tile-label","aria-hidden":"true"},i);return r?n.default.createElement("a",{onClick:r,tabIndex:-1,"aria-label":t},a):a},t.TilePlaceholder=function(e){var i=e.leftOffset,r=e.tileHeight,a=e.tileWidth,o=e.thumbNode,l=e.labelNode;return n.default.createElement("div",{className:"tile",style:{left:i,height:r,width:a,pointerEvents:"none"}},n.default.createElement("div",{className:"tile__thumb-container",style:{height:a,width:a}},o||n.default.createElement("div",{className:"tile__preview--placeholder"})),n.default.createElement(t.TileLabel,null,l))};var f=(function(e){function f(t){var r=e.call(this,t)||this;return r.thumbRequestId=null,r.animationRequestIds=[],r.handleThumbnailError=function(){var e=r.props,t=e.onThumbnailError,i=e.tileIndex;r.setState({thumbLoaded:!1}),t&&t(i)},r.logTileInteractive=function(){var e=!!r.props.thumbnailUrl,t=r.state.thumbLoaded;if(r.props.onThumbnailLoad){var i=window.requestAnimationFrame((function(){var i=window.requestAnimationFrame((function(){r.props.onThumbnailLoad(r.props.tileIndex,e,t)}));r.animationRequestIds.push(i)}));r.animationRequestIds.push(i)}},r.toggleSelect=function(e){e.preventDefault(),e.stopPropagation(),r.props.handleToggleSelect(e)},r.handleKeyDown=function(e){var t=e.keyCode;e.currentTarget!==e.target||t!==a.KeyCode.SPACE&&t!==a.KeyCode.ENTER||(e.preventDefault(),r.props.onClick(e))},r.state=i.__assign({thumbLoaded:f.isThumbLoaded(t)},r.calcPaperTitleState(t)),r}return i.__extends(f,e),f.prototype.componentDidMount=function(){var e=this;this.props.delayRenderFullTile?this.renderCompleteTileTimeout=setTimeout((function(){e.renderCompleteTileTimeout=0,e.fetchThumbnail(e.props)}),100):this.fetchThumbnail(this.props),this.logTileInteractive()},f.prototype.componentDidUpdate=function(e,t){if(!e.isFocused&&this.props.isFocused){var i=this.refs.tileContainer;i&&i.focus()}},f.prototype.componentWillReceiveProps=function(e){if(e.thumbnailUrl!==this.props.thumbnailUrl&&(this.unbindThumbnailIfNeeded(),this.fetchThumbnail(e)),f.getPaperTitle(this.props)!==f.getPaperTitle(e)){var t=this.calcPaperTitleState(e);this.setState(t)}},f.getPaperTitle=function(e){return e.paper?e.paper.title:null},f.prototype.calcPaperTitleState=function(e){return e.paper?{paperTitleParts:o.getPaperDocTitleParts(e.paper,"brws-file-name-grid-icon","brws-file-name-grid-icon-emoji",!0)}:{}},f.prototype.componentWillUnmount=function(){this.unbindThumbnailIfNeeded(),this.renderCompleteTileTimeout&&clearTimeout(this.renderCompleteTileTimeout),this.animationRequestIds.forEach((function(e){window.cancelAnimationFrame(e)})),this.animationRequestIds=[]},f.prototype.fetchThumbnail=function(e){var t=this,i=e.thumbnailUrl,r=e.thumbStore;if(i){var n=Date.now();this.thumbRequestId=r.bind_url(i,{onSuccess:function(){t.setState({thumbLoaded:!0}),c.InfiniteTileGridLogger.logThumbRTT(Date.now()-n)},onError:function(){t.handleThumbnailError()}})}},f.prototype.unbindThumbnailIfNeeded=function(){var e=this.props.thumbStore;this.thumbRequestId&&(e.unbind_url(this.thumbRequestId),this.thumbRequestId=null),this.setState({thumbLoaded:!1})},f.isThumbLoaded=function(e){var t=e.thumbStore,i=e.thumbnailUrl;return!(!i||!t.get_thumb(i))},f.prototype.renderCheckbox=function(){var e=this.props.isSelected?u.CheckboxState.Checked:u.CheckboxState.Unchecked,t=n.default.createElement(u.Checkbox,{ariaLabel:this.props.checkboxAriaText,checkboxState:e,onClick:this.toggleSelect,tabIndex:this.props.checkboxTabIndex});return 0===this.props.tileIndex&&(t=n.default.createElement(d.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox"},t)),n.default.createElement("div",{key:"tile-select-checkbox",className:"tile-select-checkbox"},t)},f.prototype.renderActionNode=function(){return n.default.createElement("div",{key:"tile-action-node",className:"tile__action-button"},this.props.actionNode)},f.prototype.renderThumbnail=function(){var e=this.props,t=e.thumbnailUrl,i=e.thumbStore,r=e.height,a=e.width,o=e.isSelected;if(this.state.thumbLoaded){var l=i.get_thumb(t);if(l){var s=o?a-24:a,u=r||s;return n.default.createElement(h.LockBadge,{file:this.props.file,variant:"preview-large"},n.default.createElement("img",{className:"tile__preview tile__preview--thumb",draggable:!1,src:l,style:{maxHeight:u,maxWidth:s},onError:this.handleThumbnailError,alt:""}))}}return this.renderFileIcon()},f.prototype.renderFileIcon=function(){var e=this.props,t=e.file;return e.paper?this.state.paperTitleParts.icon:t?n.default.createElement(s.FileOrFolderIcon,i.__assign({className:"tile__preview tile__preview--icon brws-file-name-grid-icon",file:t,variant:"large",showPreview:!1},{"aria-hidden":!0})):n.default.createElement("div",{className:"tile__preview--placeholder"})},f.prototype.render=function(){var e=this,a=this.props,o=a.altText,s=a.file,u=a.height,c=a.href,d=a.isActiveDropTarget,h=a.isAvailableDropTarget,m=a.isDraggable,f=a.isFocused,p=a.isSelectable,g=a.isSelected,_=a.isViewOnly,b=a.labelHeight,T=a.labelNode,v=a.leftOffset,w=a.onClick,S=a.onDoubleClick,y=a.onLabelClick,P=a.onDragEnter,F=a.onDragStart,k=a.overrideTabIndex,C=a.width,E=u||C,x=E+b;if(_)return n.default.createElement(t.TilePlaceholder,{leftOffset:v,tileHeight:x,tileWidth:C,thumbNode:this.renderThumbnail(),labelNode:T});var L={left:v,height:x,width:C},M={height:E,width:C},I={className:r.default("tile",{"tile--is-selected":g,"tile--is-dragover":d,"tile--is-droppable":h&&!d}),"data-filename":s&&s.name,style:L,draggable:m,href:c,onDragEnter:P,onDragStart:F,"aria-label":s&&s.name,role:"gridcell"},N=n.default.createElement("div",{className:"tile__thumb-container",style:M},this.renderThumbnail());return n.default.createElement("div",{role:"row",ref:"tileContainer",className:"tile__container",onKeyDown:this.handleKeyDown,tabIndex:k||f?0:-1,"aria-label":o,"aria-selected":g},n.default.createElement(l.WithDoubleClick,{onClick:w,onDoubleClick:S},(function(r){return n.default.createElement("div",i.__assign({},I,{onClick:r.onClick}),N,p&&e.renderCheckbox(),e.renderActionNode(),n.default.createElement(t.TileLabel,{onClick:y,ariaLabel:s&&s.name},T))})))},f.defaultProps={checkboxAriaText:"",checkboxTabIndex:-1,delayRenderFullTile:!0,handleToggleSelect:m,isFocused:!1,isSelected:!1,isViewOnly:!1,onDragEnter:m,onDragStart:m,onClick:m},f})(n.default.PureComponent);t.TileElement=f})),define("modules/clean/react/maestro/components/tile_grid_logger",["require","exports","modules/clean/js_client_stopwatch","modules/core/browser"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e,t,i,r){var n=this;this.recordTileError=function(e){var t=Math.floor(e/n.numTilesPerPage);n.pagesWithThumbErrors.has(t)||n.pagesWithThumbErrors.add(t)},this.recordTileLoaded=function(e,t,i){if(i){if(n.thumbsLoaded.has(e))return;n.thumbsLoaded.add(e)}else{if(n.iconsLoaded.has(e))return;n.iconsLoaded.add(e)}var r=!1;r=n.numTiles%n.numTilesPerPage==0?e>=n.numTiles-n.numTilesPerPage:e>=n.numTiles-n.numTiles%n.numTilesPerPage;var a=n.numTilesPerPage;if(r){var o=n.numTiles%n.numTilesPerPage;0!==o&&(a=o)}var l=Math.floor(e/n.numTilesPerPage);if(i||!t){var s=n.numTilesFinalizedByPage[l]||0;n.numTilesFinalizedByPage[l]=s+1}0===l&&n.handleTTI&&(!(n.iconsLoaded.has(e)&&n.thumbsLoaded.has(e))&&(n.numTilesLoadedOnFirstPage++,n.numTilesLoadedOnFirstPage===a&&n.handleTTI()));i&&(n.pagesWithThumbs.has(l)||n.pagesWithThumbs.add(l),n.anyThumbLoadedTimeByPage.get(l)||n.anyThumbLoadedTimeByPage.set(l,n.getTimeNow()),n.numTilesFinalizedByPage[l]===a&&n.allThumbsLoadedTimeByPage.set(l,n.getTimeNow()))},this.pruneTrackedPages=function(){n.startTimeByPage.forEach((function(e,t){!n.pagesToLog.has(t)&&!n.pagesCompletedLogging.has(t)&&n.getTimeNow()-e>2e3&&n.startTimeByPage.delete(t)}))},this.logCompletedPages=function(){n.pagesToLog.forEach((function(e){var t=n.startTimeByPage.get(e),i=Math.max(n.allThumbsLoadedTimeByPage.get(e),t),r=Math.max(n.anyThumbLoadedTimeByPage.get(e),t);!i||n.pagesWithThumbs.has(e)?n.pagesWithThumbErrors.has(e)?n.handlePageCompletedLogging(e):t&&i&&r&&(n.logPerfStats(e,t,r,i),n.handlePageCompletedLogging(e)):n.handlePageCompletedLogging(e)}))},this.numTiles=e,this.numTilesPerPage=t,this.numTilesFinalizedByPage=[],this.numTilesLoadedOnFirstPage=0,this.iconsLoaded=new Set,this.thumbsLoaded=new Set,this.startTimeByPage=new Map,this.allThumbsLoadedTimeByPage=new Map,this.anyThumbLoadedTimeByPage=new Map,this.pagesWithThumbErrors=new Set,this.pagesWithThumbs=new Set,this.pagesCompletedLogging=new Set,this.pagesToLog=new Set,this.handleTTI=r}return e.prototype.getTimeNow=function(){var e=r.performance(),t=-1;return e&&e.now&&(t=e.now()),t},e.prototype.updateNumTiles=function(e){this.numTiles>=e||(this.numTiles=e)},e.prototype.handlePageCompletedLogging=function(e){this.pagesCompletedLogging.add(e),this.pagesToLog.delete(e),this.startTimeByPage.delete(e),this.anyThumbLoadedTimeByPage.delete(e),this.allThumbsLoadedTimeByPage.delete(e)},e.logThumbLoadError=function(){i.JSStopwatch.recordTrace("visual_browse_thumb_load_error",{stopwatchName:"infinite_tile_grid_logging",traceTime:0})},e.logThumbRTT=function(e){i.JSStopwatch.recordTrace("visual_browse_thumb_rtt",{stopwatchName:"infinite_tile_grid_logging",traceTime:e})},e.prototype.logPerfStats=function(e,t,r,n){i.JSStopwatch.recordTrace("loaded_any_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:r-t}),i.JSStopwatch.recordTrace("loaded_all_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:n-t})},e})();t.InfiniteTileGridLogger=n})),define("modules/clean/react/files_view/double_click",["require","exports","tslib","react"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastClickTimestamp=0,t.onClick=function(e){var i=t.props,r=i.onDoubleClick,n=i.onClick,a=i.threshold;if(r){var o=(new Date).getTime();o-t.lastClickTimestamp<a?(r(e),t.lastClickTimestamp=0):(t.lastClickTimestamp=o,n(e))}else n(e)},t}return i.__extends(t,e),t.prototype.render=function(){return this.props.children({onClick:this.onClick})},t.defaultProps={onClick:function(){},threshold:500},t})((r=i.__importDefault(r)).default.PureComponent);t.WithDoubleClick=n}));
//# sourceMappingURL=pkg-files-view-extra.min.js-vflTv0yVP.map