define(["require","exports","tslib","react","modules/core/browser","modules/clean/react/delorean/data/types","modules/clean/react/snackbar","modules/core/i18n","spectrum/icon_content","classnames","spectrum/icon_arrow","spectrum/tertiary_link","spectrum/button","modules/clean/react/delorean/data/api","modules/clean/react/delorean/components/rewind_step_header","modules/clean/react/delorean/logging","modules/clean/react/delorean/constants"],(function(e,t,r,a,o,n,i,s,c,d,l,p,u,m,f,h,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),o=r.__importStar(o),d=r.__importDefault(d),m=r.__importStar(m),h=r.__importStar(h);var _=function(e){var t=e.name,r=e.displayDate,o=e.previousVersion;return a.default.createElement("div",{className:d.default({"rewind-folder-and-date":!0,"rewind-folder-and-date--previous-version":o})},a.default.createElement("div",{className:"rewind-folder-and-date__folder"},a.default.createElement(c.IconContent,{name:"folder-small"})),a.default.createElement("div",null,a.default.createElement("div",{className:"rewind-folder-and-date__name"},t),a.default.createElement("div",{className:"rewind-folder-and-date__date"},r)))},v=(function(e){function t(t){var c=e.call(this,t)||this;return c.clickCancel=function(){var e=c.props,t=e.user,r=e.restoreId;h.clickPreviewCancel({user:t,restoreId:r}),c.props.dispatch({type:n.DeloreanActionType.changeRewindPageFromConfirmationPageToGraphPage,previousPage:c.props.page})},c.clickSendBack=function(){return r.__awaiter(c,void 0,void 0,(function(){var e,t,o,c,d,l;return r.__generator(this,(function(r){switch(r.label){case 0:e=this.props,t=e.user,o=e.restoreId,h.clickPreviewId({user:t,restoreId:o}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,m.beginRewind({path:this.props.fqpath,targetTsMicroseconds:1e3*this.props.eventToRewindTo.timestamp,user:this.props.user,restorationsLoggingId:this.props.restoreId})];case 2:return c=r.sent(),[3,4];case 3:if(d=r.sent(),l=d&&d.error&&d.error[".tag"])if("insufficient_permissions"===l)i.Snackbar.show(a.default.createElement(i.Snackbar,{closeButtonText:s._("Close"),title:s._("You do not have permissions to rewind this folder.",{project:"folder-history"}),variant:"fail"}));else{if("invalid_arguments"!==l&&"feature_not_allowed"!==l)throw d;i.Snackbar.show(a.default.createElement(i.Snackbar,{closeButtonText:s._("Close"),title:s._("We canâ€™t rewind that. Try again, or contact support.",{project:"folder-history"}),variant:"fail"}))}return[2];case 4:return this.props.dispatch({type:n.DeloreanActionType.changeRewindPageToRewindStarted,event:this.props.eventToRewindTo,rewindId:c.rewind.id}),[2]}}))}))},c.onGoBack=function(){var e=c.props,t=e.user,r=e.restoreId;h.clickPreviewBack({user:t,restoreId:r}),c.props.dispatch({type:n.DeloreanActionType.goBackFromConfirmationPage})},c.goToHelp=function(){var e=c.props,t=e.user,r=e.restoreId;h.clickPreviewHelp({user:t,restoreId:r}),o.unsafe_open_tab("http://www.dropbox.com/help/security/rewind")},c.state={eventCountHigh:null},c}return r.__extends(t,e),t.prototype.componentDidMount=function(){h.loadConfirmationPage({eventToRewindTo:this.props.eventToRewindTo,eventCounts:this.props.eventCounts,graphPage:this.props.graphPage,user:this.props.user,restoreId:this.props.restoreId})},t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(f.RewindStepHeader,{currentStep:3,maxStep:w.NUM_REWIND_STEPS,instructions:s._("Start rewinding?",{project:"folder-history",comment:"Rewinding is used as a verb"}),onGoBack:this.onGoBack}),a.default.createElement(_,{name:this.props.folderName,displayDate:s._("Now",{project:"folder-history",comment:"Refers to the current state of the folder. Keep to one word if possible."}),previousVersion:!0}),a.default.createElement("div",{className:"rewind-confirmation-change-count"},a.default.createElement("div",{className:"rewind-confirmation-change-count__arrow"},a.default.createElement("div",{className:"rewind-confirmation-change-count__arrow__vertical-line"}),a.default.createElement("div",{className:"rewind-confirmation-change-count__arrow__head"}))),a.default.createElement(_,{name:this.props.folderName,displayDate:this.props.eventToRewindTo.confirmationCardDate,previousVersion:!1}),a.default.createElement("div",{className:"rewind-confirmation-explanation"},s._("Your files and folders will look like they did before %(date)s at %(time)s",{project:"folder-history",comment:'date in format "Mon, Mar 18" and time in format "8:05 PM"'}).format({date:this.props.eventToRewindTo.formattedDate,time:this.props.eventToRewindTo.timeAgo})," ",a.default.createElement("a",{href:"#",onClick:this.goToHelp},s._("How Rewind works")," ",a.default.createElement(l.IconArrow,{className:"arrow rewind-confirmation-explanation__arrow-icon",name:"right"}))),a.default.createElement("div",{className:"rewind-confirmation-buttons"},a.default.createElement(u.Button,{onClick:this.clickSendBack},s._("Rewind",{project:"folder-history",comment:"Button to start rewinding. Used as a verb."})),a.default.createElement(p.TertiaryLink,{onClick:this.clickCancel,className:"cancel"},s._("Cancel"))))},t})(a.default.Component);t.RewindConfirmationPage=v}));
//# sourceMappingURL=rewind_confirmation_page.min.js-vfl8BI1Vi.map