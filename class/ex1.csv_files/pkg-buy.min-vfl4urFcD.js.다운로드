define("modules/clean/react/payments/buy/components/buy_component",["require","exports","tslib","classnames","modules/core/notify","react","classnames","modules/core/browser","modules/core/i18n","modules/clean/react/payments/buy/components/plan/buy_plan","modules/clean/react/async/loadable","modules/clean/web_timing_logger","modules/clean/stormcrow/stormcrow_exposure_logger","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/types/types","modules/clean/viewer","modules/clean/react/payments/buy/components/headline","modules/clean/react/payments/buy/components/navigation","modules/clean/react/payments/buy/components/footer"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m,y,_,f,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),o=a.__importDefault(o),i=a.__importDefault(i),s=a.__importStar(s);var S,P=l.Loadable({loader:function(){return p.waitForTTI().then((function(){return new Promise((function(t,a){e(["modules/clean/react/payments/buy/components/payments/sox_compliance_warning"],t,a)})).then(a.__importStar).then((function(e){return e.SOXComplianceBanner}))}))}});(function(e){e.Professional="PROFESSIONAL",e.Plus="PLUS"})(S||(S={}));var v=(function(t){function l(r){var i=t.call(this,r)||this;return i.renderCustomizedMsg=!1,i.logExperiments=function(){var e=i.props,t=e.experiments,a=e.currentStep,r=e.suggestedUser;1===a?(d.logVariantExposure("subgrowth_pro_buy_step1_cta_copy",t.subgrowthProBuyStep1CtaCopy),d.logVariantExposure("subgrowth_pro_buy_step_one_trial_messaging",t.subgrowthProBuyStepOneTrialMessaging)):2===a&&(d.logVariantExposure("subgrowth_pro_buy_step2_pricing_messaging",t.subgrowthProBuyStep2PricingMessaging),r&&d.logVariantExposure("subgrowth_buy_universal_preauth",t.subgrowthBuyUniversalPreauth))},i.redirectToPromo=function(){s.redirect(i.props.promoRedirect),n.Notify.success(u._("Great news! You’re eligible for a discount"))},i.redirectToTrial=function(e){return function(){s.redirect(e)}},i.headline=o.default.createRef(),i.checkIsSmartSyncUpsell(["V1","V2","V3"])?(i.renderCustomizedMsg=!0,p.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/growth/smartsync_upsell/smartsync_upsell_tracker"],t,a)})).then(a.__importStar).then((function(e){var t=e.SmartSyncUpsellTracker;i.tracker=new t(_.Viewer.get_viewer().get_users()[0].id)}))}))):"stsp"===s.get_uri().getQuery().oqa&&(i.renderCustomizedMsg=!0),i}return a.__extends(l,t),l.prototype.componentDidMount=function(){p.mark_time_to_interactive(),this.logExperiments()},l.prototype.componentDidUpdate=function(e,t){e.currentStep!==this.props.currentStep&&this.logExperiments()},Object.defineProperty(l.prototype,"ujProfessionalTrial",{get:function(){return"ON"===this.props.experiments.ujProfessionalTrial},enumerable:!0,configurable:!0}),l.prototype.renderHeadline=function(){var e=this.props,t=e.content,a=e.currentStep,r=e.productPlanType,n=e.showTrialVersion,i=y.getPlanContentFromMap(t,r),s=n?i.trySubheadline:i.buySubheadline;return this.renderCustomizedMsg&&(s=u._("You’re one step away from freeing up hard drive space with Smart Sync")),o.default.createElement(f.DropboxBuyHeadlineWeb,{expIsSimplifiedPlansOn:this.renderCustomizedMsg,forwardRef:this.headline,headlineText:1===a?t.chooseHeadline:t.purchaseHeadline,subheadlineText:s})},l.prototype.checkIsSmartSyncUpsell=function(e){return"getSmartSync"===s.get_uri().getQuery().referrer&&e.includes(String(this.props.experiments.ujGetSmartSync))},l.prototype.hideSteps=function(){var e=this.props,t=e.currentStep,a=e.experiments,r=e.defaultPlan,n=e.showTrialVersion,o=s.get_uri().getQuery();return!!("V1"===a.expMontanaOptimizationReroute||"V1"===a.proBizMve&&"1"===o.hs&&2===t&&"professional"===r&&n)||"one-license"===o._tk&&"ON"===a.ujOneLicense&&"ON"===a.ujProfessionalTrial&&"professional"===r&&n},l.prototype.currentStep=function(){var e=this.props,t=e.currentStep,a=e.experiments,r=e.stepClick;return o.default.createElement(g.DropboxBuyNavigationWeb,{currentStep:t,hideSteps:this.hideSteps()||!1,onStepClick:r,expIsSimplifiedPlansOn:this.renderCustomizedMsg,tracker:this.tracker,expUjOneLicense:a.ujOneLicense||""})},l.prototype.renderPlans=function(){var e=this,t=this.props,a=t.content,n=t.currentPlan,s=t.experiments,u=t.formData,l=t.hasPromo,p=t.planClick,d={Professional:y.getPlanContentFromMap(a,m.ProductPlanType.PROFESSIONAL),Plus:y.getPlanContentFromMap(a,m.ProductPlanType.PLUS)},_="professional"===n,f="plus"===n,g=function(t){var a=t.productPlanKey,r=t.showTrialVersion,n=m.ProductPlanType[a];return function(){return p(n,Boolean(r),e.headline.current||void 0)}},h="ON"===s.subgrowthProBuyFeaturesMobile,P="ON"===s.expMontanaMasterSwitch,v=r.default({"DropboxBuyPage-plansAndReasons":!0,grid__item:!0,"grid__item--medium--5-12":!0,"grid__item--large--1-3":!0,"DropboxBuyPage-plansAndReasons--showReasonsOnMobile":h}),b=r.default("buy-plan",{"buy-plan--montana":P}),C=function(e){var t=e.plan,a=e.onClick,r=e.secondaryClick,n=e.disabled,u=e.href,l=e.trialEndDate,p=e.boldFirstReason;return o.default.createElement("div",{className:v},o.default.createElement(c.BuyPlan,{plan:t,onClick:a,secondaryClick:r,classname:b,disabled:n,href:u,experiments:s,trialEndDate:l}),o.default.createElement("span",{className:"ax-visually-hidden"},t.included.title),o.default.createElement("ul",{className:"DropboxBuyPage__reasons",role:"list"},t.reasons.map((function(e,t){var a;return o.default.createElement("li",{className:i.default("DropboxBuyPage__reason",(a={},a["DropboxBuyPage__reason--bold"]=p&&0===t,a)),key:"reason-"+t},e.text)}))))};return o.default.createElement("section",{className:"DropboxBuyPage__plans grid__container"},o.default.createElement(C,{plan:d.Plus,onClick:l?this.redirectToPromo:g({productPlanKey:S.Plus}),disabled:!_&&f}),o.default.createElement("div",{className:"spacer grid__item--medium--1-24"}),f?o.default.createElement(C,{plan:d.Professional,href:"/account/plan?modal=plan&option=pro"}):this.ujProfessionalTrial?o.default.createElement(C,{plan:d.Professional,onClick:this.props.useRevenueApi?this.redirectToTrial(d.Professional.cta.trial_link):g({productPlanKey:S.Professional,showTrialVersion:!0}),secondaryClick:g({productPlanKey:S.Professional}),disabled:_,trialEndDate:u.trialEndDate.rawValue}):o.default.createElement(C,{plan:d.Professional,onClick:g({productPlanKey:S.Professional}),disabled:_}))},l.prototype.renderCheckOutForm=function(){var e=this.props,t=e.actions,a=e.checkoutFormProps,r=e.content,n=e.experiments,i=e.formData,s=e.pageState,u=e.pricingState,c=e.productPlanType,l=e.PurchaseFormComponent,p=e.showTrialVersion,d=e.updateHistory,_=e.useAUTaxInclusivePricing,f=y.getPlanContentFromMap(r,c),g={monthlyPrice:f.priceMonthly.price,annualPriceAsMonthly:f.priceAnnual.priceAsMonthly,yearlyPrice:f.priceAnnual.price,yearlyWithoutSavings:f.priceAnnual.withoutSavings,yearlySavings:f.priceAnnual.savings},h=y.getPlanContentFromMap(r,m.ProductPlanType.PLUS),S=y.getPlanContentFromMap(r,m.ProductPlanType.PROFESSIONAL),P={plus:h.quota,professional:S.quota};return o.default.createElement(l,{actions:t,buyLink:f.cta.link,ccIframeUrl:a.ccIframeUrl,continueURI:a.continueURI,countryList:a.countryList,currencyToFormatMap:a.currencyToFormatMap,experiments:n,formData:i,idealBanks:a.idealBanks,iframeExperiments:a.iframeExperiments,includedFeaturesContent:f.included,locale:a.locale,localeNumberFormat:a.localeNumberFormat,pageState:s,paymentMethodMapper:a.paymentMethodMapper,planName:f.name,plansByType:r.plansByType,planTier:f.tier,planNamePrefixedWithDropbox:f.namePrefixedWithDropbox,productPlanType:c,pricingState:u,initialPricingStrings:u.subChangePlans?void 0:g,quotaStrings:P,updateHistory:d,proTrialDays:a.trialLength,taxNamesByCountry:a.taxNamesByCountry,userInfo:a.userInfo,showCpf:n.showCpf,showCpfName:n.showCpfName,showTrialVersion:p,useAUTaxInclusivePricing:_,submitFormSuccess:s.submitFormSuccess})},l.prototype.renderFooter=function(){var e,t=this.props,a=t.currentStep,r=t.pageState.footerLinks;if(r&&r.length){var n=function(e){var t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)};e=r.map((function(e){return{section:n(e.section),links:e.links.filter((function(e){return e.href&&e.label})).map((function(e){return{href:e.href,label:n(e.label)}}))}}))}return o.default.createElement(h.DropboxBuyFooterWeb,{footerLinks:e,currentStep:a})},l.prototype.render=function(){var e=this.props,t=e.currentStep,a=e.SOXComplianceMessage,n=r.default({DropboxBuyPage__content:!0,grid__container:!0,"grid--x-left":!0});return o.default.createElement("main",{className:n},a&&o.default.createElement(P,{message:a}),this.renderHeadline(),this.currentStep(),1===t&&this.renderPlans(),o.default.createElement("section",{className:"DropboxBuyPage__form grid__container"},2===t&&this.renderCheckOutForm()),this.renderFooter())},l})(o.default.Component);t.BuyComponent=v})),define("modules/clean/react/payments/buy/components/dropbox_buy_page",["require","exports","tslib","modules/clean/ajax","modules/core/exception","modules/core/notify","react","modules/clean/analytics","modules/core/browser","modules/core/uri","modules/clean/react/async/loadable","modules/clean/payments/skus/pricing_data","modules/clean/payments/skus/subscription_change_plan","modules/clean/web_timing_logger","modules/clean/stormcrow/stormcrow_exposure_logger","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/react/payments/common/adapters/setup_cash","modules/clean/react/payments/buy/state/pro_store_creator","modules/clean/react/payments/buy/actions/buy_actions_creator","modules/clean/react/payments/buy/reducers/reducers","modules/clean/react/payments/buy/types/types","modules/clean/viewer","modules/clean/react/payments/buy/components/buy_component"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m,y,_,f,g,h,S,P,v,b,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),n=a.__importStar(n),i=a.__importDefault(i),u=a.__importStar(u);var T=l.Loadable({loader:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,a){e(["modules/clean/react/payments/pro/server_view_components/pro_try_server_view"],t,a)})).then(a.__importStar)];case 1:return[2,t.sent().ProTryServerView]}}))}))},loading:i.default.createElement("div",null)}),F=l.Loadable({loader:function(){return m.waitForTTI().then((function(){return new Promise((function(t,a){e(["modules/clean/react/payments/buy/components/buy_purchase_form"],t,a)})).then(a.__importStar).then((function(e){return e.BuyPurchaseForm}))}))}}),w=(function(t){function l(r){var n,o=t.call(this,r)||this;o.planClick=function(e,t,a){void 0===t&&(t=!1);var r={currentStep:2,productPlanType:e,showTrialVersion:t},n=o.getStoreProps(r);Promise.resolve(o.actions.updateState(n)).then((function(){window.scrollTo(0,0),o.updateHistory(2,e,void 0,t),a&&a.focus()})),s.ProEventsLogger.log(s.ProEventNames.BUY_TRY_PAGE_CHECKOUT,{type:"SelectPlan",productPlanType:e,showTrialVersion:t},void 0,o.props.showServerViewVersion)},o.stepClick=function(){Promise.resolve(o.actions.updateCurrentPage(1,o.state.navState.productPlanType,o.state.navState.showTrialVersion)).then((function(){window.scrollTo(0,0),o.updateHistory(1,o.state.navState.productPlanType,void 0,o.state.navState.showTrialVersion)}))},o.updateHistory=function(e,t,a,r){void 0===r&&(r=!1);var n=o.props,i=n.showServerViewVersion,s=n.experiments,l=c.URI.parse(u.get_href()).getQuery(),p="/buy",d="buy";if(2===e){var m=v.getPlanContentFromMap(o.contentForStep,t),y=t===f.ProductPlanType.PLUS?"plus":"professional";r?(p=m.cta.trial_link||"",d="try_"+y):(p=m.cta.link,d="buy_"+y)}i&&(p="/pro/try_server_view",d+="_server_view"),a||_.ProWebActivityLogger.log(d,p,l),a&&"V1"===s.expMontanaOptimizationReroute&&_.ProWebActivityLogger.log(d,p,l),_.UXAnalyticsLogger.log("page_view",{page:d});var g=c.URI.parse(p).setQuery(l).toString();a?window.history.replaceState(o.state,document.title,g):window.history.pushState(o.state,document.title,g)},o.navAction=function(e){if(e.state&&e.state.navState){var t=o.getStoreProps(e.state.navState);o.actions.updateState(t)}};var i=r.checkoutFormProps;g.setupCash(i.localeNumberFormat,i.currencyToFormatMap);var l=o.getStoreProps();return o.store=h.configureStore(l,P.proBuyReducer),o.state=o.store.getState(),o.store.subscribe((function(){o.setState((function(){return o.store.getState()}))})),o.checkIsSmartSyncUpsell(["V1","V2","V3"])&&m.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/growth/smartsync_upsell/smartsync_upsell_tracker"],t,a)})).then(a.__importStar).then((function(e){var t=e.SmartSyncUpsellTracker;o.tracker=new t(b.Viewer.get_viewer().get_users()[0].id)}))})),(null===(n=o.state.pageState.marketingTracker)||void 0===n?void 0:n.initData)&&m.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/marketing_tracker"],t,a)})).then(a.__importStar).then((function(e){var t,a=e.MarketingTracker;(null===(t=o.state.pageState.marketingTracker)||void 0===t?void 0:t.initData)&&a.push(o.state.pageState.marketingTracker.initData)}))})),o}return a.__extends(l,t),l.prototype.getStoreProps=function(e){var t=this.props,a=t.checkoutFormProps,r=t.requestId,n=t.showTrialVersion,o=t.suggestedUser,i=t.experiments,s=t.preauthUser,u=t.showServerViewVersion,c=t.useRevenueApi,l=t.marketingTracker,p=t.content,d=e?e.productPlanType:this.getProductPlanType(),m=e||{currentStep:this.getCurrentStep(),productPlanType:this.getProductPlanType(),showTrialVersion:!!n},_=!1;return d!==f.ProductPlanType.PLUS||m.showTrialVersion||(i.subgrowthProBuyQuotaSwitchTrial&&["CONTROL","V1"].includes(i.subgrowthProBuyQuotaSwitchTrial)&&y.logVariantExposure("subgrowth_pro_buy_quota_switch_trial",i.subgrowthProBuyQuotaSwitchTrial),"V1"!==i.subgrowthProBuyQuotaSwitchTrial&&"V1"!==i.expMontanaOptimizationReroute||(_=!0)),{autocompleteForm:a.autocompleteForm,countryCode:a.countryCode,vat:a.vat,locale:a.locale,userInfo:a.userInfo,trialLength:a.trialLength,serializedPaymentFormSpec:a.serializedPaymentFormSpec,serializedSubChangePlans:void 0,baseSubChangePlans:this.state?this.state.pricingState.baseSubChangePlans:void 0,productPlanType:d,isServerView:u?"ON":"OFF",navState:m,showTrialVersion:m.showTrialVersion,suggestedUser:o,preauthUser:s,showPlanSwitchRadios:_,footerLinks:this.state?this.state.pageState.footerLinks:void 0,optimizeCpf:"V1"===i.subgrowthProBuyBrCpfCollectionOptimization,requestId:r,paymentFormErrorsExperiment:i.paymentFormErrorsExperiment,showCpf:i.showCpf,psd2AddressFields:i.psd2AddressFields,useRevenueApi:c,marketingTracker:l,plansContent:p.plansByType}},Object.defineProperty(l.prototype,"actions",{get:function(){return S.bindProBuyActions(this.store)},enumerable:!0,configurable:!0}),l.prototype.checkIsSmartSyncUpsell=function(e){return"getSmartSync"===u.get_uri().getQuery().referrer&&e.includes(String(this.props.experiments.ujGetSmartSync))},l.prototype.getCurrentStep=function(){return this.props.defaultPlan?2:1},l.prototype.getProductPlanType=function(){var e=this.props.currentPlan;return"plus"===e||"professional"===e?f.ProductPlanType.PROFESSIONAL:this.props.defaultPlan&&"professional"===this.props.defaultPlan?f.ProductPlanType.PROFESSIONAL:f.ProductPlanType.PLUS},Object.defineProperty(l.prototype,"contentForStep",{get:function(){return 1===this.state.navState.currentStep?this.props.content:a.__assign(a.__assign({},this.props.content),{plansByType:this.state.pageState.plansContent})},enumerable:!0,configurable:!0}),l.prototype.componentDidMount=function(){var t=this,i=this.state.pageState.useRevenueApi;this.updateHistory(this.state.navState.currentStep,this.state.navState.productPlanType,!0,this.state.navState.showTrialVersion),window.addEventListener("popstate",this.navAction);for(var s=document.querySelectorAll(".dws-preloader"),u=0;u<s.length;u++){var c=s[u];c.parentNode&&c.parentNode.removeChild(c)}r.WebRequest({url:"/buy/footer_links",type:"GET",success:function(e){var a=JSON.parse(e);t.actions.setFooterLinks(a)}});var l=this.props.showServerViewVersion?"buy_server_view":"buy";r.SilentBackgroundRequest({url:"/growth/log_visit_ajax",type:"POST",data:a.__assign({endpoint:l,log_preauth:!0,additional_preauth_types:"preauth_pro_upgrade"},this.props.loggingProps)}),i||r.WebRequest({url:"/pro/ajax_fetch_sub_change_plans",type:"POST",success:function(e){var a=JSON.parse(e);if(0===a.length)o.Notify.error(p.PricingDataException.notifyErrorMessagePersonal,20),n.reportException({err:new Error("/pro/ajax_fetch_sub_change_plans returned 0 Subscription Change Plans"),severity:n.SEVERITY.NONCRITICAL});else{var r=a.map((function(e){return d.SubscriptionChangePlan.deserialize(e)}));t.actions.loadSubChangePlans(r)}},error:function(e,t,a){if(0!==e.status){o.Notify.error(p.PricingDataException.notifyErrorMessagePersonal,20);var r="/pro/ajax_fetch_sub_change_plans failed to return Subscription Change Plans (status: %(status)s)".format({status:e.status});n.reportException({err:new Error(r),severity:n.SEVERITY.CRITICAL})}}}),this.checkIsSmartSyncUpsell(["V2","V3"])&&m.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/growth/smartsync_upsell/smartsync_upsell_tracker"],t,a)})).then(a.__importStar).then((function(e){var a=e.SmartSyncUpsellActions;t.tracker.track(a.SMARTSYNC_UPSELLS_RENDER_TRY_PRO)}))}))},l.prototype.componentWillUnmount=function(){window.removeEventListener("popstate",this.navAction)},l.prototype.render=function(){var e=this.props,t=e.checkoutFormProps,r=e.content.purchaseHeadline,n=e.currentPlan,o=e.defaultPlan,s=e.experiments,u=e.hasPromo,c=e.promoRedirect,l=e.PurchaseFormComponent,p=e.showServerViewVersion,d=e.SOXComplianceMessage,m=e.suggestedUser,y=e.trademarks,_=e.useAUTaxInclusivePricing,f=this.state,g=f.navState,h=g.currentStep,S=g.productPlanType,P=g.showTrialVersion,b=f.formData,F=f.pageState,w=f.pricingState,E=this.state.pageState,N=E.useRevenueApi,k=E.plansContent,A={actions:this.actions,experiments:s,formData:b,pageState:F,plansByType:k,productPlanType:S,showTrialVersion:P,SOXComplianceMessage:d,useRevenueApi:N};if(p){var x=v.getPlanContentFromMap(this.contentForStep,S),U=a.__assign(a.__assign({},A),{ccIframeUrl:t.ccIframeUrl,continueURI:t.continueURI,countryList:t.countryList,currentPlanContent:x,currentTransitionPrices:w.currentTransitionPrices,displayPrices:w.displayPrices,headlineText:r,idealBanks:t.idealBanks,iframeExperiments:t.iframeExperiments,loadingPrices:w.loadingPrices,locale:t.locale,showCpf:s.showCpf,showCpfName:s.showCpfName,submitFormSuccess:F.submitFormSuccess,taxNamesByCountry:t.taxNamesByCountry,useAUTaxInclusivePricing:_||!1,userInfo:t.userInfo,requestId:this.props.requestId});return i.default.createElement(T,a.__assign({},U))}var V=a.__assign(a.__assign({},A),{checkoutFormProps:t,content:this.contentForStep,currentStep:h,currentPlan:n,defaultPlan:o,hasPromo:u,planClick:this.planClick,pricingState:w,promoRedirect:c,PurchaseFormComponent:l,stepClick:this.stepClick,suggestedUser:m,trademarks:y,updateHistory:this.updateHistory,useAUTaxInclusivePricing:_});return i.default.createElement(C.BuyComponent,a.__assign({},V))},l.defaultProps={PurchaseFormComponent:F},l})(i.default.Component);t.DropboxBuyPage=w,t.RootComponent=w})),define("modules/clean/react/payments/buy/components/dropbox_buy_checkout",["require","exports","tslib","react","modules/clean/react/payments/buy/components/buy_purchase_form","modules/clean/react/payments/buy/components/dropbox_buy_page"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return r.default.createElement(o.DropboxBuyPage,a.__assign({PurchaseFormComponent:n.BuyPurchaseForm},this.props))},t})((r=a.__importDefault(r)).default.Component);t.DropboxBuyPage=i})),define("modules/clean/react/payments/buy/components/headline",["require","exports","tslib","classnames","react"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),n=a.__importDefault(n),t.DropboxBuyHeadlineWeb=function(e){var t=e.expIsSimplifiedPlansOn,a=e.forwardRef,o=e.headlineText,i=e.subheadlineText,s=r.default({DropboxBuyPage__headline:!0,grid__container:!0,DropboxBuyPage__headline__smartsync:t}),u=r.default({DropboxBuyPage__subheadline:!0,grid__container:!0}),c=i?n.default.createElement("h2",{className:u},i):null;return n.default.createElement(n.default.Fragment,null,n.default.createElement("h1",{className:s,tabIndex:-1,ref:a},o),c)}})),define("modules/clean/react/payments/buy/components/footer",["require","exports","tslib","react","modules/clean/web_timing_logger","modules/clean/react/async/loadable"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r);var i=o.Loadable({loader:function(){return n.waitForTTI().then((function(){return new Promise((function(t,a){e(["modules/clean/react/rebrand/elements/rebrand_arbor_footer_component"],t,a)})).then(a.__importStar).then((function(e){return e.RebrandArborMinimalFooterComponent}))}))}}),s=o.Loadable({loader:function(){return n.waitForTTI().then((function(){return new Promise((function(t,a){e(["modules/clean/react/rebrand/elements/rebrand_arbor_footer_component"],t,a)})).then(a.__importStar).then((function(e){return e.RebrandArborFooterComponent}))}))}});t.DropboxBuyFooterWeb=function(e){var t=e.footerLinks;return 1!==e.currentStep?r.default.createElement(i,{localeSelectorWithoutCss:!0}):t&&t.length?r.default.createElement(s,{backgroundColor:"white",textColor:"black",content:t,localeSelectorWithoutCss:!0}):null}})),define("modules/clean/react/payments/buy/components/navigation",["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/analytics","modules/clean/web_timing_logger"],(function(e,t,a,r,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),n=a.__importDefault(n),t.DropboxBuyNavigationWeb=function(t){var u=[],c=t.currentStep;if(t.expIsSimplifiedPlansOn){return n.default.createElement("a",{href:"/plans",onClick:function(){s.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/growth/smartsync_upsell/smartsync_upsell_tracker"],t,a)})).then(a.__importStar).then((function(e){var a=e.SmartSyncUpsellActions;t.tracker.track(a.SMARTSYNC_UPSELLS_ALL_PLANS)}))}))},className:"DropboxBuyPage__allplans"},o._("See all plans"))}if(t.hideSteps)"ON"===t.expUjOneLicense&&i.IntentLogger.log("pro_try_buy_page_steps_hidden",{module:"one_license",version:"V1"});else{u=[1,2].map((function(e){var a=r.default({DropboxBuyPage__step:!0,"DropboxBuyPage__step--currentStep":e===c,"DropboxBuyPage__step--clickable":1===e&&2===c});return 2===c&&1===e?n.default.createElement("button",{className:a,key:"step-"+e,onClick:t.onStepClick},o._("Step %(step)s").format({step:e})):n.default.createElement("span",{className:a,key:"step-"+e},o._("Step %(step)s").format({step:e}))}))}var l=r.default({DropboxBuyPage__steps:!0,grid__container:!0}),p=o._("Current step is %(current_step)s of 2").format({current_step:c});return n.default.createElement("div",{className:l},n.default.createElement("span",{className:"ax-visually-hidden"},p),n.default.createElement("span",{"aria-hidden":"true"},u))}})),define("modules/clean/react/payments/buy/components/plan/buy_plan",["require","exports","tslib","classnames","react","modules/clean/react_format","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/react/css","modules/clean/react/payments/buy/types/types","modules/clean/react/rebrand/elements/rebrand_buttons","modules/clean/react/payments/buy/components/plan/plan_card","modules/clean/react/tooltip","spectrum-arbor/atoms/arbor_copy","spectrum-arbor/atoms/arbor_headline"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),n=a.__importDefault(n),s=a.__importStar(s);var _=(function(e){function t(t){var a=e.call(this,t)||this;return a.state={namespace:"BuyPlan"},a}return a.__extends(t,e),t.prototype.isEligibleForTrialByTier=function(e){var t=this.props.experiments;if(!t)return!1;switch(e){case c.BuyPagePlanTiers.PROFESSIONAL:return"ON"===t.ujProfessionalTrial;default:return!1}},t.prototype.getPricingStrings=function(){var e,t,a,r=this.props.plan,s=r.priceMonthly,u=r.priceAnnual,c=r.gstIncluded;if(c){var l=i._("%(price)s / %(duration)s%(line_break)s(%(tax_string)s)");e=l.format({price:u.priceAsMonthly,duration:s.duration,tax_string:c,line_break:"\n"}),a=o.reactFormat(l,{price:u.priceAsMonthly,duration:s.duration,tax_string:c,line_break:n.default.createElement("br",null)}),t=i._("%(price)s per %(duration)s. %(tax_string)s").format({price:u.priceAsMonthly,duration:s.duration,tax_string:c})}else a=e=i._("%(price)s / %(duration)s").format({price:u.priceAsMonthly,duration:s.duration}),t=i._("%(price)s per %(duration)s").format({price:u.priceAsMonthly,duration:s.duration});return{primaryPrice:e,primaryPriceRichText:a,primaryPriceAx:t,secondaryPrice:i._("%(price)s / %(duration)s (save %(savings)s)").format({price:u.price,duration:u.duration,savings:u.savings}),secondaryPriceAx:i._("%(price)s per %(duration)s. Save %(savings)s").format({price:u.price,duration:u.duration,savings:u.savings})}},t.prototype.renderCTA=function(){var e,t,s,u=this.props,c=u.secondaryClick,p=u.plan,d=u.onClick,m=u.disabled,y=u.href,_=this.state.namespace,f={className:_+"__cta",importance:"primary",size:"medium",disabled:m};if(d){var g=m?i._("%(plan_name)s is your current plan").format({plan_name:p.name}):i._("Select Dropbox %(plan_name)s").format({plan_name:p.name}),h=a.__assign({onClick:d,type:"button",ariaLabel:g},f);t=n.default.createElement(l.RebrandButton,a.__assign({},h),m?i._("Your current plan"):p.cta.text)}else if(y){var S=a.__assign({href:y},f);t=n.default.createElement(l.RebrandButtonAnchor,a.__assign({},S),p.cta.text)}if(this.isEligibleForTrialByTier(p.tier)&&c){var P=r.default(_+"__secondary-cta","button-as-link"),v=o.reactFormat(i._("Or buy %(plan)s now"),{plan:p.namePrefixedWithDropbox});s=n.default.createElement("button",{className:P,onClick:c},v)}var b=r.default(_+"__cta-container",((e={})[_+"__cta-container__extra-padding"]=!s,e));return n.default.createElement("div",{className:b},t,s)},t.prototype.componentDidMount=function(){s.mark_time_to_interactive()},t.prototype.render=function(){var e,t=this.state.namespace,a=this.props,r=a.experiments,o=a.hideDivider,s=a.plan,u=a.showAnnualPrice,l=a.trialEndDate,_=this.getPricingStrings(),f=s.name,g=u?_.secondaryPrice:"",h="blue";if(s.tier===c.BuyPagePlanTiers.PLUS&&(h="black"),r&&"V1"===r.subgrowthProBuyStepOneTrialMessaging&&s.tier===c.BuyPagePlanTiers.PROFESSIONAL&&l){var S=i._("Cancel anytime before %(date)s, and you won’t be charged. We’ll remind you via email before then.").format({date:l}),P=n.default.createElement(d.Tooltip,{tooltip_classname:"info__tooltip",position:d.TooltipPosition.BOTTOM,tooltip_contents:S,is_focusable:!0},n.default.createElement("button",{className:"info__tooltip-target",tabIndex:-1,"aria-label":i._("More information")}));e=n.default.createElement("div",{className:"plan-card__content__subheader--primary"},n.default.createElement("h4",{className:"plan-card__content__subheader"},n.default.createElement("span",{className:"plan-card__content__subheader--strike","aria-hidden":"true"},_.primaryPriceRichText),n.default.createElement("span",{className:"plan-card__content__subheader--green"},i._("Try FREE"))),P)}else e=n.default.createElement(n.default.Fragment,null,n.default.createElement(y.ArborHeadline,{"aria-hidden":"true",className:"plan-card__content__subheader--primary plan-card__content__subheader--no-margin",tag:"h4"},_.primaryPriceRichText),n.default.createElement("span",{className:"ax-visually-hidden"},_.primaryPrice),n.default.createElement(m.ArborCopy,{tag:"p",size:"small",color:"shark",marginBottomSize:"medium",marginTopSize:"none"},i._("when billed yearly")));return n.default.createElement(p.PlanCard,{classname:t+" "+t+"__"+f+" "+this.props.classname,title:f,planColor:h,hideDivider:o,primarySubheader:e,secondarySubheader:g,description:s.description},this.renderCTA())},t.defaultProps={showAnnualPrice:!1},t})(n.default.Component);t.BuyPlan=u.requireCssWithComponent(_,["/static/css/buy/components/buy_plan-vflYnKeOx.css","/static/js/spectrum-arbor/index.web-vfl2U0UqK.css"])})),define("modules/clean/react/payments/buy/components/plan/plan_card",["require","exports","tslib","react","modules/clean/react_format","modules/clean/react/css","modules/clean/web_timing_logger"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),i=a.__importStar(i);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.componentDidMount=function(){i.mark_time_to_interactive()},t.prototype.subheader=function(e,t){if(void 0===e&&(e=""),e)return"string"==typeof e?r.default.createElement("div",null,r.default.createElement("h4",{className:"plan-card__content__subheader"+t,"aria-hidden":"true"},n.reactFormat(e,{line_break:r.default.createElement("br",null)})),r.default.createElement("span",{className:"ax-visually-hidden"},e)):r.default.createElement("div",null,e)},t.prototype.render=function(){var e=this.props,t=e.classname,a=e.planColor,n=e.title,o=e.primarySubheader,i=e.secondarySubheader,s=e.description,u=e.hideDivider;return r.default.createElement("section",{className:t+" plan-card"},r.default.createElement("div",{className:"plan-card__card-top--"+a}),r.default.createElement("article",{className:"plan-card__content"},r.default.createElement("h2",{className:"plan-card__content__title"},n),this.subheader(o,"--primary"),!u&&r.default.createElement("hr",{"aria-hidden":"true",className:"plan-card__content__divider"}),this.subheader(i,"--secondary"),r.default.createElement("p",{className:"plan-card__content__description"},s),this.props.children))},t})(r.default.PureComponent);t.PlanCard=o.requireCssWithComponent(s,["/static/css/growth_pages/plans/plan_card-vflpaOLUr.css"])})),define("modules/clean/react/payments/common/middleware/pro_buy_logger",["require","exports","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/payment_form/payment_form_spec"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proBuyLogger=function(e){var t,o,i,s,u,c=["UpdateFirstName","UpdateLastName","UpdateEmail","UpdatePassword","UpdateZipCode","UpdateAccountHolderName","UpdateIBAN"];return function(l){return function(p){try{var d=l(p),m=p.type,y=e.getState(),_=y.pageState,f=y.pricingState,g=y.formData,h=y.navState,S=void 0;if(-1!==c.indexOf(m)&&o===m)return d;if("UpdateTransitionsStart"===m?t=(new Date).getTime():"UpdateTransitionsSuccess"!==m&&"UpdateTransitionsError"!==m||(S=(((new Date).getTime()-t)/1e3).toFixed(1)),"UpdateSelectedUser"===m||"ToggleNewAccount"===m)return d;var P={type:m,submitButtonState:_.submitting||f.loadingPrices?"disabled":"enabled"};if(void 0!==S&&(P.roundtrip=S),"UpdateSchedule"===m){var v="Unknown";g.scheduleId.rawValue===r.ScheduleId.MONTHLY?v="SelectMonthly":g.scheduleId.rawValue===r.ScheduleId.YEARLY&&(v="SelectYearly"),P.event=v}else if("UpdatePaymentMethod"===m){var b="Unknown";g.paymentMethod.rawValue===n.PaymentMethod.CreditCard?b="SelectCredit":g.paymentMethod.rawValue===n.PaymentMethod.PayPal?b="SelectPaypal":g.paymentMethod.rawValue===n.PaymentMethod.DirectDeposit?b="SelectDebit":g.paymentMethod.rawValue===n.PaymentMethod.Ideal&&(b="SelectIdeal"),P.event=b}else if("UpdateNonce"===m){var C=!1,T=g.nonce,F=T.isCCNValid,w=T.isCCodeValid,E=T.isCCExpValid;if(null!==i&&null!==u&&null!==s&&i===F&&u===w&&s===E&&(C=!0),i=F,u=w,s=E,C)return d;P.UpdateCC=F?"Valid":"Invalid",P.UpdateCVV=w?"Valid":"Invalid",P.UpdateExp=E?"Valid":"Invalid",o=m}return g.productPlanType.rawValue&&(P.productPlanType=g.productPlanType.rawValue,P.showTrialVersion=h&&h.showTrialVersion?"true":"false"),a.ProEventsLogger.log(a.ProEventNames.BUY_TRY_PAGE_CHECKOUT,P,void 0,_.isServerView),-1!==c.indexOf(m)&&(o=m),d}catch(t){_=e.getState().pageState;throw a.ProEventsLogger.log(a.ProEventNames.BUY_TRY_PAGE_CHECKOUT_CRASH,{action:p.type,error:t.stack||t.toString()},void 0,_.isServerView),t}}}}})),define("modules/clean/react/payments/buy/actions/buy_actions_creator",["require","exports","tslib","redux","modules/clean/react/payments/buy/actions/page_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/react/payments/common/form/actions/actions"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),n=a.__importStar(n),o=a.__importStar(o),i=a.__importStar(i),t.bindProBuyActions=function(e){return r.bindActionCreators(a.__assign(a.__assign({},t.SHARED_FORM_ACTIONS),{setFooterLinks:n.setFooterLinks,loadSubChangePlans:n.loadSubChangePlans,toggleExistingAccount:n.toggleSignInModal,updateHistory:n.updateHistory,updateSelectedPlan:n.updateSelectedPlan,updateState:n.updateState,openSurvey:n.openSurvey,cancelSurvey:n.cancelSurvey,submitSurvey:n.submitSurvey}),e.dispatch)},t.SHARED_FORM_ACTIONS={updatePhone:i.updatePhone,blurPhone:i.blurPhone,updateCity:i.updateCity,blurCity:i.blurCity,updateName:i.updateName,blurName:i.blurName,updateAddress:i.updateAddress,blurAddress:i.blurAddress,showFormFieldErrors:i.showFormFieldErrors,submitCaptcha:i.submitCaptcha,submitProBuyForm:o.submitProBuyFormToServer,updateNonce:i.updateNonce,blurCCField:i.blurCCField,updateAdyenEncryptedCard:i.updateAdyenEncryptedCard,updateEncryptedCardForNetworkToken:i.updateEncryptedCardForNetworkToken,updateBrowserInfo:i.updateBrowserInfo,updateThreeDsData:i.updateThreeDsData,triggerThreeDsChallenge:i.triggerThreeDsChallenge,triggerThreeDsFingerprint:i.triggerThreeDsFingerprint,updateBIN:i.updateBIN,toggleNewAccount:o.toggleNewAccount,updateSelectedUser:o.updateSelectedUser,updateCurrentPage:n.updateCurrentPage,updateFirstName:i.updateFirstName,updateLastName:i.updateLastName,updateEmail:i.updateEmail,updatePassword:i.updatePassword,updateSchedule:o.updateSchedule,updateProductPlantype:o.updateProductPlanType,updatePaymentMethod:i.updatePaymentMethod,updateCountryCode:o.updateCountryCode,updateZipCode:o.updateZipCode,blurZipCode:i.blurZipCode,updateVat:o.updateVat,blurVat:i.blurVat,updateCpf:i.updateCpf,blurCpf:i.blurCpf,updateCpfName:i.updateCpfName,updateAccountHolderName:i.updateAccountHolderName,blurAccountHolderName:i.blurAccountHolderName,updateIBAN:i.updateIBAN,blurIBAN:i.blurIBAN,updateMandateSigned:i.updateMandateSigned,updateIdealBank:o.updateIdealBank,updateTermsAndService:i.updateTermsAndService,updateEVH:o.updateEVH}})),define("modules/clean/react/payments/buy/actions/buy_form_actions",["require","exports","tslib","modules/clean/analytics","modules/clean/payments/payment_form/payment_form_spec","modules/clean/payments/skus/constants","modules/core/exception","modules/clean/react/payments/buy/actions/pricing_actions","modules/core/notify","modules/clean/web_register_logging_data","modules/clean/payments/skus/pricing_data","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/buy/helpers/preauth","modules/clean/react/payments/common/form/actions/actions"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m){"use strict";function y(e,t,a,r,o,i,s,u,c){void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===u&&(u=!0),void 0===c&&(c=!1);var l=e.countryCode.formattedValue,p=["scheduleId","paymentMethod","countryCode"];return s||p.push("termsAndService"),c&&(a=!0,p.push("selectedUser")),a||p.push("firstName","lastName","email","password"),t.allow_zip_code_for_country(l)&&p.push("zipCode"),t.should_show_vat_for_country(l)&&""!==e.vat.formattedValue&&p.push("vat"),o&&t.should_require_cpf(l,e.paymentMethod.formattedValue)&&(p.push("cpf"),i&&p.push("cpfName")),t.showPSD2FieldsToUser(e.paymentMethod.formattedValue,l,r)&&p.push("name","city","address"),e.paymentMethod.formattedValue===n.PaymentMethod.CreditCard?(p.push("nonce"),p.push("adyenEncryptedCard"),p.push("encryptedCardForNetworkToken"),p.push("browserInfo"),p.push("threeDsData"),u&&p.push("bin")):e.paymentMethod.formattedValue===n.PaymentMethod.DirectDeposit?p.push("accountHolderName","iban","mandateSigned"):e.paymentMethod.formattedValue===n.PaymentMethod.Ideal&&p.push("idealBankId","idealBankName"),p}function _(e){var t=e.additionalData,a=void 0===t?{}:t,n=e.allowSubmitWithoutTOS,o=e.captchaComponentRef,s=e.handle3DsMessage,c=e.enableBinRouting,p=e.prepareForSubmission,_=e.trigger,f=e.url,h=e.showCpf,S=void 0!==h&&h,P=e.showCpfName,v=void 0!==P&&P,b=e.useSelectedUser,C=void 0!==b&&b,T=e.psd2AddressFields,F=void 0!==T&&T,w=e.subChangePlansIgnoreRevenueAPI,E=void 0===w?void 0:w,N=e.webPlusDirect,k=void 0!==N&&N;return function(e,t){var h,P=t(),b=P.formData,T=P.pageState.paymentFormSpec,w=P.pageState.existingAccountShowing,N=P.pricingState,A=P.pageState.useRevenueApi,x=P.pricingState.subChangePlans;if(E&&(x=E,A=!1),A){var U=b.scheduleId.formattedValue;a.schedule_id=U.toString()}if(x&&!A){var V=b.scheduleId.formattedValue,I=b.evh.rawValue,D=x.filter((function(e){return!!e.finalSubState.plan&&(e.finalSubState.plan.billingSchedule.id===V&&!!e.finalSubState.addons.skus.length===I)})).pop();if(D){if(D.finalSubState.planSku.productType!==b.productPlanType.rawValue)return u.Notify.error(l.PricingDataException.notifyErrorMessagePersonal,20),void i.reportException({err:new Error("Intended product type to purchase does not match subscription change plan"),severity:i.SEVERITY.CRITICAL});if((h=D.tvm)&&N.revenueApiPrice)if(h.getTotalPrice().formatCurrency(2)!==N.revenueApiPrice)return void i.reportException({err:new Error("Unable to verify that Subscription Change Plan Price is === Revenue Api Pricing (Amt/Currency)"),severity:i.SEVERITY.CRITICAL,tags:["revenue_api","payments"]});a.sub_change_plan=JSON.stringify(D)}}var L=y(b,T,w,F,S,v,n,c,C);if(C)return m.isValidSubmitState(P.formData,L)?void g(h,a,P).then((function(){return d.start(P.formData.selectedUser.rawValue)})).then((function(){return e(m.submitForm(f,L,p,a))})).catch((function(e){i.reportException({err:new Error("Error during form submission using preauthentication"+e.message),severity:i.SEVERITY.CRITICAL}),d.deactivate()})).finally((function(){""!==P.formData.vat.formattedValue&&r.ProEventsLogger.log("vat_provided_on_initial_purchase",{},void 0,P.pageState.isServerView)})):void e(m.showFormFieldErrors(L,"SubmitForm"));var R=A?{revenueApiProductCode:N.revenueApiProductCode||"",expectedPriceToken:N.revenueApiPricingToken||"",useRevenueApi:A,webPlusDirect:!!k}:void 0;g(h,a,P).then((function(t){e(m.submitForm(f,L,p,t,o,s,_,R)),""!==P.formData.vat.formattedValue&&r.ProEventsLogger.log("vat_provided_on_initial_purchase",{},void 0,P.pageState.isServerView)}))}}var f;function g(e,t,r){return a.__awaiter(this,void 0,void 0,(function(){var n,i,s,u,l,p,d,m,y,_;return a.__generator(this,(function(a){return n=r.pageState,i=n.existingAccountShowing,s=n.requestId,u=n.submitSeq,l=n.useRevenueApi,p=r.pricingState.revenueApiMarketingTrackerData,d=e&&e.getScheduleId()===o.ScheduleId.MONTHLY?"monthly":"yearly",t.account_info_type=i?"existing":"new",t.billing_schedule=d,t.currency=e&&e.getCurrency(),t.expected_price=e&&e.getExpectedPriceToken(),t.plan_id=e&&e.transition.state.plan.id,t.tos_version="3",t.packrat=e&&e.hasPackrat(),t.addon_expected_price=e&&e.hasPackrat()&&e.getAddonExpectedPrice(),t.request_id=s,t.submit_seq=u,r.navState?(m=r.navState,y=m.showTrialVersion,_=m.productPlanType,l&&p?(t.billing_schedule=p.contract_length,t.currency=p.currency,t.expected_price_amount=parseFloat(p.total_price_amount),t.product=p.product_family):(t.expected_price_amount=e&&e.getTotalPrice().amount,t.product=_===o.ProductPlanType.PLUS?"plus":"pro"),t.signup_type=y?"trial":"purchase",t.signup_tag=_===o.ProductPlanType.PLUS?y?f.PLUS_TRY:f.PLUS_BUY:y?f.PRO_TRY:f.PRO_BUY,[2,c.setWebRegisterLoggingData(t)]):[2,c.setWebRegisterLoggingData(t)]}))}))}function h(e){return function(t){t(p.updateCountryCode(e)),t(s.updatePrice())}}function S(e){return function(t){t(p.updateZipCode(e)),t(s.updatePrice())}}function P(e){return function(t){t(p.updateVat(e)),t(s.updatePrice())}}function v(e){return function(t){t((function(e){return{type:"UpdateEVH",value:e}})(e)),t(s.updateCurrentTransitionPrices())}}function b(e){return function(t){t((function(e){return{type:"UpdateSchedule",value:e}})(e)),t(s.updateCurrentTransitionPrices())}}function C(e){return function(t){t(p.updateIdealBank(e))}}function T(){return function(e,t){e({type:"ToggleNewAccount",show:!t().pageState.showCreateAccount})}}function F(e){return function(t,a){t({type:"UpdateSelectedUser",value:e})}}function w(e){return{type:"UpdateProductPlanType",value:e}}Object.defineProperty(t,"__esModule",{value:!0}),i=a.__importStar(i),s=a.__importStar(s),p=a.__importStar(p),d=a.__importStar(d),t.getFieldNamesToValidate=y,t.submitProBuyFormToServer=_,(function(e){e.PRO_BUY="pro_buy_register",e.PRO_TRY="pro_try_register",e.PLUS_BUY="plus_buy_register",e.PLUS_TRY="plus_try_register"})(f||(f={})),t.fillAdditionalData=g,t.updateCountryCode=h,t.updateZipCode=S,t.updateVat=P,t.updateEVH=v,t.updateSchedule=b,t.updateIdealBank=C,t.toggleNewAccount=T,t.updateSelectedUser=F,t.updateProductPlanType=w,t.actionCreators={submitProBuyFormToServer:_,updateCountryCode:h,updateZipCode:S,updateVat:P,updateEVH:v,updateSchedule:b,updateIdealBank:C,toggleNewAccount:T,updateSelectedUser:F,updateProductPlanType:w}})),define("modules/clean/react/payments/buy/actions/page_actions",["require","exports","tslib","modules/clean/react/payments/buy/actions/pricing_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/dbmodal"],(function(e,t,a,r,n,o){"use strict";function i(e,t,a){return{type:"UpdateCurrentPage",step:e,productPlanType:t,showTrialVersion:!!a}}function s(e){return function(t){t({type:"LoadSubChangePlans",baseSubChangePlans:e}),t(r.updatePrice())}}Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),o=a.__importStar(o),t.toggleSignInModal=function(e){return function(t,a){var r=a();r.pageState.userInfo.existingAccount&&!r.pageState.preauthUser?t({type:"ToggleSignInModal",show:e}):new o.DBModal({element_id:"sign-in-modal",focus:"input[name='login_email']"}).show()}},t.updateCurrentPage=i,t.updateHistory=function(){return{type:"UpdateHistory"}},t.setFooterLinks=function(e){return function(t){t({type:"SetFooterLinks",footerLinks:e})}},t.updateState=function(e){return{type:"UpdateState",props:e}},t.updateSelectedPlan=function(e,t){return function(a,r){a(i(2,e,t)),a(n.updateProductPlanType(e));var o=r().pricingState;o.baseSubChangePlans&&a(s(o.baseSubChangePlans))}},t.loadSubChangePlans=s,t.openSurvey=function(e){return{type:"OpenSurvey",defaultValue:e}},t.cancelSurvey=function(e){return{type:"CancelSurvey",defaultValue:e}},t.submitSurvey=function(e,t,a){return{type:"SubmitSurvey",defaultValue:e,value:t,other:a}}})),define("modules/clean/react/payments/buy/actions/pricing_actions",["require","exports","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_service","modules/clean/react/growth_pages/promo/types","modules/clean/api_v2/default_user_client","modules/clean/api_v2/noauth_client","modules/clean/viewer","modules/clean/react/payments/buy/types/types"],(function(e,t,a,r,n,o,i,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=new r.SubscriptionService,l=0;function p(){return function(e,t){return t().pageState.useRevenueApi?(function(e,t){e({type:"UpdateTransitionsStart"});var a=t().formData,r=s.Viewer.get_viewer().get_user_by_role("personal"),n=r?new o.DefaultUserApiV2Client(r):new i.NoAuthApiV2Client,c={customer_criteria:{tax_info:{vat_id:a.vat.errorState?"":a.vat.formattedValue,postal_code:a.zipCode.formattedValue,country_code:a.countryCode.formattedValue}},plan_selection_criteria:{product_lines:[{".tag":u.ProductLine.DROPBOX_FILE_SHARING}],plan_families:[{".tag":u.ProductFamily.PLUS},{".tag":u.ProductFamily.PROFESSIONAL}],contract_length:[{unit:{".tag":u.ContractLengthUnitType.MONTH},quantity:1},{unit:{".tag":u.ContractLengthUnitType.YEAR},quantity:1}],include_trials:!1,include_paid:!0},locations:[{".tag":u.RevenueContentLocation.BUY_CHECKOUT},{".tag":u.RevenueContentLocation.BUY}]};l=Math.random()*Number.MAX_VALUE,n.ns("storefront_self_serve").rpc("get_plan_data",c,{}).then((p=l,function(t){l===p&&(e(m(void 0,t)),e(f()))}));var p})(e,t):(function(e,t){var r=t(),o=r.formData,i=r.pricingState,s=r.pageState,u={countryCode:o.countryCode.formattedValue,zipCode:o.zipCode.formattedValue,vat:o.vat.errorState?"":o.vat.formattedValue};if(e({type:"UpdateTransitionsStart"}),!i.subChangePlans)return void e({type:"HasPendingUpdate"});var l=i.subChangePlans.map((function(e){return a.SubscriptionDiff.fromSubscriptionStatus(e)})),p=s.promoSpec&&s.promoSpec.cashCode&&s.promoSpec.id!==n.PromoSpecType.TRIAL?{cashCode:s.promoSpec.cashCode}:void 0;c.priceSet(l,u,p,!0).then((function(t){e(m(t)),e(_(t)),e(f(t))})).catch((function(t){e(y(t))}))})(e,t)}}function d(){return{type:"UpdateTransitionsStart"}}function m(e,t){return{type:"UpdateTransitionsSuccess",subChangePlans:e,revenueApiPlanInfo:t}}function y(e){return{type:"UpdateTransitionsError",error:e}}function _(e){return{type:"UpdateDisplayPrices",subChangePlans:e}}function f(e){return{type:"UpdateCurrentTransitionPrices",subChangePlans:e}}function g(){return{type:"HasPendingUpdate"}}t.updatePrice=p,t.updateTransitionsStart=d,t.updateTransitionsSuccess=m,t.updateTransitionsError=y,t.updateDisplayPrices=_,t.updateCurrentTransitionPrices=f,t.hasPendingUpdate=g,t.actionCreators={updatePrice:p,updateTransitionsStart:d,updateTransitionsSuccess:m,updateTransitionsError:y,updateDisplayPrices:_,updateCurrentTransitionPrices:f,hasPendingUpdate:g}})),define("modules/clean/react/payments/buy/helpers/preauth",["require","exports","modules/clean/ajax_as_promised"],(function(e,t,a){"use strict";function r(e,t){return void 0===t&&(t=!0),a.WebRequest({url:"/pro/ajax_preauth",data:{user_id:e,enabled:t},type:"POST"})}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){return r(e)},t.deactivate=function(){return r(null,!1)}})),define("modules/clean/react/payments/buy/state/pro_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/payments/payment_form/payment_form_spec","modules/clean/redux/unsupported","modules/clean/redux/devtools","modules/clean/react/payments/buy/actions/pricing_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/react/payments/buy/helpers/preauth","modules/clean/react/payments/buy/helpers/pricing_value_helper","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/constants","modules/clean/react/payments/common/middleware/pro_buy_logger","modules/clean/react/payments/common/form_value_factory","modules/core/browser","modules/core/notify","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/logging/hive/schemas/web-payments_ux_analytics"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m,y,_,f,g,h,S,P){"use strict";function v(e){return function(t){return function(a){if("SubmitFormError"!==a.type)return t(a);var r=t(a),n=e.getState().pageState;return a.data&&a.data.error_message&&g.Notify.error(a.data.error_message),a.data.redirect&&f.redirect(a.data.redirect),null==n.suggestedUser||n.showCreateAccount||l.deactivate(),r}}}function b(e){var t=C(e),a=T(e,t);return{pageState:t,pricingState:F(e,a),formData:a,navState:(function(e){var t=e.navState;return t||{currentStep:0,productPlanType:0,showTrialVersion:!1}})(e)}}function C(e){var t=e.autocompleteForm,a=e.isServerView,r=e.locale,n=e.userInfo,i=e.serializedPaymentFormSpec,s=e.suggestedUser,u=e.showPlanSwitchRadios,c=e.preauthUser,l=e.optimizeCpf,p=e.requestId,d=e.footerLinks,m=e.promoSpec,y=e.useRevenueApi,_=e.plansContent,f=e.marketingTracker;return{autocomplete:t,locale:r,userInfo:n,existingAccountShowing:n.existingAccount,paymentFormSpec:new o.PaymentFormSpec(i),submitFormSuccess:!1,hasFormError:!1,isServerView:"ON"===a,suggestedUser:s,showCreateAccount:!1,showPlanSwitchRadios:u,preauthUser:c,optimizeCpf:l,requestId:p,submitSeq:0,footerLinks:d,submitting:!1,promoSpec:m,isPaymentOptionsSurveyOpen:!1,paymentFormErrorsExperiment:e.paymentFormErrorsExperiment,showBuyClickError:!1,showCpf:e.showCpf,psd2AddressFields:e.psd2AddressFields,useRevenueApi:y,plansContent:_,marketingTracker:f}}function T(e,t){var a=e.countryCode,r=e.userInfo,n=e.vat,o=e.trialLength,i=e.showTrialVersion,s=e.locale,u=r.fname||"",c=r.lname||"",l="";r.existingAccount||(l=r.email||"");var p,d=r.password||"",y=m.ScheduleId.YEARLY,f=e.productPlanType||m.ProductPlanType.STANDARD;p=i?t.paymentFormSpec.default_payment_method():t.paymentFormSpec.default_payment_method_for_country(a);var g=n||"";return{city:_.FormValueFactory.createCity(""),phone:_.FormValueFactory.createPhone(""),name:_.FormValueFactory.createName(""),address:_.FormValueFactory.createAddress(""),nonce:_.FormValueFactory.createNonce(""),adyenEncryptedCard:_.FormValueFactory.createAdyenEncryptedCard(""),encryptedCardForNetworkToken:_.FormValueFactory.createEncryptedCardForNetworkToken("",""),bin:_.FormValueFactory.createBIN(""),browserInfo:_.FormValueFactory.createBrowserInfo(""),threeDsData:_.FormValueFactory.createThreeDsData(""),firstName:_.FormValueFactory.createInput(u),lastName:_.FormValueFactory.createInput(c),email:_.FormValueFactory.createEmail(l),password:_.FormValueFactory.createPassword(d),productPlanType:_.FormValueFactory.createProductPlanType(f),scheduleId:_.FormValueFactory.createSchedule(y),paymentMethod:_.FormValueFactory.createPaymentMethod(p,a,t.paymentFormSpec),countryCode:_.FormValueFactory.createCountryCode(a),zipCode:_.FormValueFactory.createZipCode("",a,t.paymentFormSpec),vat:_.FormValueFactory.createVat(g,a),cpf:_.FormValueFactory.createCpf("",void 0,t.optimizeCpf),cpfName:_.FormValueFactory.createCpfNamePrefill("","",r.displayName,void 0,t.optimizeCpf),accountHolderName:_.FormValueFactory.createInput(""),iban:_.FormValueFactory.createIBAN(""),mandateSigned:_.FormValueFactory.createCheckbox(!1),idealBankId:_.FormValueFactory.createIdealBankId(""),idealBankName:_.FormValueFactory.createIdealBankName(""),termsAndService:_.FormValueFactory.createCheckbox(!1),evh:_.FormValueFactory.createCheckbox(!1),trialEndDate:_.FormValueFactory.createTrialEndDate(o,s),selectedUser:_.FormValueFactory.createUserSelection(),preauthUser:_.FormValueFactory.createUserSelection()}}function F(e,t){return e.useRevenueApi?(function(){var a=t.productPlanType.formattedValue;a!==m.ProductPlanType.PLUS&&a!==m.ProductPlanType.PROFESSIONAL&&(a=m.ProductPlanType.PROFESSIONAL);var r=t.scheduleId.formattedValue===m.ScheduleId.YEARLY?"priceAnnual":(t.scheduleId.formattedValue,m.ScheduleId.MONTHLY,"priceMonthly"),n=e.plansContent[a][r];return{hasCurrencyChanged:!1,loadingPrices:!1,requestToken:-1,pendingUpdate:!1,displayPrices:{},currentTransitionPrices:{},revenueApiPrice:n.priceCharged,revenueApiCurrency:n.currency,revenueApiProductCode:n.productCode,revenueApiPricingToken:n.pricingToken,revenueApiTaxLines:n.taxLines,revenueApiMarketingTrackerData:n.marketingTrackerData}})():(function(){var a,r=e.baseSubChangePlans,n=e.serializedSubChangePlans;r?a=r.filter((function(t){return t.subState.planSku&&e.navState&&t.subState.planSku.productType===e.navState.productPlanType})):n&&(a=n.map((function(e){return d.SubscriptionChangePlan.deserialize(e)})));var o=p.getDisplayPrices(a,t,e.promoSpec),i=p.getCurrentTransitionPrices(a,t);return{hasCurrencyChanged:!1,loadingPrices:void 0===a,requestToken:-1,subChangePlans:a,baseSubChangePlans:r,pendingUpdate:!1,displayPrices:o,currentTransitionPrices:i}})()}Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),o=a.__importStar(o),l=a.__importStar(l),t.submitFormErrorMiddleware=v,t.configureStore=function(e,t){var a=b(e),o=e.useRevenueApi?P.PaymentsUxPlatform.RevenueAPI:P.PaymentsUxPlatform.Legacy,s=r.applyMiddleware(n.default,y.proBuyLogger,new h.PaymentsUXLogger(e.requestId,o).reduxMiddleware,S.marketingEventMiddleware,v);return i.createStore(t,a,r.compose(s))},t.createState=b,t.createPageState=C,t.createFormState=T,t.createPricingState=F})),define("modules/clean/react/payments/buy/reducers/form_value_reducers",["require","exports","tslib","external/lodash","modules/clean/react/payments/common/form_values","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/form_value_factory","modules/clean/react/payments/common/payments/reducers/reducers","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/buy/actions/buy_form_actions"],(function(e,t,a,r,n,o,i,s,u,c){"use strict";function l(e,t){var a=r.assignIn({},e.formData,t),n=e.pageState.showBuyClickError;if("ON"===e.pageState.paymentFormErrorsExperiment){var o=c.getFieldNamesToValidate(a,e.pageState.paymentFormSpec,e.pageState.existingAccountShowing,e.pageState.psd2AddressFields,e.pageState.showCpf);n=e.pageState.showBuyClickError&&!u.isValidSubmitState(a,o)}var i=r.assignIn({},e.pageState,{hasFormError:!1,showBuyClickError:n});return r.assignIn({},e,{formData:a,pageState:i})}function p(e,t){return"UpdateFirstName"!==t.type?e:l(e,{firstName:i.FormValueFactory.createInput(t.value,e.formData.firstName)})}function d(e,t){return"UpdateLastName"!==t.type?e:l(e,{lastName:i.FormValueFactory.createInput(t.value,e.formData.lastName)})}function m(e,t){if("EmailTakenError"!==t.type)return e;var a=e.formData.email;return a.errorState=n.EmailErrorState.Taken,a.showError=!0,l(e,{email:a})}function y(e,t){return"UpdateEmail"!==t.type?e:l(e,{email:i.FormValueFactory.createEmail(t.value,e.formData.email)})}function _(e,t){return"UpdatePassword"!==t.type?e:l(e,{password:i.FormValueFactory.createPassword(t.value,e.formData.password)})}function f(e,t){var a=e.formData.firstName.rawValue,r=e.formData.lastName.rawValue,n=e.pageState.userInfo.displayName,o=e.pageState.optimizeCpf;switch(t.type){case"UpdateCpfName":return l(e,{cpfName:i.FormValueFactory.createCpfName(t.value,e.formData.cpfName,o)});case"UpdateFirstName":return e.formData.cpfName.manuallyEdited?e:l(e,{cpfName:i.FormValueFactory.createCpfNamePrefill(t.value,r,n,void 0,o)});case"UpdateLastName":return e.formData.cpfName.manuallyEdited?e:l(e,{cpfName:i.FormValueFactory.createCpfNamePrefill(a,t.value,n,void 0,o)});default:return e}}function g(e,t){if("ToggleNewAccount"!==t.type)return e;var a={};return t.show?a={selectedUser:i.FormValueFactory.createUserSelection()}:e.pageState.preauthUser||(a={firstName:i.FormValueFactory.createInput(""),lastName:i.FormValueFactory.createInput(""),email:i.FormValueFactory.createEmail(""),password:i.FormValueFactory.createPassword("")}),l(e,a)}function h(e,t){return"UpdateSelectedUser"!==t.type?e:l(e,{selectedUser:i.FormValueFactory.createUserSelection(t.value)})}function S(e,t){return"UpdateProductPlanType"!==t.type?e:l(e,{productPlanType:i.FormValueFactory.createProductPlanType(t.value)})}function P(e,t){return"UpdateSchedule"!==t.type?e:l(e,{scheduleId:i.FormValueFactory.createSchedule(t.value,e.formData.scheduleId)})}function v(e,t){return"UpdateEVH"!==t.type?e:l(e,{evh:i.FormValueFactory.createCheckbox(t.value,e.formData.evh)})}function b(e,t){if("UpdateAddress"!==t.type)return e;var a="UpdateAddress"===t.type?t.value:e.formData.address.rawValue;return l(e,{address:i.FormValueFactory.createAddress(a,e.formData.address)})}function C(e,t){if("UpdatePhone"!==t.type)return e;var a="UpdatePhone"===t.type?t.value:e.formData.phone.rawValue;return l(e,{phone:i.FormValueFactory.createPhone(a,e.formData.phone)})}function T(e,t){if("UpdateName"!==t.type)return e;var a="UpdateName"===t.type?t.value:e.formData.name.rawValue;return l(e,{name:i.FormValueFactory.createName(a,e.formData.name)})}function F(e,t){if("UpdateCity"!==t.type)return e;var a="UpdateCity"===t.type?t.value:e.formData.city.rawValue;return l(e,{city:i.FormValueFactory.createCity(a,e.formData.city)})}function w(e,t){if("UpdatePaymentMethod"!==t.type&&"UpdateCountryCode"!==t.type)return e;var a=e.formData,r=e.pageState,n="UpdatePaymentMethod"===t.type?t.value:a.paymentMethod.rawValue,o=a.countryCode.formattedValue;return l(e,{paymentMethod:i.FormValueFactory.createPaymentMethod(n,o,r.paymentFormSpec,a.paymentMethod)})}function E(e,t){return"UpdateCountryCode"!==t.type?e:l(e,{countryCode:i.FormValueFactory.createCountryCode(t.value,e.formData.countryCode)})}function N(e,t){if("UpdateZipCode"!==t.type&&"UpdateCountryCode"!==t.type)return e;var a="UpdateZipCode"===t.type?t.value:e.formData.zipCode.rawValue,r=e.formData.countryCode.formattedValue;return l(e,{zipCode:i.FormValueFactory.createZipCode(a,r,e.pageState.paymentFormSpec,e.formData.zipCode)})}function k(e,t){if("UpdateVat"!==t.type&&"UpdateCountryCode"!==t.type)return e;var a="UpdateVat"===t.type?t.value.toUpperCase():e.formData.vat.rawValue,r=e.formData.countryCode.formattedValue;return l(e,{vat:i.FormValueFactory.createVat(a,r,e.formData.vat)})}function A(e,t){if("UpdateCpf"!==t.type)return e;var a=e.pageState.optimizeCpf;return l(e,{cpf:i.FormValueFactory.createCpf(t.value,e.formData.cpf,a)})}function x(e,t){return"UpdateNonce"!==t.type?e:l(e,{nonce:i.FormValueFactory.createNonce(t.value,t.creditCardIframeFields,e.formData.nonce,e.pageState.paymentFormErrorsExperiment)})}function U(e,t){return"UpdateBIN"!==t.type?e:l(e,{bin:i.FormValueFactory.createBIN(t.value,e.formData.bin)})}function V(e,t){return"UpdateAccountHolderName"!==t.type?e:l(e,{accountHolderName:i.FormValueFactory.createInput(t.value,e.formData.accountHolderName)})}function I(e,t){return"UpdateIBAN"!==t.type?e:l(e,{iban:i.FormValueFactory.createIBAN(t.value,e.formData.iban)})}function D(e,t){return"UpdateMandateSigned"!==t.type?e:l(e,{mandateSigned:i.FormValueFactory.createCheckbox(t.value,e.formData.mandateSigned)})}function L(e,t){return"UpdateTermsAndService"!==t.type?e:l(e,{termsAndService:i.FormValueFactory.createCheckbox(t.value,e.formData.termsAndService)})}function R(e,t){if("UpdateIdealBank"!==t.type)return e;var a=t.value,r=a.bankId,n=a.bankName;return l(e,{idealBankId:i.FormValueFactory.createIdealBankId(r,e.formData.idealBankId),idealBankName:i.FormValueFactory.createIdealBankName(n,e.formData.idealBankName)})}Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),n=a.__importStar(n),t.AccountReducers=[p,d,y,_,f,h,g,m],t.PlanReducers=[S,P,v],t.PaymentReducers=[E,w,N,k,A,f,x,s.updateAdyenEncryptedCard,s.updateEncryptedCardForNetworkToken,U,s.updateBrowserInfo,s.updateThreeDsData,V,I,D,R,F,b,C,T],t.OrderSummaryReducers=[L],t.FormInputReducers=[M,B,H,q],t.updateFirstName=p,t.updateLastName=d,t.emailAlreadyTakenError=m,t.updateEmail=y,t.updatePassword=_,t.updateCpfName=f,t.toggleNewAccount=g,t.updateUserSelection=h,t.updateProductPlanType=S,t.updateSchedule=P,t.updateEVH=v,t.updateAddress=b,t.updatePhone=C,t.updateName=T,t.updateCity=F,t.updatePaymentMethod=w,t.updateCountryCode=E,t.updateZipCode=N,t.updateVat=k,t.updateCpf=A,t.updateNonce=x,t.updateBIN=U,t.updateAccountHolderName=V,t.updateIBAN=I,t.updateMandateSigned=D,t.updateTOS=L,t.updateIdealBank=R;var O={firstName:"fname",lastName:"lname",email:"account-email",password:"password",name:"name",nonce:"iframe-holder",countryCode:"country_code",address:"address",zipCode:"zip",city:"city",accountHolderName:"owner_name",iban:"iban",mandateSigned:"mandate_signed",idealBankId:"ideal_bank",vat:"vat",cpf:"cpf"};function M(e,t){if("ShowFormFieldErrors"!==t.type)return e;var n=!1,i=a.__assign({},e.formData);e=r.assignIn({},e,{formData:i});for(var s,u=[],c=0,l=t.fieldNames;c<l.length;c++){var p=l[c],d=i[p];d&&!o.FormValueHelper.isValid(d)&&(i[p]=r.assignIn({},i[p],{showError:!0}),n=!0,u.push(p))}var m=e.pageState.showBuyClickError;if("ON"===e.pageState.paymentFormErrorsExperiment&&"SubmitForm"===t.origin){m=!0;for(var y=0,_=u;y<_.length;y++){var f=_[y];if(O[f]){var g=document.getElementById(O[f]);if(g){var h=g.getBoundingClientRect().top;void 0===s?s=h:h<s&&(s=h)}}}void 0!==s&&scrollBy({top:s-150,behavior:"smooth"})}var S=r.assignIn({},e.pageState,{hasFormError:n,showBuyClickError:m});return e=r.assignIn({},e,{pageState:S})}function B(e,t){if("SubmitFormStart"!==t.type)return e;var a=r.assignIn({},e.pageState,{submitting:!0,submitSeq:e.pageState.submitSeq+1});return r.assignIn({},e,{pageState:a})}function H(e,t){if("SubmitFormSuccess"!==t.type)return e;var r;if(e.pageState.isServerView&&void 0!==t.data&&void 0!==t.data.data){var n=t.data.data;r={userQuota:n.user_quota,userQuotaUsage:n.user_quota_usage}}return a.__assign(a.__assign({},e),{pageState:a.__assign(a.__assign({},e.pageState),{submitFormSuccess:!0,submitting:!1,newQuotaInfo:r})})}function q(e,t){if("SubmitFormError"!==t.type)return e;var a=r.assignIn({},e.pageState,{submitting:!1});return r.assignIn({},e,{pageState:a})}t.showFormFieldErrors=M,t.submitFormStart=B,t.submitFormSuccess=H,t.submitFormError=q})),define("modules/clean/react/payments/buy/reducers/page_reducers",["require","exports","tslib"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.existingAccountShowing=function(e,t){switch(void 0===e&&(e=!1),t.type){case"ToggleNewAccount":return!e;case"ToggleSignInModal":return(function(e,t){return void 0!==t.show?t.show:!e})(e,t);default:return e}},t.showCreateAccount=function(e,t){return void 0===e&&(e=!1),"ToggleNewAccount"!==t.type?e:void 0!==t.show?t.show:!e},t.footerLinks=function(e,t){return void 0===e&&(e=[]),"SetFooterLinks"!==t.type?e:a.__spreadArrays(t.footerLinks)},t.isPaymentOptionsSurveyOpen=function(e,t){switch(void 0===e&&(e=!1),t.type){case"OpenSurvey":return!0;case"CancelSurvey":case"SubmitSurvey":return!1;default:return e}}})),define("modules/clean/react/payments/buy/reducers/pricing_reducers",["require","exports","tslib","modules/clean/payments/skus/constants","external/lodash","modules/clean/react/payments/buy/helpers/pricing_value_helper","modules/clean/react/payments/buy/types/types"],(function(e,t,a,r,n,o,i){"use strict";function s(e,t){if("UpdateTransitionsStart"!==t.type)return e;var a=n.assignIn({},e.pricingState,{loadingPrices:!0});return n.assignIn({},e,{pricingState:a})}function u(e,t){return"UpdateTransitionsSuccess"!==t.type?e:e.pageState.useRevenueApi?(function(){var n,o=t.revenueApiPlanInfo.plans,s={plus:{yearly:null,monthly:null},professional:{yearly:null,monthly:null}};for(var u in o){var c=o[u].product_defining_details;c.product_family[".tag"]===i.ProductFamily.PLUS&&c.contract_length.unit[".tag"]===i.ContractLengthUnitType.MONTH&&1===c.contract_length.quantity?s.plus.monthly=a.__assign(a.__assign({},o[u]),{productCode:u}):c.product_family[".tag"]===i.ProductFamily.PLUS&&c.contract_length.unit[".tag"]===i.ContractLengthUnitType.YEAR&&1===c.contract_length.quantity?s.plus.yearly=a.__assign(a.__assign({},o[u]),{productCode:u}):c.product_family[".tag"]===i.ProductFamily.PROFESSIONAL&&c.contract_length.unit[".tag"]===i.ContractLengthUnitType.MONTH&&1===c.contract_length.quantity?s.professional.monthly=a.__assign(a.__assign({},o[u]),{productCode:u}):c.product_family[".tag"]===i.ProductFamily.PROFESSIONAL&&c.contract_length.unit[".tag"]===i.ContractLengthUnitType.YEAR&&1===c.contract_length.quantity&&(s.professional.yearly=a.__assign(a.__assign({},o[u]),{productCode:u}))}var l=a.__assign(a.__assign({},e.pageState),{plansContent:a.__assign(a.__assign({},e.pageState.plansContent),(n={},n[r.ProductPlanType.PLUS]=a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PLUS]),{name:s.plus.yearly.plan_content.display_name,namePrefixedWithDropbox:s.plus.yearly.plan_content.dropbox_display_name,priceAnnual:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PLUS].priceAnnual),{price:s.plus.yearly.plan_content.advertized_contract_length_price,priceCharged:s.plus.yearly.plan_content.total_price_charged,priceAsMonthly:s.plus.yearly.plan_content.advertized_monthly_price,withoutSavings:"",currency:s.plus.yearly.plan_content.currency,productCode:s.plus.yearly.productCode,pricingToken:s.plus.yearly.pricing_token,taxLines:s.plus.yearly.plan_content.tax_lines,marketingTrackerData:s.plus.yearly.plan_content.marketing_tracker_data}),priceMonthly:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PLUS].priceMonthly),{price:s.plus.monthly.plan_content.advertized_contract_length_price,priceCharged:s.plus.monthly.plan_content.total_price_charged,currency:s.plus.monthly.plan_content.currency,productCode:s.plus.monthly.productCode,pricingToken:s.plus.monthly.pricing_token,taxLines:s.plus.monthly.plan_content.tax_lines,marketingTrackerData:s.plus.monthly.plan_content.marketing_tracker_data}),quota:s.plus.yearly.plan_content.advertized_space_long,reasons:s.plus.yearly.location_feature_list_map[i.RevenueContentLocation.BUY].features.map((function(e){return{text:e}})),included:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PLUS].included),{items:s.plus.yearly.location_feature_list_map[i.RevenueContentLocation.BUY_CHECKOUT].features.map((function(e){return{text:e}}))})}),n[r.ProductPlanType.PROFESSIONAL]=a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PROFESSIONAL]),{name:s.professional.yearly.plan_content.display_name,namePrefixedWithDropbox:s.professional.yearly.plan_content.dropbox_display_name,priceAnnual:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PROFESSIONAL].priceAnnual),{price:s.professional.yearly.plan_content.advertized_contract_length_price,priceCharged:s.professional.yearly.plan_content.total_price_charged,priceAsMonthly:s.professional.yearly.plan_content.advertized_monthly_price,withoutSavings:s.professional.monthly.plan_content.advertized_yearly_price,savings:s.professional.yearly.plan_content.advertized_yearly_price_savings,currency:s.professional.yearly.plan_content.currency,productCode:s.professional.yearly.productCode,pricingToken:s.professional.yearly.pricing_token,taxLines:s.professional.yearly.plan_content.tax_lines,marketingTrackerData:s.professional.yearly.plan_content.marketing_tracker_data}),priceMonthly:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PROFESSIONAL].priceMonthly),{price:s.professional.monthly.plan_content.advertized_contract_length_price,priceCharged:s.professional.monthly.plan_content.total_price_charged,currency:s.professional.monthly.plan_content.currency,productCode:s.professional.monthly.productCode,pricingToken:s.professional.monthly.pricing_token,taxLines:s.professional.monthly.plan_content.tax_lines,marketingTrackerData:s.professional.monthly.plan_content.marketing_tracker_data}),quota:s.professional.yearly.plan_content.advertized_space_long,reasons:s.professional.yearly.location_feature_list_map[i.RevenueContentLocation.BUY].features.map((function(e){return{text:e}})),included:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PROFESSIONAL].included),{items:s.professional.yearly.location_feature_list_map[i.RevenueContentLocation.BUY_CHECKOUT].features.map((function(e){return{text:e}}))})}),n))}),p=a.__assign(a.__assign({},e.pricingState),{loadingPrices:!1,pendingUpdate:!1});return a.__assign(a.__assign({},e),{pageState:l,pricingState:p})})():(function(){var a,r=!1;if(t.subChangePlans&&(a=t.subChangePlans,e.pricingState.subChangePlans)){var o=e.pricingState.subChangePlans[0].tvm,i=a[0].tvm,s=o&&o.getCurrency(),u=i&&i.getCurrency();r=e.pricingState.hasCurrencyChanged||s!==u}var c=n.assignIn({},e.pricingState,{loadingPrices:!1,hasCurrencyChanged:r,subChangePlans:t.subChangePlans,pendingUpdate:!1});return n.assignIn({},e,{pricingState:c})})()}function c(e,t){if("UpdateDisplayPrices"!==t.type)return e;var a,r,i,s,u=e.pageState.useRevenueApi;return void 0!==u&&u?e:(a=e.pageState.promoSpec,r=t.subChangePlans||e.pricingState.subChangePlans,i=o.getDisplayPrices(r,e.formData,a),s=n.assignIn({},e.pricingState,{displayPrices:i}),n.assignIn({},e,{pricingState:s}))}function l(e,t){if("UpdateCurrentTransitionPrices"!==t.type)return e;var i,s,u,c=e.pageState.useRevenueApi;return void 0!==c&&c?(function(){var t=e.formData.productPlanType.formattedValue;t!==r.ProductPlanType.PLUS&&t!==r.ProductPlanType.PROFESSIONAL&&(t=r.ProductPlanType.PROFESSIONAL);var n=e.formData.scheduleId.formattedValue===r.ScheduleId.YEARLY?"priceAnnual":(e.formData.scheduleId.formattedValue,r.ScheduleId.MONTHLY,"priceMonthly"),o=e.pageState.plansContent[t][n],i=a.__assign(a.__assign({},e.pricingState),{hasCurrencyChanged:e.pricingState.revenueApiCurrency!==o.currency,revenueApiPrice:o.priceCharged,revenueApiCurrency:o.currency,revenueApiProductCode:o.productCode,revenueApiPricingToken:o.pricingToken,revenueApiTaxLines:o.taxLines,revenueApiMarketingTrackerData:o.marketingTrackerData});return a.__assign(a.__assign({},e),{pricingState:i})})():(i=t.subChangePlans||e.pricingState.subChangePlans,s=o.getCurrentTransitionPrices(i,e.formData),u=n.assignIn({},e.pricingState,{currentTransitionPrices:s}),n.assignIn({},e,{pricingState:u}))}function p(e,t){if("HasPendingUpdate"!==t.type)return e;var a=n.assignIn({},e.pricingState,{pendingUpdate:!0});return n.assignIn({},e,{pricingState:a})}Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),t.TransitionManagementReducers=[s,u],t.PricingManagementReducers=[p,c,l],t.updateTransitionsStart=s,t.updateTransitionsSuccess=u,t.updateDisplayPrices=c,t.updateCurrentTransitionPrices=l,t.hasPendingUpdate=p})),define("modules/clean/react/payments/buy/reducers/nav_reducer",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navReducer=function(e,t){return"UpdateCurrentPage"!==t.type?e:{currentStep:t.step,productPlanType:t.productPlanType,showTrialVersion:t.showTrialVersion}}})),define("modules/clean/react/payments/buy/reducers/reducers",["require","exports","tslib","redux","modules/clean/react/payments/buy/reducers/form_value_reducers","modules/clean/react/payments/buy/reducers/pricing_reducers","modules/clean/react/payments/buy/reducers/page_reducers","modules/clean/react/payments/buy/reducers/nav_reducer","modules/clean/react/payments/buy/state/pro_store_creator"],(function(e,t,a,r,n,o,i,s,u){"use strict";function c(e){return function(t,a){return Object.assign({},t,e(t,a))}}function l(e,t){return"UpdateState"!==t.type?e:u.createState(t.props)}function p(e,t){if("LoadSubChangePlans"!==t.type)return e;var r=a.__assign({},e.pricingState);return r.baseSubChangePlans=t.baseSubChangePlans,r.subChangePlans=t.baseSubChangePlans.filter((function(t){return t.subState.planSku&&t.subState.planSku.productType===e.navState.productPlanType})),a.__assign(a.__assign({},e),{pricingState:a.__assign({},r)})}Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),o=a.__importStar(o),t.updateState=l,t.loadSubChangePlans=p,t.proBuyReducer=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(a,r){return t(e(a,r),r)}}))}.apply(void 0,a.__spreadArrays([r.combineReducers({formData:function(e,t){return void 0===e&&(e={}),e},pageState:c(r.combineReducers({existingAccountShowing:i.existingAccountShowing,footerLinks:i.footerLinks,showCreateAccount:i.showCreateAccount,isPaymentOptionsSurveyOpen:i.isPaymentOptionsSurveyOpen})),pricingState:function(e,t){return void 0===e&&(e={}),e},navState:c(s.navReducer)}),l,p],n.AccountReducers,n.PlanReducers,n.PaymentReducers,n.OrderSummaryReducers,n.FormInputReducers,o.TransitionManagementReducers,o.PricingManagementReducers))})),define("modules/clean/react/payments/buy/types/types",["require","exports","tslib","modules/clean/payments/skus/constants","modules/core/exception"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),(function(e){e.PROFESSIONAL="PROFESSIONAL",e.PLUS="PLUS"})(t.BuyPagePlanTiers||(t.BuyPagePlanTiers={})),t.getPlanContentFromMap=function(e,t){return t!==r.ProductPlanType.PLUS&&t!==r.ProductPlanType.PROFESSIONAL&&(n.reportException({err:new Error("Unsupported plan type "+t),severity:n.SEVERITY.CRITICAL}),t=r.ProductPlanType.PROFESSIONAL),e.plansByType?e.plansByType[t]:t===r.ProductPlanType.PLUS?e.plans.Plus:e.plans.Professional},(function(e){e.DROPBOX_FILE_SHARING="dropbox_file_sharing",e.HELLO_SIGN="hello_sign",e.UNKNOWN_PRODUCT_LINE="unknown_product_line"})(t.ProductLine||(t.ProductLine={})),(function(e){e.PLUS="plus",e.PROFESSIONAL="professional",e.STANDARD="standard",e.ADVANCED="advanced",e.SERVER="server",e.ENTERPRISE="enterprise",e.EDUCATION="education",e.ANY_PRODUCT_FAMILY="any_product_family"})(t.ProductFamily||(t.ProductFamily={})),(function(e){e.DAY="day",e.MONTH="month",e.YEAR="year",e.UNKNOWN_CONTRACT_LENGHTH_UNIT="unknown_contract_length_unit"})(t.ContractLengthUnitType||(t.ContractLengthUnitType={})),(function(e){e.USER="user",e.TEAM="team",e.RESELLER_TEAM="reseller_team",e.UNKNOWN="unknown"})(t.CustomerType||(t.CustomerType={})),(function(e){e.BUY="buy",e.BUY_CHECKOUT="buy_checkout",e.UNKNOWN="unknown"})(t.RevenueContentLocation||(t.RevenueContentLocation={}))}));
//# sourceMappingURL=pkg-buy.min.js-vflWvxoyc.map