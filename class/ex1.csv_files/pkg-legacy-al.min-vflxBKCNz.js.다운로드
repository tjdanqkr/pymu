define("modules/clean/react/dbox_app_promo",["require","exports","tslib","classnames","create-react-class","react","react-dom-factories","prop-types","modules/clean/react/button","modules/clean/react/image","modules/clean/static_urls"],(function(e,t,a,s,r,i,n,o,m,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),r=a.__importDefault(r),i=a.__importDefault(i),n=a.__importStar(n),o=a.__importStar(o),m=a.__importStar(m),t.DboxAppFeatureList=void 0,t.DboxAppPromoSection=void 0;var u=i.default.createElement,p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e={"dbox-app-promo-container":!0};return this.props.className&&(e[this.props.className]=!0),n.div({className:s.default(e)},n.div({className:"dbox-app-promo-title"},this.props.title),n.div({className:"dbox-app-promo"},this.props.children))},t.displayName="DboxAppPromo",t.propTypes={title:o.string,className:o.string},t})(i.default.Component);t.DboxAppPromo=p;var d=r.default({displayName:"Actionable",propTypes:{handler:o.func,progressMapper:o.func},getDefaultProps:function(){return{handler:function(){},progressMapper:function(e,t){return{disabled:e||t.disabled}}}},getInitialState:function(){return{inProgress:!1}},onClick:function(){var e=this;if(!this.state.inProgress){var t="function"==typeof this.props.handler?this.props.handler():void 0;return t&&"function"==typeof t.complete?(this.setState({inProgress:!0}),t.complete((function(){if(e.isMounted())return e.setState({inProgress:!1})}))):void 0}},render:function(){var e,t={};for(var a in this.props)e=this.props[a],["handler","children","progressMapper"].includes(a)||(t[a]=e);t.onClick=this.onClick,t.inProgress=this.state.inProgress;var s=this.props.progressMapper(this.state.inProgress,t);for(var a in s)e=s[a],t[a]=e;return i.default.cloneElement(i.default.Children.only(this.props.children),t)}});t.Actionable=d;var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return n.div({className:"dbox-app-promo-banner"},n.div({className:"dbox-app-promo-banner-body"},n.div({className:"dbox-app-promo-banner-title"},this.props.title),n.div({className:"dbox-app-promo-banner-description"},this.props.description)),n.div({className:"dbox-app-promo-banner-buttons"},Array.from(this.props.buttons).map((function(e,t){return n.span({className:"dbox-app-promo-banner-button",key:"button-"+t},u(d,{handler:e.handler},u(m.button,{importance:"tertiary"},e.text)))}))),n.div({className:"clear"}))},t.displayName="DboxAppPromoBanner",t.propTypes={title:o.string,description:o.string,buttons:o.arrayOf(o.shape({text:o.string,handler:o.func}))},t})(i.default.Component);t.DboxAppPromoBanner=_;var h=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return n.div({className:"dbox-app-promo-3pane"},n.div({className:"dbox-app-promo-grid"},Array.from(this.props.columns).map((function(e,t){return n.div({className:"dbox-app-promo-grid-column",key:"c_"+t},e.imageSource&&e.imageSourceHiRes?n.div({className:"pane-image"},u(l.Image,{src:c.static_url(e.imageSource),srcHiRes:c.static_url(e.imageSourceHiRes)})):void 0,e.title?n.div({className:"pane-title"},e.title):void 0,n.div({className:"pane-text"},e.text))}))))},t.displayName="DboxAppPromoGrid",t.propTypes={columns:o.arrayOf(o.shape({title:o.string,text:o.string,imageSource:o.string,imageSourceHiRes:o.string}))},t.defaultProps={columns:[]},t})(i.default.Component);t.DboxAppPromoGrid=h;var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=s.default({"dbox-app-promo-image-text-pane":!0,"dbox-app-promo-image-text-image-pane":!0,"primary-position":this.props.isImagePrimary,"secondary-position":!this.props.isImagePrimary}),t=s.default({"dbox-app-promo-image-text-pane":!0,"dbox-app-promo-image-text-content-pane":!0,"primary-position":!this.props.isImagePrimary,"secondary-position":this.props.isImagePrimary});return n.div({className:"dbox-app-promo-image-text"},n.div({className:e},u(l.Image,{src:c.static_url(this.props.imageSource),srcHiRes:c.static_url(this.props.imageSourceHiRes)})),n.div({className:t},n.div({className:"dbox-app-promo-image-text-title"},this.props.title),n.div({className:"dbox-app-promo-image-text-text"},this.props.text,this.props.children)),n.div({className:"clear"}))},t.displayName="DboxAppPromoImageText",t.propTypes={imageSource:o.string,imageSourceHiRes:o.string,title:o.string,text:o.string,isImagePrimary:o.bool},t.defaultProps={isImagePrimary:!0},t})(i.default.Component);t.DboxAppPromoImageText=f})),define("modules/clean/teams/constants",["require","exports","modules/core/i18n"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ADMIN_CONSOLE_I18_PROJECT="admin-console",t.ADMIN_ROLE={SUPER:0,USER_MANAGEMENT:1,HELPDESK:2,CUSTOM:3,LIMITED:4,NONE:-1},t.ADMIN_ROLE_NAMES={0:a._("Team Admin"),1:a._("User Management Admin"),2:a._("Support Admin"),3:a._("Custom Admin"),4:a._("Limited Admin")},t.TEAM_MEMBERSHIP_TYPES={FULL:0,FREE:1},t.TEAM_MEMBERSHIP_TYPE_LABELS={},t.TEAM_MEMBERSHIP_TYPE_LABELS[t.TEAM_MEMBERSHIP_TYPES.FREE]=a._("Limited"),t.TEAM_MEMBERSHIP_TYPE_LABELS[t.TEAM_MEMBERSHIP_TYPES.FULL]=a._("Full"),t.TEAM_JOIN_REQUEST_STATE={DISCOVERY_DISABLED:1,CAN_AUTO_JOIN:3,APPROVAL_REQUIRED:4,WAITING_FOR_APPROVAL:5,REQUEST_APPROVED:6,REQUEST_REJECTED_OPEN:7,REQUEST_REJECTED_DISMISSED:8},t.REQUEST_MEMBERSHIP_POLICY_VALUES={REQUIRE_APPROVAL:0,AUTO_ACCEPT:1,DISABLED:2},t.REQUEST_MEMBERSHIP_POLICY_VALUE_LIST=[t.REQUEST_MEMBERSHIP_POLICY_VALUES.REQUIRE_APPROVAL,t.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT,t.REQUEST_MEMBERSHIP_POLICY_VALUES.DISABLED],t.REQUEST_MEMBERSHIP_POLICY_STRINGS={},t.REQUEST_MEMBERSHIP_POLICY_STRINGS[t.REQUEST_MEMBERSHIP_POLICY_VALUES.REQUIRE_APPROVAL]={LABEL:a._("By Request"),DESCRIPTION:a._("They can see it and ask to join")},t.REQUEST_MEMBERSHIP_POLICY_STRINGS[t.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT]={LABEL:a._("Open"),DESCRIPTION:a._("They can see it and join on their own")},t.REQUEST_MEMBERSHIP_POLICY_STRINGS[t.REQUEST_MEMBERSHIP_POLICY_VALUES.DISABLED]={LABEL:a._("Invite-only"),DESCRIPTION:a._("They can join by invite only")},t.NOTES_LINK_POLICY_VALUES={TEAM:0,PUBLIC:1},t.NOTES_LINK_POLICY_LABELS={},t.NOTES_LINK_POLICY_LABELS[t.NOTES_LINK_POLICY_VALUES.TEAM]=a._("Just people on my team with the link"),t.NOTES_LINK_POLICY_LABELS[t.NOTES_LINK_POLICY_VALUES.PUBLIC]=a._("Anyone with the link"),t.SETUP_WIZARD_STEP={EXISTING_TEAM:0,PROVISION:10,TEAM_FOLDER:20,FINISHING_UP:30,COMPLETED:100},t.TEAM_PROMO_STEPS={WELCOME:1,VERIFY_EMAIL:2,JOIN_EXISTING:3,CHOOSE_TEAM_NAME:4,CHOOSE_SETUP_TYPE:5,CREATE_COMPLETE:6,REQUEST_SUBMITTED:7}})),define("modules/clean/teams/new_limited_team_create_form",["require","exports","tslib","create-react-class","purify","react","react-addons-linked-state-mixin","react-transition-group","react-dom-factories","external/lodash","modules/clean/ajax","modules/clean/analytics","modules/clean/components/title_bubble","modules/clean/react/button","modules/clean/react/input","modules/clean/react/radio","modules/clean/react_format","modules/clean/teams/constants","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],(function(e,t,a,s,r,i,n,o,m,l,c,u,p,d,_,h,f,E,g,b,T,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),r=a.__importStar(r),i=a.__importDefault(i),n=a.__importStar(n),m=a.__importStar(m),l=a.__importStar(l),c=a.__importStar(c),p=a.__importDefault(p),d=a.__importStar(d),_=a.__importStar(_),g=a.__importStar(g);var v=i.default.createElement,y=_.text,x=_.password,I=d.button;t.default=s.default({mixins:[n],displayName:"NewLimitedTeamCreateForm",getDefaultProps:function(){return{defaultMigrationType:"work",isMaestroDesign:!1}},getInitialState:function(){return{teamName:"",migrationType:this.props.defaultMigrationType,email:"",password:"",tosChecked:!1,errors:{},serverErrors:{},submitting:!1}},componentDidUpdate:function(){return this._updateErrors()},_getErrors:function(){var e={};return 0!==this.state.teamName.trim().length||this.props.isMaestroDesign||(e.team_name={message_text:b._("Please enter a company name")}),"personal"===this.state.migrationType&&(0===this.state.email.trim().length&&(e.email={message_text:b._("Please enter an email address")}),0===this.state.password.trim().length&&(e.password={message_text:b._("Please enter a password")}),this.props.isMaestroDesign||this.state.tosChecked||(e.tos_agree={message_text:b._("Please check the box to continue")})),e},_updateErrors:function(){var e=this._getErrors(),t=l.omitBy(this.state.errors,(function(t,a){return!(a in e)}));if(!l.isEqual(this.state.errors,t))return this.setState({errors:t})},_onCTAClick:function(e){var t=this;if(e.preventDefault(),!this.state.submitting){var a=this._getErrors();if(this.setState({errors:a}),l.isEmpty(a)){this.setState({submitting:!0,serverErrors:{}});var s=function(e,a,s){if(t.setState({submitting:!1}),"rate-limit"!==e.getResponseHeader("x-dropbox-app-error")){var r;try{r=JSON.parse(s)}catch(e){r={}}t._logErrors(r),null!=r.email&&[r.email.message_text,r.email.message_html].includes("email-taken")&&(r.email.message_text=b._("This e-mail is already taken.")),t.setState({serverErrors:r})}else T.Notify.error(b._("You can’t create more than two teams per user account. Please reach out to support if you’d like to create a new team."))};return this.props.personalUser.email===this.state.email?((a={email:{}}).email.message_text=b._("You’re already signed in!"),void this.setState({submitting:!1,serverErrors:a})):this.props.isMaestroDesign?void("personal"===this.state.migrationType?c.WebRequest({url:"/register_for_team_creation",data:{team_name:"My New Team",email:this.state.email,password:this.state.password,fname:this.props.personalUser.fname,lname:this.props.personalUser.lname,tos_agree:!0},success:function(){return t.props.onSuccess({email:t.state.email,migrationType:t.state.migrationType},t.state.migrationType)},error:s}):"work"===this.state.migrationType&&this.props.onSuccess(this.state)):"work"===this.state.migrationType?c.WebRequest({url:"/team/create_limited",data:{team_name:this.state.teamName,tos_agree:!0,request_membership_policy:E.REQUEST_MEMBERSHIP_POLICY_VALUES.AUTO_ACCEPT,show_onboarding_on_team_creation:this.props.showOnboardingOnTeamCreation,_tk:g.get_uri().path},success:function(e){return t.props.onSuccess?"function"==typeof t.props.onSuccess?t.props.onSuccess(JSON.parse(e)):void 0:g.redirect(new S.URI({path:"/team",query:{team_created:"1"}}))},error:s}):c.WebRequest({url:"/register_for_team_creation",data:{team_name:this.state.teamName,email:this.state.email,password:this.state.password,fname:this.props.personalUser.fname,lname:this.props.personalUser.lname,tos_agree:this.state.tosChecked},success:function(){return g.redirect("/verify_email_for_team_creation?email="+encodeURIComponent(t.state.email))},error:s})}this._logErrors(a)}},_logErrors:function(e){e=l.mapValues(e,(function(e){return e.message_text}));var t=Object.keys(e).length;t>0&&"work"!==this.state.migrationType&&(e.error_count=t,u.TeamsWebActionsLogger.log("create_new_team_dropbox_error",e),"email-taken"===e.email&&u.TeamsWebActionsLogger.log("entered_existing_account_info"))},_onKeyPress:function(e){if("Enter"===e.key)return this._onCTAClick(e)},_renderError:function(e){var t=(null!=this.state.errors[e]?this.state.errors[e].message_text:void 0)||(null!=this.state.serverErrors[e]?this.state.serverErrors[e].message_text:void 0);return t||null==(null!=this.state.serverErrors[e]?this.state.serverErrors[e].message_html:void 0)||(t=m.span({dangerouslySetInnerHTML:{__html:r.sanitize(null!=this.state.serverErrors[e]?this.state.serverErrors[e].message_html:void 0)}})),v(o.CSSTransition,{classNames:"form-error",in:!!t,timeout:100},m.div({className:"form-error",title:t},t))},_renderTeamNameForm:function(){return m.div({className:"team-name-form"},m.label({htmlFor:"team_name_input",className:"team-name-form__label"},b._("Team Name")),this._renderError("team_name"),v(y,{valueLink:this.linkState("teamName"),className:"team-name-form__input",placeholder:b._("Company or organization name"),"disable-errors":!0,autofocus:!0,id:"team_name_input",onKeyPress:this._onKeyPress}))},_renderSignupForm:function(){return m.div({key:"signup-form",className:"signup-form"},m.div({className:"signup-form-input"},this._renderError("email"),v(y,{valueLink:this.linkState("email"),className:"signup-form-input__email",placeholder:b._("Enter work email"),"disable-errors":!0,inline:!0,onKeyPress:this._onKeyPress})),m.div({className:"signup-form-input"},this._renderError("password"),v(x,{valueLink:this.linkState("password"),className:"signup-form-input__password",placeholder:b._("Password"),"disable-errors":!0,inline:!0,measureStrength:!0,onKeyPress:this._onKeyPress})),this.props.isMaestroDesign?m.div({className:"signup-form__tos-message"},f.reactFormat(b._("Your use of Dropbox is governed by the <termsLink>Dropbox Terms</termsLink>"),{termsLink:m.a({href:"/terms",target:"_blank"})})):m.div({className:"signup-form__tos"},this._renderError("tos_agree"),m.input({checkedLink:this.linkState("tosChecked"),className:"signup-form__tos-checkbox",type:"checkbox",id:"signup-form__tos-checkbox"}),m.label({htmlFor:"signup-form__tos-checkbox",className:"signup-form__tos-label"},f.reactFormat(b._("I agree to <termsLink>Dropbox Terms</termsLink>"),{termsLink:m.a({href:"/terms",target:"_blank"})}))))},getMigrationTypeValueLink:function(){var e=this;return{value:this.state.migrationType,requestChange:function(t){if(t!==e.state.migrationType)return u.TeamsWebActionsLogger.log("onboarding_creation_select_migration_option",{migration_type:t}),e.setState({migrationType:t})}}},workRadioItem:function(e){var t;return t=this.props.isMaestroDesign?{title:b._("Convert my Dropbox account into a work Dropbox account"),description:b._("All of your files will stay private until you choose to share them. If you use this Dropbox account for personal stuff, choose ‘Add a new Work Dropbox account’.")}:{title:b._("Make my current Dropbox a Team Dropbox"),description:b._("All of your files will remain with “%(user_email)s”, and will stay private until you choose to share them. If you use this Dropbox mostly for personal stuff, choose “Create a new Team Dropbox.”").format({user_email:e.email}),title_bubble:b._("Converting your current Dropbox (%(user_email)s) to a Team Dropbox allows you to more easily share with teammates and organize company files. You will still have full ownership over your account. As the team creator, only you will have have admin permissions and are the only person who can upgrade the team to Dropbox Business.").format({user_email:e.email}),bubble_direction:"east"},v(h.RadioItem,{value:"work",key:"work-option"},m.div({className:"migration-option"},m.h3({className:"migration-option__title"},t.title),m.div({className:"migration-option__description"},t.description,null!=t.title_bubble?[" ",v(p.default,{text:t.title_bubble,direction:t.bubble_direction},m.span({className:"migration-option__learn-more"},b._("Learn more")))]:void 0)))},personalRadioItem:function(e){var t;return t=this.props.isMaestroDesign?{title:b._("Add a new work Dropbox account"),description:b._("Keep your work stuff separate by creating a work Dropbox account with 2GB of free space under a new account. You can move any files from your current Dropbox account [%(user_email)s] after you set up your new work Dropbox account.").format({user_email:e.email})}:{title:b._("Create a new Team Dropbox"),description:b._("Keep your work and personal files separate by creating a new Team Dropbox. You can move any files from your current Dropbox [%(user_email)s] after you set up your new Team Dropbox.").format({user_email:e.email})},v(h.RadioItem,{value:"personal",key:"personal-option"},m.div({className:"migration-option"},m.h3({className:"migration-option__title"},t.title),m.div({className:"migration-option__description"},t.description," "),v(o.CSSTransition,{classNames:"signup-form",timeout:{appear:0,enter:500,exit:300},in:"personal"===this.state.migrationType,unmountOnExit:!0,mountOnEnter:!0},this._renderSignupForm())))},renderMaestro:function(e){return e=this.props.personalUser,m.div({className:"new-limited-team-create-form"},m.div({className:"account-migration-form"},v(h.RadioGroup,{variant:h.RadioItemVariant.Large,align:"top",legend:b._("Account migration options."),valueLink:this.getMigrationTypeValueLink()},"work"===this.props.defaultMigrationType?[this.workRadioItem(e),this.personalRadioItem(e)]:[this.personalRadioItem(e),this.workRadioItem(e)])),m.div({className:"cta-form"},v(I,{className:"cta-form__button",onClick:this._onCTAClick,disabled:this.state.submitting},"personal"===this.state.migrationType?b._("Add work Dropbox account"):b._("Create work Dropbox account"))))},renderOriginal:function(e){return m.div({className:"new-limited-team-create-form"},this._renderTeamNameForm(),m.div({className:"account-migration-form"},v(h.RadioGroup,{variant:h.RadioItemVariant.Large,align:"top",legend:b._("Account migration options."),valueLink:this.getMigrationTypeValueLink()},"personal"===this.props.defaultMigrationType?[this.personalRadioItem(e),this.workRadioItem(e)]:[this.workRadioItem(e),this.personalRadioItem(e)])),m.hr(),m.div({className:"cta-form"},v(I,{className:"cta-form__button",onClick:this._onCTAClick,disabled:this.state.submitting},"personal"===this.state.migrationType?b._("Continue"):b._("Create Team Dropbox"))))},render:function(){var e=this.props.personalUser;return this.props.isMaestroDesign?this.renderMaestro(e):this.renderOriginal(e)}})})),define("modules/clean/teams/team_choose",["require","exports","tslib","classnames","external/lodash","react","react-transition-group","modules/clean/analytics","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/avatar/size","modules/clean/datetime","modules/clean/em_string","modules/clean/react/button","modules/clean/react/image","modules/clean/react/title_bubble","modules/clean/static_urls","modules/clean/stormcrow/experiment","modules/clean/teams/constants","modules/clean/viewer","modules/constants/trademark","modules/core/i18n","modules/core/user_i18n","spectrum/checkbox","modules/core/uri"],(function(e,t,a,s,r,i,n,o,m,l,c,u,p,d,_,h,f,E,g,b,T,S,v,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=a.__importDefault(s),r=a.__importStar(r),i=a.__importDefault(i),m=a.__importDefault(m),c=a.__importStar(c),u=a.__importStar(u),d=a.__importStar(d),g=a.__importStar(g),v=a.__importStar(v);var x=g.TEAM_JOIN_REQUEST_STATE,I=[{id:"r2j-checkbox-0",label:S._("I need access to team files and folders to get work done.")},{id:"r2j-checkbox-1",label:S._("I need more space on Dropbox to store my work.")},{id:"r2j-checkbox-2",label:S._("I need to keep my work files secure.")}],N=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e,t,a=this.props.joinableTeams.slice(),s=[];null!=this.props.joinableTeams[0]&&this.props.joinableTeams[0].is_invite&&(s=this.props.joinableTeams.slice(0,1),a=a.slice(1));for(var r=0;r<a.length;r++){var n=a[r];if(n.join_request_state===x.REQUEST_APPROVED){s.push(n),a.splice(r,1);break}}return s.length>0&&(e=i.default.createElement(R,{cancelJoinTeamHandler:this.props.cancelJoinTeamHandler,joinableTeams:s,joinTeamHandler:this.props.joinTeamHandler,showTeamTypeLabels:this.props.showTeamTypeLabels,title:S.ungettext("Team invitation","Team invitations",s.length),className:"invited-section"})),a.length>0&&(t=i.default.createElement(R,{cancelJoinTeamHandler:this.props.cancelJoinTeamHandler,joinableTeams:a,joinTeamHandler:this.props.joinTeamHandler,showTeamTypeLabels:this.props.showTeamTypeLabels,title:S.ungettext("Team you can join","Teams you can join",a.length)})),i.default.createElement("div",null,e,t)},t})(i.default.Component);t.TeamChooseWidget=N;var R=(function(e){function t(t){var a=e.call(this,t)||this;a.handleListItemCollapse=function(){a.setState({expandedListItemIndex:-1})},a.handleListItemExpand=function(e){a.setState({expandedListItemIndex:e})},a.isListItemDisabled=function(e){var t=a.state.expandedListItemIndex;return-1!==t&&t!==e},a.showMoreOnClick=function(){a.setState({expanded:!0}),o.TeamsWebActionsLogger.log("click_expand")};for(var s=a.props.joinableTeams,r=[],i=[x.WAITING_FOR_APPROVAL,x.REQUEST_APPROVED,x.REQUEST_REJECTED_OPEN],n=0,m=s;n<m.length;n++){var l=m[n];i.includes(l.join_request_state)?r.unshift(l.team_id):r.push(l.team_id)}return a.state={teamSortOrder:r,expanded:!1,expandedListItemIndex:-1},a}return a.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(e.joinableTeams){var t=r.keyBy(e.joinableTeams,"team_id"),a=r.filter(this.state.teamSortOrder,(function(e){return!!t[e]}));a=r.uniq(a.concat(r.map(t,(function(e){return e.team_id})))),this.setState({teamSortOrder:a})}},t.prototype.getSortedJoinableTeams=function(){var e=r.keyBy(this.props.joinableTeams,"team_id");return r.map(this.state.teamSortOrder,(function(t){return e[t]}))},t.prototype.renderShowMore=function(e){return i.default.createElement("li",{className:"team-list-show-more"},i.default.createElement("span",{className:"team-list-show-more-button",onClick:this.showMoreOnClick},S.ungettext("View %(num_teams)d more","View %(num_teams)d more",e).format({num_teams:e})))},t.prototype.render=function(){var e=this,t=this.state,a=t.expanded,s=t.expandedListItemIndex,r=this.props,o=r.buttonImportance,m=r.cancelJoinTeamHandler,l=r.className,c=r.ctaNewTeamImportance,u=r.disableButtons,p=r.expSubgrowthBizTeamsR2jMessage,d=r.teamRowHighlight,h=r.hasTeamPendingApproval,E=r.initialNumTeamsToShow,g=r.joinTeamHandler,b=r.maxNamesToShow,T=r.showBusinessTeamIcon,v=r.showJoinTextForInvite,y=r.showTeamTypeLabels,x=r.staticRows,I=r.title,N=0;x&&E?N=Math.max(0,E-x.length):E&&(N=Math.max(0,E));var R,L,w=this.getSortedJoinableTeams().map((function(t,a){return i.default.createElement(A,{team:t,cancelJoinTeamHandler:m,joinTeamHandler:g,key:t.team_id,showBusinessTeamIcon:T,buttonImportance:o,maxNamesToShow:b,showTeamTypeLabels:y,disableButton:u,showJoinTextForInvite:v,teamRowHighlight:d,hasTeamPendingApproval:h,expSubgrowthBizTeamsR2jMessage:p,index:a,isDisabled:e.isListItemDisabled(a),isExpanded:a===s,onItemCollapse:e.handleListItemCollapse,onItemExpand:e.handleListItemExpand,showHomeSurfaceExistingTeamsExperiment:e.props.showHomeSurfaceExistingTeamsExperiment})})),k=w,C=null,O=[];return w.length>N&&(k=w.slice(0,N),a?O=w.slice(N):C=this.renderShowMore(w.length-N)),x&&x.forEach((function(e){var t=i.default.createElement(_.Image,{src:f.static_url("/static/images/teams/add_cir-vfl6sl23s.png"),srcHiRes:f.static_url("/static/images/teams/add_cir@2x-vflGMnZ12.png")}),s=i.default.createElement(P,{icon:t,title:e.title||S._("Create a new Team Dropbox"),subtitle:e.subtitle,actionText:e.actionText||S._("Create"),actionHandler:e.actionHandler,disableButton:u,importance:c});a?O.push(s):k.push(s)})),O&&(L=i.default.createElement(n.CSSTransition,{classNames:"team-list-show-more-section",appear:!1,enter:!0,exit:!0,timeout:{appear:0,enter:300,exit:300},unmountOnExit:!0},i.default.createElement("div",{className:"team-list-show-more-section"},O))),w.length>N&&(R=i.default.createElement(n.TransitionGroup,null,L)),i.default.createElement("div",{className:l},I&&I.length>0?i.default.createElement("div",{className:"team-list-title"},I):void 0,i.default.createElement("ol",{className:"team-list-view"},k,C,R))},t.defaultProps={maxNamesToShow:3,initialNumTeamsToShow:3,staticRows:[],disableButtons:!1},t})(i.default.Component);t.TeamJoinList=R;var P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return i.default.createElement("li",{className:"team-list-item",key:this.props.title+this.props.subtitle},i.default.createElement("div",{className:"team-list-item-contents"},i.default.createElement("div",{className:"team-list-avatars"},i.default.createElement("div",{className:"team-list-item__custom-img u-mar-right-s"},this.props.icon)),i.default.createElement("div",{className:"team-list-item-body"},i.default.createElement("div",{className:"team-list-item-text team-list-item-title"},this.props.title),i.default.createElement("span",{className:"team-list-item-text team-list-item-subtitle"},this.props.subtitle)),i.default.createElement("div",{className:"team-list-item-actions"},i.default.createElement(d.button,{importance:this.props.importance||"primary",disabled:this.props.disableButton,onClick:this.props.actionHandler},this.props.actionText)),i.default.createElement("div",{className:"clear"})))},t})(i.default.Component),A=(function(e){function t(t){var a=e.call(this,t)||this;return a.renderActionItemOnClick=function(){var e=a.props.team;a.props.cancelJoinTeamHandler(e)},a.formatDate=function(e){return u.nice_date_with_month_name(e,!0,!0)},a.state=a.getInitialState(),a}return a.__extends(t,e),t.prototype.componentDidUpdate=function(e,t){!0===t.submit&&this.setState(this.getInitialState(),(function(){e.onItemCollapse()}))},Object.defineProperty(t.prototype,"expSubgrowthBizTeamsR2jMessage",{get:function(){return E.Experiment(this.props.expSubgrowthBizTeamsR2jMessage)},enumerable:!0,configurable:!0}),t.prototype.getInitialState=function(){return{r2jCheckedReasons:I.reduce((function(e,t){return e[t.id]="unchecked",e}),{}),submit:!1}},t.prototype.isPendingState=function(e){return[x.WAITING_FOR_APPROVAL,x.REQUEST_REJECTED_OPEN].includes(e)},t.prototype.getCtaButton=function(e,t){var a=this.props,s=a.disableButton,r=a.hasTeamPendingApproval,n=a.isDisabled,o=a.isExpanded,m=a.showJoinTextForInvite,l=a.team,c=this.state.submit,u="",p=!1;return l.is_invite||l.join_request_state===x.REQUEST_APPROVED?m?(u=S._("Join"),p=c||s):(u=S._("Accept Invitation"),this.props.showHomeSurfaceExistingTeamsExperiment&&(u=S._("Join the team")),p=c||s):this.isPendingState(l.join_request_state)?(u=S._("Asked to join"),p=!0,e="tertiary"):l.join_request_state===x.APPROVAL_REQUIRED?(u=S._("Request to join"),this.props.showHomeSurfaceExistingTeamsExperiment&&(u=S._("Ask to join")),p=c||s,this.expSubgrowthBizTeamsR2jMessage.variantIs("V2")&&(o?p=c||s:(u=S._("Continue"),p=c||s||n))):l.join_request_state===x.CAN_AUTO_JOIN&&(u=S._("Join"),p=c||s),r&&(p=p||l.join_request_state!==x.WAITING_FOR_APPROVAL),i.default.createElement(d.button,{importance:e,onClick:t,children:u,disabled:p})},t.prototype.getFormattedR2jReasons=function(){var e=this.state.r2jCheckedReasons,t=Object.keys(e).reduce((function(t,a){return"checked"===e[a]?t+1:t}),0);if(0!==t)return S.ungettext("This user selected the following reason they need to join your account:\n%(reasons_list)s","This user selected the following reasons they need to join your account:\n%(reasons_list)s",t).format({reasons_list:Object.keys(e).reduce((function(t,a){return"checked"===e[a]?t.concat(S._("• %(reason)s\n").format({reason:I.find((function(e){return e.id===a})).label})):t}),"").trim()})},t.prototype.renderExpandedContent=function(){var e=this,t=this.props,a=t.isExpanded,s=t.joinTeamHandler,r=t.onItemCollapse,u=t.team;if(!a)return null;var p=b.Viewer.get_viewer().personal_user,_=p.display_name,h=p.photo_url;return i.default.createElement(n.CSSTransition,{classNames:"team-list-item-r2j-message",appear:!1,enter:!0,leave:!1,timeout:{enter:300},unmountOnExit:!0},i.default.createElement("div",{className:"team-list-item-r2j-message"},i.default.createElement("div",{className:"team-list-item-r2j-message-content"},i.default.createElement("div",{className:"team-list-item-r2j-message-heading"},i.default.createElement(m.default,{dimension:c.VALID_AVATAR_DIMENSIONS[2],optionalClass:"team-list-item-r2j-message-avatar",photoUrl:h,shape:"CIRCLE",defaultAvatar:i.default.createElement(l.InitialsAvatarWithColorDerivedFromName,{dimension:c.VALID_AVATAR_DIMENSIONS[2],initials:v.getInitials(_),name:_,optionalClass:"team-list-item-r2j-message-avatar",shape:"CIRCLE"})}),i.default.createElement("h2",{className:"team-list-item-r2j-message-title"},S._("Introduce yourself"))),this.renderR2jFormInput()),i.default.createElement("div",{className:"team-list-item-r2j-message-footer"},i.default.createElement(d.button,{importance:"secondary",onClick:function(){r()},children:S._("Back")}),this.getCtaButton("primary",(function(){e.expSubgrowthBizTeamsR2jMessage.variantIs("V2")&&s(u,e.getFormattedR2jReasons()),e.setState({submit:!0}),o.TeamsWebActionsLogger.log("click_team_join_primary_cta")})))))},t.prototype.renderR2jFormInput=function(){var e=this,t=this.state,s=t.r2jCheckedReasons,r=t.submit,n=function(t,s,r){e.setState((function(e){var s;return{r2jCheckedReasons:a.__assign(a.__assign({},e.r2jCheckedReasons),(s={},s[r.target.id]=t,s))}}))};return this.expSubgrowthBizTeamsR2jMessage.variantIs("V2")?i.default.createElement("div",null,i.default.createElement("p",{className:"team-list-item-r2j-message-info"},S._("Your request is more likely to be accepted if you let the team admin know why you need to join the account.")),i.default.createElement("fieldset",null,i.default.createElement("legend",{className:"team-list-item-r2j-message-checkbox-legend"},S._("Select from the following reasons (optional)")),I.map((function(e){return i.default.createElement("label",{className:"team-list-item-r2j-message-checkbox-label",htmlFor:e.id,key:e.id},e.label,i.default.createElement(y.Checkbox,{checked:s[e.id],className:"team-list-item-r2j-message-checkbox",disabled:r,id:e.id,name:"r2j-checkbox",onChange:n}))})))):null},t.prototype.renderActionItem=function(){var e=this,t=this.props,a=t.buttonImportance,s=t.index,r=t.isExpanded,n=t.joinTeamHandler,o=t.onItemExpand,m=t.team;if(r)return null;if(this.isPendingState(m.join_request_state)){if(m.join_request_state===x.WAITING_FOR_APPROVAL){var l=void 0;if(m.join_request_date){var c=this.formatDate(m.join_request_date);l=S._("Requested on %(request_date)s").format({request_date:c})}else l=S._("Requested");return this.props.showHomeSurfaceExistingTeamsExperiment&&(l=""),i.default.createElement("div",{className:"cancel-request"},l,i.default.createElement("button",{onClick:this.renderActionItemOnClick,className:"button-as-link cancel-request__link"},S._("Cancel request")))}var u=void 0;if(m.join_denied_date){var p=this.formatDate(m.join_denied_date);u=S._("Declined on %(request_date)s").format({request_date:p})}else u=S._("Request declined");return i.default.createElement("div",{className:"declined-request"},u)}var d=a||"tertiary",_=function(){n(m),e.setState({submit:!0})};return m.join_request_state===x.APPROVAL_REQUIRED&&this.expSubgrowthBizTeamsR2jMessage.variantIs("V2")&&(_=function(){o(s)}),this.getCtaButton(d,_)},t.prototype._generateMemberCountSpan=function(e){return i.default.createElement("span",{className:"team-list-item-text team-list-item-subtitle"},S.ungettext("%(num_members)d member","%(num_members)d members",e).format({num_members:e}))},t.prototype.renderMembersSection=function(e){var t,a,s,r=this.props.maxNamesToShow;if(r||(r=0),e.is_private){var n=this._generateMemberCountSpan(e.num_members);return i.default.createElement("div",{className:"team-list-item-members-section"},n)}if(e.inviting_user_name)return s="",e.members_to_display.forEach((function(e){s+=e.email+"\n"})),e.members_to_display.length<e.num_members&&(t=e.num_members-e.members_to_display.length,s+=S._("and %(extra)s more").format({extra:t})),i.default.createElement("div",{className:"team-list-item-members-section"},i.default.createElement(h.TitleBubble,{content:e.inviting_user_email||e.inviting_user_name,key:"invitee-name",position:h.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8},i.default.createElement("span",{className:"team-list-item-text team-list-item-invitee-name"},p.Emstring.em_snippet(S._("Invited by %(admin_name)s").format({admin_name:e.inviting_user_name}),30))),i.default.createElement("span",{className:"u-pad-xxs",key:"middle-dot"},S._("·")),i.default.createElement(h.TitleBubble,{content:s,position:h.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8,key:"title-bubble",className:"white-space-wrap"},this._generateMemberCountSpan(e.num_members)));var o="";s="";for(var m=0;m<e.members_to_display.length;m++)a=e.members_to_display[m],m>r-1?s+=a.email+"\n":m===e.members_to_display.length-1?[0,r-1].includes(m)?o+=""+a.display_name:o+=S._("and %(display_name)s").format({display_name:a.display_name}):o+=a.display_name+", ";return e.members_to_display.length<e.num_members&&(t=e.num_members-e.members_to_display.length,s+=S._("and %(extra)s more").format({extra:t})),s?i.default.createElement("div",{className:"team-list-item-members-section"},i.default.createElement("span",{className:"team-member-names",key:"team-member-names"}," ",o),i.default.createElement(h.TitleBubble,{content:s,position:h.TitleBubble.POSITIONS.BOTTOM,distanceFromTarget:8,key:"title-bubble",className:"white-space-wrap"},i.default.createElement("span",null,S.ungettext("and %(num_members)s more","and %(num_members)s more",e.num_members-r).format({num_members:e.num_members-r})))):i.default.createElement("span",{className:"team-list-item-members-section team-member-names"},o)},t.prototype.renderTeamLabel=function(e){if(this.props.showTeamTypeLabels&&this.props.showBusinessTeamIcon&&!e.is_limited){var t=i.default.createElement("div",{className:"business-team-tooltip__content"},i.default.createElement("div",{className:"tooltip-bold-text u-mar-bottom-xxs"},S._("%(trademark_business)s account").format({trademark_business:T.TRADEMARK_BUSINESS})),i.default.createElement("div",{className:"tooltip-normal-text"},S._("%(team_name)s owns and administers this Dropbox").format({team_name:e.team_name})));return i.default.createElement("span",{className:"business-team-tooltip__icon-container"},i.default.createElement(h.TitleBubble,{content:t,position:h.TitleBubble.POSITIONS.RIGHT,distanceFromTarget:12},i.default.createElement(_.Image,{src:f.static_url("/static/images/teams/building_icon-vflqiltW_.png"),srcHiRes:f.static_url("/static/images/teams/building_icon@2x-vflxby4HL.png"),alt:S._("Business team icon"),className:"business-team-icon"})))}},t.prototype.render=function(){var e=this.props,t=e.isDisabled,a=e.team,r=e.teamRowHighlight,o={"is-inviting-team":a.is_invite||a.join_request_state===x.REQUEST_APPROVED,"team-list-item--disabled":t,"team-list-item--highlighted":r},m=this.renderMembersSection(a);if(this.props.showHomeSurfaceExistingTeamsExperiment&&(m=i.default.createElement("span",{className:"team-list-item-members-section admin-name-sub"},S._("Team admin: %(admin_name)s").format({admin_name:this.props.team.admin_name})),a.inviting_user_name&&(m=i.default.createElement("span",{className:"team-list-item-members-section inviting-user-name-sub"},S._("Invited to a team by %(inviting_user_name)s").format({inviting_user_name:a.inviting_user_name}))),this.isPendingState(a.join_request_state)&&a.join_request_state===x.WAITING_FOR_APPROVAL)){var l=void 0;if(a.join_request_date){var c=this.formatDate(a.join_request_date);l=S._("Request sent: %(request_date)s").format({request_date:c})}else l=S._("Request sent");m=i.default.createElement("span",{className:"team-list-item-members-section request-date-sub"},l)}return i.default.createElement("li",{className:s.default("team-list-item",o)},i.default.createElement("div",{className:"team-list-item-contents"},i.default.createElement("div",{className:"team-list-item-body"},i.default.createElement("div",{className:"team-list-item-text team-list-item-title"},this.props.showHomeSurfaceExistingTeamsExperiment?i.default.createElement(_.Image,{className:"surface-existing-teams__team_card-building-icon",src:f.static_url("/static/images/team_discovery/building-vflji5Gxx.png"),srcHiRes:f.static_url("/static/images/team_discovery/building-icon@2x-vflRJs5ej.png")}):null,a.team_name,this.renderTeamLabel(a)),m),i.default.createElement("div",{className:"team-list-item-actions"},this.renderActionItem())),i.default.createElement(n.TransitionGroup,{className:"team-list-item-r2j-message"},this.renderExpandedContent()),i.default.createElement("div",{className:"clear"}))},t})(i.default.Component)}));
//# sourceMappingURL=pkg-legacy-al.min.js-vflhnvDqP.map