define(["require","exports","tslib","react","modules/core/i18n","modules/clean/react/css","spectrum/popover","modules/clean/static_urls","modules/clean/react/app_actions/redirect","modules/clean/react/file_viewer/unity/with_unity","modules/clean/react/file_viewer/constants","modules/clean/react/app_actions/byline","modules/clean/react/extensions/unity_and_cloud_editors","modules/clean/react/extensions/common","modules/clean/file_store/utils","spectrum/icon_action","modules/clean/react/extensions/data/helpers","modules/clean/react/extensions/extensions_scaling_modal","modules/clean/react/extensions/feature_flags","modules/clean/react/file_viewer/open_button/types","modules/clean/react/extensions/cloud_docs_compat","modules/clean/react/extensions/menu_content_item","modules/clean/react/extensions/menu_survey"],(function(e,t,n,o,a,r,i,s,c,l,p,u,d,m,_,f,y,g,v,E,A,h,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=(function(e){function t(t){var r=e.call(this,t)||this;return r.createAppActionClickHandler=function(e){return function(){var t=r.props,o=t.file,a=t.user,i=t.featureFlags,s=t.telemetryContext,l=t.updateLinkState;if(c.redirectToActionOrShowAuth(a,o,e,i,s,l),"redirect"===e.handler[".tag"]){var p=m.getAppActionExtras(e);m.logEvent(r.props.currentSession,"select_action",n.__assign({menu_version:2},p))}else if("cloud_editor"===e.handler[".tag"]){var u=A.isWopiAction(e)?E.OpenButtonAction.OPEN_WITH:E.OpenButtonAction.OPEN_WITH_CLOUD_DOC;m.logEvent(r.props.currentSession,"select_legacy_action",{type:u})}}},r.wrapperForAction=function(e){return{appAction:e,handler:r.createAppActionClickHandler(e),userAction:p.UserAction.OpenWithAppAction,actionName:e.description}},r.renderActionRow=function(e){var t,n=r.props,a=n.categoryIdToInfos,c=n.currentSession,l=n.featureFlags.expRealignMenu,p=e.icon;t=p.is_static?s.static_url("/static/images/generic_app_icon-vflIPYT1H.png"):p.url;var d=e.description,_=a[e.category],f=_?_.display_name:null,y=v.shouldRealignMenu(l),g=o.default.createElement(i.PopoverContentItem,{className:"app-action-row",key:e.id,value:r.wrapperForAction(e)},o.default.createElement(h.MenuContentElement,{text:d,iconUrl:t,description:y&&m.isLinked(e)?null:f}));if(y)return g;var E=e.app_copy&&e.app_copy.length>0?e.app_copy:void 0;return o.default.createElement(u.ExtensionsBylineTooltip,{bylines:E,onDidShow:m.handleShowByline(e.app_id,c),key:e.id},g)},r.renderDownload=function(e){var t=r.props.telemetryContext;return t&&"previews"===t.surface?o.default.createElement(i.PopoverItemGroup,{className:"app-action-category-group",key:"download"},o.default.createElement(i.PopoverContentItem,{key:"download",value:e,className:"app-action-row"},o.default.createElement("div",{className:"app-action-row-content"},o.default.createElement(f.IconAction,{className:"app-action-popover-icon-svg",name:"download"}),o.default.createElement("span",{className:"app-action-legacy-option-text"},a._("Download"))))):null},r}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.user,c=t.file,l=t.appActions,p=t.openOptions,u=t.bylines,_=t.categoryIdToInfos,f=t.featureFlags,E=t.currentSession,A=t.telemetryContext,x=t.updateLinkState,O=m.getOpenOptionsWithLogging(p,E),C=y.partitionOptions(O),S=C.unityOptions,I=C.cloudEditorOptions,P=C.downloadOption,N=f.expRealignMenu,k=v.shouldRealignMenu(N),M=k?"ON"===N?2:0:5,U=y.partitionActions(l,M),D=U.cloudEditors,R=U.installedActions,T=U.promotedActions,W=U.unpromotedActions,b=R.length>0,F=T.length>0,G=W.length>0,B=k?F&&!b:F,L=b||F;return o.default.createElement("div",null,o.default.createElement(d.UnityAndCloudEditors,{unityOptions:S,legacyCloudEditorOptions:I,cloudEditorAppActions:D.map((function(t){return e.wrapperForAction(t)})),bylines:u,currentSession:E}),b&&o.default.createElement(i.PopoverItemGroup,{className:"app-action-category-group",key:"installed-actions"},R.map((function(t){return e.renderActionRow(t)}))),B&&o.default.createElement(i.PopoverItemGroup,{className:"app-action-category-group",key:"promoted-actions"},o.default.createElement(i.PopoverItemGroupTitle,{className:"app-action-category-title"},k?a._("SUGGESTED"):b?a._("MORE APPS"):a._("APPS")),T.map((function(t){return e.renderActionRow(t)}))),(F||G)&&o.default.createElement(i.PopoverContentItem,{key:a._("Show more"),value:{handler:function(){var e=n.__spreadArrays(R,T,W);g.showExtensionsScalingModal(a._("Open or edit with these apps"),r,c,e,_,f,x,A,E),m.logEvent(E,k&&!L?"select_add_app":"select_show_more",{surface:A&&A.surface})}},className:"app-action-row"},k?o.default.createElement(h.MenuContentElement,{text:L?a._("Connect more apps"):a._("Connect apps"),iconUrl:L?null:s.static_url("/static/images/extensions/circled_plus-vfl7N2-Lg.svg")}):o.default.createElement(h.MenuContentElement,{text:L?a._("Show more"):a._("View apps")})),P&&this.renderDownload(P),o.default.createElement(w.OpenMenuSurvey,{userId:r.id,session:E}))},t})((o=n.__importDefault(o)).default.Component);t.ExtensionsPopoverV2WithUnity=function(e){return _.isBrowseFile(e.file)?o.default.createElement(l.WithUnity,{file:e.file,user:e.user,render:function(t){return o.default.createElement(x,n.__assign({},e,{unityInfo:t}))}}):null},t.ExtensionsPopoverV2NoUnity=r.requireCssWithComponent(x,["/static/css/app_actions/index-vflQoSB9Z.css","/static/css/extensions/index-vflB4zyRv.css"])}));
//# sourceMappingURL=extensions_popover_content_component_v2.min.js-vfl9E2v2e.map