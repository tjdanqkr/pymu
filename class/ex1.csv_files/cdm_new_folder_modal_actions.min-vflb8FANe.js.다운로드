define(["require","exports","tslib","modules/clean/sharing/access_level","modules/clean/sharing/api/client","modules/clean/sharing/ui_util","modules/clean/sharing/api","modules/clean/api_v2/error","modules/clean/legacy_pyxl_controllers/ajax_form","modules/core/i18n","modules/clean/api_v2/types","modules/clean/web_user_action_logger","modules/clean/web_user_action_events"],(function(e,n,o,a,s,r,t,l,i,c,u,d,_){"use strict";function m(e){var n=e.folderApiClient,a=e.showFileSystemWarningsModal,s=e.onCancel,r=o.__rest(e,["folderApiClient","showFileSystemWarningsModal","onCancel"]);return a?n.shareWithFsws(o.__assign(o.__assign({},r),{folderPolicy:null})).then((function(e){var t=e.metadata,l=e.fsws;return l?new Promise((function(e,t){a({fsws:l,onFinalAccept:function(){n.share(o.__assign(o.__assign({},r),{folderPolicy:null})).then(e,t)},confirmText:c._("Create folder"),onAbortAction:s})})):Promise.resolve(t)})):n.shareWithoutFsws(o.__assign(o.__assign({},r),{folderPolicy:null})).then((function(e){var n=e.metadata;return Promise.resolve(n)}))}Object.defineProperty(n,"__esModule",{value:!0}),i=o.__importDefault(i),n.createTSDPlus1NsfFolder=function(e){var n=e.user,o=e.pathName,c=e.folderName,f=e.autoTeamGroupAccessLevel,h=e.autoTeamGroupId,p=e.showFileSystemWarningsModal,g=e.onPending,C=e.onComplete,A=e.onCancel,E=n.id,v=new s.FolderShareApiClient({userId:E,isNonUserRelativeContext:!1}),w=r.getNewFolderPathFromContentName(c,o);g(),new t.SharingApi(n).validate_new_sf_path(c,w,(function(){(function(e){var n=e.userId,o=e.fqPath,s=e.autoTeamGroupAccessLevel,r=e.folderApiClient,t=e.autoTeamGroupId,i=e.showFileSystemWarningsModal,c=e.onComplete,f=e.onCancel,h=s===a.ACCESS_LEVEL.READER;m({folderApiClient:r,showFileSystemWarningsModal:i,fqPath:o,confidential:h,onCancel:f}).then((function(e){var o=e.shared_folder_id;return h?(d.WebUserActionLog.log(n,_.WebUserActionLogEvent.CONF_BY_CREATE_CONFIDENTIAL_FOLDER,{ns_id:o,who_has_access:_.WebUserActionLogExtraValue.EVERYONE_GROUP_VIEW_ACCESS,location:_.WebUserActionLogExtraValue.BROWSE}),r.addMembers({contentId:o,members:[new u.UnionScalar("dropbox_id",t)],accessLevel:a.ACCESS_LEVEL.READER})):Promise.resolve()})).then(c).catch(l.catchApiError((function(){f()})))})({userId:E,fqPath:w,autoTeamGroupAccessLevel:f,folderApiClient:v,autoTeamGroupId:h,showFileSystemWarningsModal:p,onComplete:function(){C({user:n,folderName:c,fqPath:w})},onCancel:A})}),(function(e){var n=i.default.extract_errors(e.responseText);A(n.folder_name&&n.folder_name.message_text)}))},n._shareWithFsw=m}));
//# sourceMappingURL=cdm_new_folder_modal_actions.min.js-vflUWZfMf.map