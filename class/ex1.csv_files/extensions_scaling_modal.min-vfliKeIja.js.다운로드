define(["require","exports","tslib","react","modules/core/i18n","spectrum/modal","modules/clean/static_urls","spectrum/button","deep-integrations/text/text","modules/clean/react_format","modules/clean/ux_analytics_modal_tracking","modules/clean/react/css","modules/clean/react/modal","react-modal","external/lodash","deep-integrations/search_input/search_input","deep-integrations/search_input/clear_input_button","spectrum/colorized_icon","deep-integrations/icons/icon_cancel","modules/clean/react/extensions/common","modules/clean/react/extensions/data/helpers","modules/clean/react/extensions/data/selectors","modules/clean/react/extensions/feature_flags","modules/clean/react/app_actions/redirect","modules/clean/react/file_viewer/open_button/types","modules/clean/react/extensions/cloud_docs_compat"],(function(e,t,n,a,s,r,o,c,l,i,d,u,m,p,f,_,g,h,y,x,E,v,C,S,N,A){"use strict";function b(){return a.default.createElement("div",{className:"extensions-scaling-modal__directory-entry-point"},a.default.createElement("a",{href:"/apps",target:"_blank",rel:"noreferrer"},s._("View all apps")))}Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),f=n.__importStar(f),t.AppDirectoryEntryPoint=b;var k=(function(e){function t(t){var n=e.call(this,t)||this;return n.hasUsedSearchBar=!1,n.createClickHandler=function(e){return function(){m.Modal.close();var t=n.props,a=t.user,s=t.file,r=t.featureFlags,o=t.currentSession,c=t.telemetryContext,l=t.updateLinkState,i=t.onProfileServiceAuth;if(S.redirectToActionOrShowAuth(a,s,e,r,c,l,i),"redirect"===e.handler[".tag"])x.logEvent(o,"select_action",x.getAppActionExtras(e));else if("cloud_editor"===e.handler[".tag"]){var d=A.isWopiAction(e)?N.OpenButtonAction.OPEN_WITH:N.OpenButtonAction.OPEN_WITH_CLOUD_DOC;x.logEvent(n.props.currentSession,"select_legacy_action",{type:d})}}},n.handleQueryChange=function(e){n.setState({searchKey:e}),n.hasUsedSearchBar||(x.logEvent(n.props.currentSession,"start_searching",{}),n.hasUsedSearchBar=!0)},n.filterActions=function(){var e=n.props,t=e.appActions,a=e.categoryIdToInfos,s=n.state.searchKey.trim().toLowerCase(),r=t.map((function(e){return e.category})).map((function(e){return a[e]})).filter((function(e){return-1!==e.display_name.toLowerCase().indexOf(s)})).map((function(e){return e.id}));return t.filter((function(e){return-1!==e.description.toLowerCase().indexOf(s)||r.includes(e.category)}))},n.renderExtensionItem=function(e){var t=n.props,r=t.categoryIdToInfos,l=t.featureFlags.expRealignMenu,i=e.icon,d=i.is_static?o.static_url("/static/images/generic_app_icon-vflIPYT1H.png"):i.url,u=e.app_copy,m=x.isLinked(e),p=m?"primary":"secondary",f=r[e.category],_=m?C.shouldRealignMenu(l)&&v.isShareCategory(e.category)?s._("Share"):s._("Open"):s._("Connect");return a.default.createElement("div",{className:"extension-section",key:e.description},a.default.createElement("div",{className:"extension-tile"},a.default.createElement("img",{src:d,className:"extensions-icon",alt:""}),a.default.createElement("div",{className:"extensions-description"},a.default.createElement("div",{className:"extensions-category-name"},e.description),a.default.createElement("div",{className:"extensions-app-name"},f.display_name)),a.default.createElement(c.Button,{variant:p,className:"extensions-scaling-modal__redirect_button",onClick:n.createClickHandler(e)},_)),a.default.createElement("div",{className:"extensions-scaling-modal__app-description"},u&&u.map((function(e,t){return a.default.createElement("p",{key:t,className:"extensions-scaling-modal__app-description-line"},"â€¢ "+e)}))))},n.renderEmptySearch=function(){return a.default.createElement("div",{className:"extensions-scaling-modal__empty-search"},a.default.createElement("img",{className:"extensions-scaling-modal__empty-search-image",src:o.static_url("/static/images/empty_states/search-vflHMNVT9.png"),srcSet:o.static_url("/static/images/empty_states/search@2x-vfly2B3kk.png")+" 2x",alt:""}),a.default.createElement(l.Text,{size:"medium"},i.reactFormat(s._("<bold>Looking for something?</bold>"),{bold:a.default.createElement(l.Text,{fontWeight:"medium",size:"large"})})),a.default.createElement(l.Text,{size:"medium"},s._("Check spelling or try again.")))},n.state={searchKey:""},n}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.onRequestClose,o=t.featureFlags,c=t.modalTitle,i=this.filterActions().sort(E.actionCompareFn),u="ON"===o.appDirectory;return a.default.createElement(r.Modal,{ariaLabel:s._("App actions"),className:"extensions-scaling-modal",displayCloseButton:!0,open:!0,overlayClassName:"file-viewer-modal-overlay",overlayFixed:!1,onRequestClose:function(){return n()}},a.default.createElement("div",{className:"extensions-scaling-modal__body-wrapper"},a.default.createElement("div",{className:"extensions-scaling-modal__title"},a.default.createElement(l.Text,{size:"large"},c)),a.default.createElement("div",{className:"extensions-scaling-modal__search-bar"},a.default.createElement(_.SearchInput,{clearButtonRenderer:function(e){var t=e.handleClick,n=e.handleKeyDown,s=e.handleMouseDown;return a.default.createElement(g.ClearInputButton,{icon:a.default.createElement(h.ColorizedIcon,{color:"#707781"},a.default.createElement(y.IconCancel,null)),onClick:t,onKeyDown:n,onMouseDown:s})},keyboardShortcut:"",placeholder:s._("Search by action or app name"),value:this.state.searchKey,onChange:this.handleQueryChange})),a.default.createElement("div",{className:"extensions-container"},i.length>0?i.map((function(t){return e.renderExtensionItem(t)})):this.renderEmptySearch()),u&&a.default.createElement(b,null)),a.default.createElement(d.UXAnalyticsModalTracking,{id:"extensions-scaling-modal"}))},t})(a.default.Component);t.ExtensionsScalingModal=u.requireCssWithComponent(k,["/static/js/deep-integrations/index.web-vflKTG8Ry.css","/static/css/app_actions/index-vflQoSB9Z.css"]);var w=f.once((function(){p.setAppElement(document.body)}));t.showExtensionsScalingModal=function(e,n,s,r,o,c,l,i,d,u){w(),m.Modal.showInstance(a.default.createElement(t.ExtensionsScalingModal,{modalTitle:e,user:n,file:s,onRequestClose:m.Modal.close,appActions:r,categoryIdToInfos:o,featureFlags:c,updateLinkState:l,telemetryContext:i,currentSession:d,onProfileServiceAuth:u}));var p=x.partitionActionsByLinkStatus(r),f=p.connected_apps,_=p.unconnected_apps;x.logEvent(d,"view_scaling_modal",{connected_apps:f,unconnected_apps:_})}}));
//# sourceMappingURL=extensions_scaling_modal.min.js-vfloJWpL2.map